<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-03-02 Sat 18:26 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CPP/C++ STL Input and Output</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="cpp/c++ stl standard template library algorithms and iterators"
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<link href="theme/org-nav-theme.css" rel="stylesheet">
<script src="theme/org-nav-theme.js"></script>
<link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">CPP/C++ STL Input and Output</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org211802b">1. C++ IO  Input and Output System</a>
<ul>
<li><a href="#org747380c">1.1. IO Class Hierarchy</a></li>
<li><a href="#orgec5442b">1.2. IO Manipulators</a></li>
<li><a href="#orgf76ae54">1.3. Custom IO manipulators</a></li>
<li><a href="#orgae5ba15">1.4. IO - Insertion &lt;&lt; and extraction &gt;&gt; operators</a>
<ul>
<li><a href="#orge53f514">1.4.1. Operators insertion insertion for STL std::vector&lt;double&gt;</a></li>
<li><a href="#org941ab64">1.4.2. Operators insertion insertion for STL std::vector&lt;T&gt;</a></li>
<li><a href="#orgcb0aa7e">1.4.3. Operators insertion and extraction for used defined-type</a></li>
</ul>
</li>
<li><a href="#org2ffbbc9">1.5. Redirect IO .rdbuf()</a></li>
<li><a href="#orgde43f23">1.6. Saving and restoring IO flags</a>
<ul>
<li><a href="#org54dbcc4">1.6.1. Manual saving restoring</a></li>
<li><a href="#orgcc5b559">1.6.2. Automatic saving and restoring IO flags with RAAI</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<ul class="org-ul">
<li><a href='index.html'>Index</a></li>
</ul>

<div id="outline-container-org211802b" class="outline-2">
<h2 id="org211802b"><span class="section-number-2">1</span> C++ IO  Input and Output System</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org747380c" class="outline-3">
<h3 id="org747380c"><span class="section-number-3">1.1</span> IO Class Hierarchy</h3>
<div class="outline-text-3" id="text-1-1">
<p>
<b>C++ IO Features:</b>
</p>

<ul class="org-ul">
<li>Object oriented and polymorphic</li>
<li>Stateful
<ul class="org-ul">
<li>The IO classes have internal states such as precision that float
point will be printed; base which numbers will be print such as
octal (base 8), hexadecimal (base 16) and decimal (default).</li>
</ul></li>
<li>Without exceptions
<ul class="org-ul">
<li>The C++ IO does not have exceptions, it indicates error through
error flags that must be checked by the calling code.</li>
</ul></li>
</ul>

<p>
<b>IO Classes:</b>
</p>

<ul class="org-ul">
<li>ios - base class for streams</li>
<li>istream - input stream base class
<ul class="org-ul">
<li>ifstream =&gt; Input file stream</li>
<li>istringstream =&gt; Input string stream</li>
</ul></li>
<li>ostream - output stream base class
<ul class="org-ul">
<li>ofstream =&gt; Output file stream</li>
<li>ostringstream =&gt; Output string stream</li>
</ul></li>
<li>iostream - input/output stream base class
<ul class="org-ul">
<li>fstream =&gt; Input/Output file stream.</li>
<li>sstringstream =&gt; String stream that can be used for reading and writing.</li>
</ul></li>
</ul>

<p>
<b>IO Global Objects</b>
</p>

<p>
Output stream global objects (instances of std::ostream): 
</p>
<ul class="org-ul">
<li>std::cout - Standard output stream (stdout)</li>
<li>std::cerr - Standard output error stream (stderr)</li>
<li>std::clog</li>
<li>std::wcout - Standard output stream (stdout) - wide character version.</li>
<li>std::wcerr</li>
<li>std::wclog</li>
</ul>

<p>
Input stream global objects (instances of std::istream): 
</p>
<ul class="org-ul">
<li>std::cin  - Standard input stream (stdin)</li>
<li>std::wcin - Standard input stream (stdin), wide character version.</li>
</ul>

<p>
<b>Header Files</b> 
</p>

<ul class="org-ul">
<li><a href="https://en.cppreference.com/w/cpp/header/iostream">&lt;iostream&gt;</a> =&gt; Basic IO 
<ul class="org-ul">
<li><span class="underline">std::ostream</span>, <span class="underline">std::istream</span>, std::cout, std::cerr, std::clog, std::wcerr</li>
</ul></li>

<li><a href="https://en.cppreference.com/w/cpp/header/fstream">&lt;fstream&gt;</a> =&gt; File IO 
<ul class="org-ul">
<li>std::ifstream, std::ofstream, std::fstream</li>
</ul></li>

<li><a href="https://en.cppreference.com/w/cpp/header/sstream">&lt;sstream&gt;</a> =&gt; String / Memory IO
<ul class="org-ul">
<li>std::stringstream, std::istringstream, std::ostringstream</li>
</ul></li>

<li><a href="https://en.cppreference.com/w/cpp/header/iomanip">&lt;iomanip&gt;</a> =&gt; IO manipulation functions
<ul class="org-ul">
<li>std::setfill, std::setprecision, std::setw, std::right,
std::left, std::dec, std::hex, std::quoted (C++14)</li>
</ul></li>
</ul>

<p>
Full references at: 
</p>
<ul class="org-ul">
<li><a href="http://www.cplusplus.com/reference/iolibrary/">http://www.cplusplus.com/reference/iolibrary/</a></li>
</ul>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>C++ IO Class hierarchy</label><pre class="src src-text">                                ios
                                 +
                +----------------+--------------+
                |                               |
               \|/                             \|/
            +-------+                      +--------+
            |istream|                      |ostream |
            +--+----+                      +---+----+
               |                               |
              \|/       +-----------+         \|/
    +------------------&gt;+  iostream +&lt;------+--v--------+-----------+
    |          |        +-----+-----+       |           |           |
    v          v              |             v           v           v
*std::cin  ifstream           |         *std::cerr   ofstream   ostringstream
           istringstream      |          *std::cout
                              |          *std::clog
                        ------v------
                        |           |
                        v           v
                     fstream stringstream
</pre>
</div>


<p>
<b>Statefullness</b> 
</p>

<p>
The C++ IO streams are stateful, they have internal states for IO
configuration such as <a href="https://en.cppreference.com/w/cpp/io/ios_base/fmtflags">IO flags</a> and numerical precision. In the
following code, the IO manipulator std::boolalpha enables the IO flag
std::ios_base::boolalpha that makes the IO stream print booleans as
string instead of '0' or '1'. The flag can be disabled with the IO
manipulator std::noboolalpha.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = 1 flag2 = 0
&gt;&gt; 
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = 1 flag2 = 0
&gt;&gt; 

<span class="org-comment-delimiter">// </span><span class="org-comment">IO Manipulator that enables boolalpha flag which enables booleans</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">be print as strings instead of being print as numbers.</span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = <span class="org-constant">true</span> flag2 = <span class="org-constant">false</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Output continues in this way until the flag boolalpha is disabled. </span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = <span class="org-constant">true</span> flag2 = <span class="org-constant">false</span>
&gt;&gt; 

<span class="org-comment-delimiter">// </span><span class="org-comment">Disable flag </span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::noboolalpha;
&gt;&gt; 
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = 1 flag2 = 0
</pre>
</div>
</div>
</div>
<div id="outline-container-orgec5442b" class="outline-3">
<h3 id="orgec5442b"><span class="section-number-3">1.2</span> IO Manipulators</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>All mapipulators: <a href="https://en.cppreference.com/w/cpp/io/manip">documentation</a></li>
</ul>

<p>
Switch numeric representation of booleans
</p>

<ul class="org-ul">
<li>std::boolapha
<ul class="org-ul">
<li>=&gt; Print booleans as 'true' or 'false' rather than 0 or 1.</li>
</ul></li>
<li>std::noboolalpha
<ul class="org-ul">
<li>=&gt; Print boolean as number true as 1 and false as 0.</li>
</ul></li>
</ul>

<p>
Case manipulators:
</p>

<ul class="org-ul">
<li>std::uppercase =&gt; Print everything as uppercase.</li>
<li>std::nouppercase =&gt; Print without forcing uppercase.</li>
</ul>

<p>
Change numerical base used for printing integers (flag std::ios::basefield)
</p>

<ul class="org-ul">
<li>std::dec =&gt; Print integers as decimal</li>
<li>std::hex =&gt; Print integers as heaxdecimal</li>
<li>std::oct =&gt; Print integers as octal</li>
</ul>

<p>
Float point number formatting: (flag: std::ios::floatfield)
</p>

<ul class="org-ul">
<li>std::defaultflot (C++11)</li>
<li>std::fixed
<ul class="org-ul">
<li>Print float with fixed precision (fixed numbers of decimal places)</li>
</ul></li>
<li>std::scientific
<ul class="org-ul">
<li>Print float with scientific notation</li>
</ul></li>
<li>std::hexfloat (C++11)</li>
</ul>

<p>
Float point precision: 
</p>

<ul class="org-ul">
<li>std::setprecision(int N)</li>
</ul>

<p>
Field adjusting (flag: std::ios::adjustfield)
</p>

<ul class="org-ul">
<li>std::ios::left</li>
<li>std::ios::right</li>
<li>std::ios::internal</li>
</ul>

<p>
Flushing manipulators:
</p>

<ul class="org-ul">
<li>std::flush
<ul class="org-ul">
<li>Flush output stream, in other words, it forces the stream
buffer to be written to the IO, for instance, it can force the
buffer of a file output stream to be written to a file. TL;DR
synchronize stream buffer with output.</li>
</ul></li>

<li>std::endl
<ul class="org-ul">
<li>Insert new line character in the output stream <code>\n</code> and flushes
the stream (std::flush).</li>
</ul></li>

<li>std::unitbuf
<ul class="org-ul">
<li>=&gt; Automatically flushes the output stream after each
operation. Note: most output streams flushes by default.</li>
<li>Sets the flag: std::ios_base::unitbuf.</li>
</ul></li>

<li>std::nounitbuf
<ul class="org-ul">
<li>=&gt; Disables automatic output stream flushing.</li>
<li>=&gt; Disables the flag: std::ios_base::unitbuf</li>
</ul></li>
</ul>


<p>
<b>Examples Float point IO manipulators</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(pi) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>M_PI<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; 2.50 &lt;&lt; <span class="org-string">"\n"</span>;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>pi<span class="org-rainbow-delimiters-depth-1">)</span> = 1.77245 x = 2.5
&gt;&gt; 

<span class="org-comment-delimiter">// </span><span class="org-comment">Precision 3 decimal places </span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-1">(</span>3<span class="org-rainbow-delimiters-depth-1">)</span>;
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(pi) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>M_PI<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; 2.50 &lt;&lt; <span class="org-string">"\n"</span>;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>pi<span class="org-rainbow-delimiters-depth-1">)</span> = 1.772 x = 2.500

<span class="org-comment-delimiter">// </span><span class="org-comment">Precision 6 decimal places </span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-1">(</span>6<span class="org-rainbow-delimiters-depth-1">)</span>;
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(pi) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>M_PI<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; 2.50 &lt;&lt; <span class="org-string">"\n"</span>;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>pi<span class="org-rainbow-delimiters-depth-1">)</span> = 1.772454 x = 2.500000

<span class="org-comment-delimiter">// </span><span class="org-comment">Reset float IO</span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::defaultfloat;
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(pi) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>M_PI<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; 2.50 &lt;&lt; <span class="org-string">"\n"</span>;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>pi<span class="org-rainbow-delimiters-depth-1">)</span> = 1.77245 x = 2.5
&gt;&gt; 
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf76ae54" class="outline-3">
<h3 id="orgf76ae54"><span class="section-number-3">1.3</span> Custom IO manipulators</h3>
<div class="outline-text-3" id="text-1-3">
<p>
<b>Example: 1</b> 
</p>

<p>
Custom IO manipulator to print integers in hexadecimal format without
affecting IO global state.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">typename</span> <span class="org-type">Numeric</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> <span class="org-keyword">struct</span> <span class="org-type">to_hex</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-type">Numeric</span> <span class="org-variable-name">m_value</span>;
     <span class="org-function-name">to_hex</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">Numeric</span> <span class="org-variable-name">value</span><span class="org-rainbow-delimiters-depth-2">)</span>: <span class="org-function-name">m_value</span><span class="org-rainbow-delimiters-depth-2">(</span>value<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-rainbow-delimiters-depth-2">}</span>

     <span class="org-keyword">friend</span> <span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-type">to_hex</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">rhs</span><span class="org-rainbow-delimiters-depth-2">)</span>
     <span class="org-rainbow-delimiters-depth-2">{</span>
         <span class="org-keyword">return</span> os &lt;&lt; <span class="org-string">"0x"</span> &lt;&lt; <span class="org-constant">std</span>::uppercase &lt;&lt; <span class="org-constant">std</span>::hex
                   &lt;&lt; rhs.m_value &lt;&lt; <span class="org-constant">std</span>::nouppercase &lt;&lt; <span class="org-constant">std</span>::dec ;
     <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Usage: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; to_hex<span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;(</span>2561<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" y = "</span> &lt;&lt; 246 &lt;&lt; <span class="org-string">"\n"</span>;
x = 0xA01 y = 246

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; to_hex<span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;(</span>255<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" y = "</span> &lt;&lt; 246 &lt;&lt; <span class="org-string">"\n"</span>;
x = 0xFF y = 246
</pre>
</div>

<p>
<b>Example 2</b> Custom IO manipulators for numerical tables. 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">type_traits</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Requires headers:  &lt;iostream&gt;, &lt;iomanip&gt;, &lt;type_traits&gt;</span>
<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span> 
   <span class="org-keyword">typename</span> <span class="org-type">Numeric</span>,
   <span class="org-comment-delimiter">// </span><span class="org-comment">Used for restricting the types of arguments that can be used. </span>
   <span class="org-comment-delimiter">// </span><span class="org-comment">It will generate a compiler error for non-float arguments. </span>
   <span class="org-keyword">typename</span> <span class="org-constant">std</span>::<span class="org-constant">enable_if</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::<span class="org-constant">is_floating_point</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">Numeric</span><span class="org-rainbow-delimiters-depth-3">&gt;</span>::value, <span class="org-type">void</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>::<span class="org-type">type</span>* = <span class="org-constant">nullptr</span>
   <span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">struct</span> <span class="org-type">to_fix</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">Numeric</span> <span class="org-variable-name">m_value</span>;
    <span class="org-type">size_t</span>  <span class="org-variable-name">m_precision</span>;
    <span class="org-type">size_t</span>  <span class="org-variable-name">m_field_size</span>;

    <span class="org-function-name">to_fix</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">Numeric</span> <span class="org-variable-name">value</span>, <span class="org-type">size_t</span> <span class="org-variable-name">fieldSize</span> = 8, <span class="org-type">size_t</span> <span class="org-variable-name">precision</span> = 4<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        m_value       = value;
        m_field_size  = fieldSize;
        m_precision   = precision;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-keyword">friend</span> <span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-type">to_fix</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">rhs</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">size_t</span> <span class="org-variable-name">prec</span> = os.precision<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-constant">std</span>::<span class="org-type">ios</span> <span class="org-variable-name">config</span><span class="org-rainbow-delimiters-depth-3">{</span><span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">}</span>;
        config.copyfmt<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">std</span>::cout<span class="org-rainbow-delimiters-depth-3">)</span>;  
        os &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-3">(</span>rhs.m_precision<span class="org-rainbow-delimiters-depth-3">)</span>
           &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>rhs.m_field_size<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; rhs.m_value;
        <span class="org-constant">std</span>::cout.copyfmt<span class="org-rainbow-delimiters-depth-3">(</span>config<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> os;
 <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Experiment 1: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span> = 0.0; x &lt; 4.0; x += 0.5<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-keyword">using</span> <span class="org-type">T</span> = <span class="org-type">double</span>;
     <span class="org-type">double</span> <span class="org-variable-name">y</span> = <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-constant">std</span>::cout &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>y<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Experiment 1 Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">0.0000  0.0000
0.5000  0.7071
1.0000  1.0000
1.5000  1.2247
2.0000  1.4142
2.5000  1.5811
3.0000  1.7321
3.5000  1.8708
</pre>
</div>

<p>
Experiment 2: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span> = 0.0; x &lt; 100.0; x += 10.0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-keyword">using</span> <span class="org-type">T</span> = <span class="org-type">double</span>;
     <span class="org-type">double</span> <span class="org-variable-name">y</span> = <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-constant">std</span>::cout &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x, 8, 2<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>y, 9, 5<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Experiment 2 output: 
</p>

<div class="org-src-container">
<pre class="src src-text"> 0.00  0.00000
10.00  3.16228
20.00  4.47214
30.00  5.47723
40.00  6.32456
50.00  7.07107
60.00  7.74597
70.00  8.36660
80.00  8.94427
90.00  9.48683
</pre>
</div>

<p>
Experiment 3: Print table to file.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::ofstream report<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"/tmp/report.txt"</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span> = 0.0; x &lt; 100.0; x += 10.0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-keyword">using</span> <span class="org-type">T</span> = <span class="org-type">double</span>;
     <span class="org-type">double</span> <span class="org-variable-name">y</span> = <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
     report &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x, 8, 2<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>y, 9, 5<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Sync buffer with IO </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">force buffer to be written to IO </span>
report.flush<span class="org-rainbow-delimiters-depth-1">()</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Force close</span>
report.close<span class="org-rainbow-delimiters-depth-1">()</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Run shell command to check file </span>
&gt;&gt; .<span class="org-negation-char">!</span> head -n 3 /tmp/report.txt
    0.00  0.00000
   10.00  3.16228
   20.00  4.47214
&gt;&gt; 

&gt;&gt; .<span class="org-negation-char">!</span> tail -n 3 /tmp/report.txt
   70.00  8.36660
   80.00  8.94427
   90.00  9.48683
&gt;&gt; 
</pre>
</div>
</div>
</div>

<div id="outline-container-orgae5ba15" class="outline-3">
<h3 id="orgae5ba15"><span class="section-number-3">1.4</span> IO - Insertion &lt;&lt; and extraction &gt;&gt; operators</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-orge53f514" class="outline-4">
<h4 id="orge53f514"><span class="section-number-4">1.4.1</span> Operators insertion insertion for STL std::vector&lt;double&gt;</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
Operator insertion (&lt;&lt;) for type std::vector&lt;double&gt;: 
</p>

<ul class="org-ul">
<li>Code: <a href="https://wandbox.org/permlink/UX67EPtHSKpmXCR7">Wandbox Online Compiler</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

<span class="org-function-name">std</span>::ostream&amp; 
<span class="org-keyword">operator</span>&lt;&lt;<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">xs</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    os &lt;&lt; <span class="org-string">"["</span> &lt;&lt; xs.size<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"]( "</span>;
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp;  <span class="org-variable-name">x</span>: xs<span class="org-rainbow-delimiters-depth-2">)</span>
            os &lt;&lt; x &lt;&lt; <span class="org-string">", "</span>;
    <span class="org-keyword">return</span> os &lt;&lt; <span class="org-string">" )"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Function main: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> xs;
xs = <span class="org-rainbow-delimiters-depth-1">{}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xs = "</span> &lt;&lt; xs &lt;&lt; <span class="org-constant">std</span>::endl;
xs = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 5.0, 4.6, 1e4, 9.8<span class="org-rainbow-delimiters-depth-1">}</span>;    
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xs = "</span> &lt;&lt; xs &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-keyword">return</span> 0;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">xs = [0](  )
xs = [5]( 1, 5, 4.6, 10000, 9.8,  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org941ab64" class="outline-4">
<h4 id="org941ab64"><span class="section-number-4">1.4.2</span> Operators insertion insertion for STL std::vector&lt;T&gt;</h4>
<div class="outline-text-4" id="text-1-4-2">
<ul class="org-ul">
<li>Code: <a href="https://wandbox.org/permlink/NQN0loqv21td60P3">Wandbox Online Compiler</a></li>
</ul>

<p>
Operator: (&lt;&lt;)
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">typename</span> <span class="org-type">Element</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> 
<span class="org-function-name">std</span>::<span class="org-type">ostream</span>&amp; 
<span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Element</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">xs</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    os &lt;&lt; <span class="org-string">"["</span> &lt;&lt; xs.size<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"]( "</span>;
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp;  <span class="org-variable-name">x</span>: xs<span class="org-rainbow-delimiters-depth-2">)</span>
       os &lt;&lt; x &lt;&lt; <span class="org-string">" "</span>;
    <span class="org-keyword">return</span> os &lt;&lt; <span class="org-string">" )"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Main function: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> xs;
xs = <span class="org-rainbow-delimiters-depth-1">{}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xs = "</span> &lt;&lt; xs &lt;&lt; <span class="org-constant">std</span>::endl;
xs = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 5.0, 4.6, 1e4, 9.8<span class="org-rainbow-delimiters-depth-1">}</span>;    
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xs = "</span> &lt;&lt; xs &lt;&lt; <span class="org-constant">std</span>::endl;

<span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> xa = <span class="org-rainbow-delimiters-depth-1">{</span>1, 3, 4, 5, 6<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xa = "</span> &lt;&lt; xa &lt;&lt; <span class="org-string">"\n"</span>;

<span class="org-keyword">auto</span> <span class="org-variable-name">words</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">&gt;{</span><span class="org-string">"hello"</span>, <span class="org-string">"world"</span>, <span class="org-string">"C++"</span>, <span class="org-string">"new"</span>, <span class="org-string">"machine"</span><span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"words = "</span> &lt;&lt; words &lt;&lt; <span class="org-string">"\n"</span>;

<span class="org-keyword">return</span> 0;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">xs = [0](  )
xs = [5]( 1 5 4.6 10000 9.8  )
xa = [5]( 1 3 4 5 6  )
words = [5]( hello world C++ new machine  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcb0aa7e" class="outline-4">
<h4 id="orgcb0aa7e"><span class="section-number-4">1.4.3</span> Operators insertion and extraction for used defined-type</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
This example shows how to overload the operators insertion (&lt;&lt;) and
extraction (&gt;&gt;) for an user defined type. Note: those operators are
not class methods, they are free functions.
</p>

<ul class="org-ul">
<li>File: <a href="src/insertionExtractionOverload.cpp">file:src/insertionExtractionOverload.cpp</a></li>
<li>Online Compile: <a href="https://wandbox.org/permlink/97fcclubA7KHWEry">https://wandbox.org/permlink/97fcclubA7KHWEry</a>  (No console input support)</li>
</ul>


<p>
Compiling and running: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ clang++ inputOutput.cpp -o <span class="org-keyword">inputOutput.bin</span> -std=c++1z -O0 -Wall &amp;&amp; ./inputOutput.bin
</pre>
</div>

<p>
Class Product (file: Product.hpp):
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">class</span> <span class="org-type">Product</span><span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-function-name">private</span>:
    <span class="org-type">int</span>          <span class="org-variable-name">m_id</span>;
    <span class="org-constant">std</span>::<span class="org-type">string</span>  <span class="org-variable-name">m_name</span>;
    <span class="org-type">double</span>       <span class="org-variable-name">m_price</span>;
<span class="org-function-name">public</span>:
    <span class="org-function-name">Product</span><span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-function-name">Product</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">id</span>, <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">name</span>, <span class="org-type">double</span> <span class="org-variable-name">price</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">int</span>         <span class="org-function-name">Id</span><span class="org-rainbow-delimiters-depth-2">()</span>    <span class="org-keyword">const</span>;
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-function-name">Name</span><span class="org-rainbow-delimiters-depth-2">()</span>  <span class="org-keyword">const</span>;
    <span class="org-type">double</span>      <span class="org-function-name">Price</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span>;
    <span class="org-type">void</span> <span class="org-function-name">showProduct</span><span class="org-rainbow-delimiters-depth-2">()</span>  <span class="org-keyword">const</span>;

    <span class="org-keyword">friend</span>
    <span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-type">Product</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">prod</span><span class="org-rainbow-delimiters-depth-2">)</span> -&gt; <span class="org-constant">std</span>::ostream&amp;;

    <span class="org-keyword">friend</span>
    <span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name">&gt;&gt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">istream</span>&amp; <span class="org-variable-name">is</span>, <span class="org-type">Product</span>&amp; <span class="org-variable-name">prod</span><span class="org-rainbow-delimiters-depth-2">)</span> -&gt; <span class="org-constant">std</span>::istream&amp;;  
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
<b>Methods implementation</b> (file: Product.hpp)
</p>

<p>
Constructors: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">Product</span>::Product<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">id</span>, <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">name</span>, <span class="org-type">double</span> <span class="org-variable-name">price</span><span class="org-rainbow-delimiters-depth-1">)</span>:
   m_id<span class="org-rainbow-delimiters-depth-1">(</span>id<span class="org-rainbow-delimiters-depth-1">)</span>, m_name<span class="org-rainbow-delimiters-depth-1">(</span>name<span class="org-rainbow-delimiters-depth-1">)</span>, m_price<span class="org-rainbow-delimiters-depth-1">(</span>price<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-function-name">Product</span>::Product<span class="org-rainbow-delimiters-depth-1">()</span>: Product<span class="org-rainbow-delimiters-depth-1">(</span>-1, <span class="org-string">"unnamed"</span>, 0.0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>   
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Operator insertion (&lt;&lt;) for printing a Product object to an output
stream, it means any derived class of <a href="http://www.cplusplus.com/reference/istream/iostream/">std::ostream</a> or std::cout,
std::stringstream, std::fstream.
</p>

<ul class="org-ul">
<li>Note: This operator is not a method of the class Product, it is
just a function of two arguments.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-type">Product</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">prod</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-constant">std</span>::ostream&amp;
<span class="org-rainbow-delimiters-depth-1">{</span>
     os &lt;&lt; <span class="org-string">" "</span> &lt;&lt; prod.m_id
        &lt;&lt; <span class="org-string">" "</span> &lt;&lt; <span class="org-constant">std</span>::quoted<span class="org-rainbow-delimiters-depth-2">(</span>prod.m_name<span class="org-rainbow-delimiters-depth-2">)</span>
        &lt;&lt; <span class="org-string">" "</span> &lt;&lt; prod.m_price;    
     <span class="org-keyword">return</span> os; 
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Operator extraction (&gt;&gt;) for reading a product object from an input
stream, it means, any derived class of the class <a href="http://www.cplusplus.com/reference/istream/istream/">std::istream</a> such as
std::cin, std::fstream, std::sstream and so on. 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name">&gt;&gt;</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">istream</span>&amp; <span class="org-variable-name">is</span>, <span class="org-type">Product</span>&amp; <span class="org-variable-name">prod</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-constant">std</span>::istream&amp;
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">return</span> is &gt;&gt; prod.m_id &gt;&gt; <span class="org-constant">std</span>::quoted<span class="org-rainbow-delimiters-depth-2">(</span>prod.m_name<span class="org-rainbow-delimiters-depth-2">)</span> &gt;&gt; prod.m_price; 
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<b>Main function:</b>
</p>

<p>
Create sample products:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">Product</span> <span class="org-variable-name">p1</span><span class="org-rainbow-delimiters-depth-1">{</span>200, <span class="org-string">"Arabica Coffee"</span>, 4.50<span class="org-rainbow-delimiters-depth-1">}</span>;    
<span class="org-type">Product</span> <span class="org-variable-name">p2</span><span class="org-rainbow-delimiters-depth-1">{</span>300, <span class="org-string">"Orange 1kg "</span>, 10.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-type">Product</span> <span class="org-variable-name">p3</span><span class="org-rainbow-delimiters-depth-1">{</span>126, <span class="org-string">"XYWZ soft drink"</span>, 15.60<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Experiment 1: print products to stdout.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" &gt;&gt;&gt; EXPERIMENT 1 == Print Products ==========="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"Product p1 = {"</span> &lt;&lt; p1 &lt;&lt; <span class="org-string">" }"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"Product p2 = {"</span> &lt;&lt; p2 &lt;&lt; <span class="org-string">" }"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"Product p3 = {"</span> &lt;&lt; p3 &lt;&lt; <span class="org-string">" }"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh"> &gt;&gt;&gt; EXPERIMENT 1 == Print Products ===========
Product p1 = { 200 <span class="org-string">"Arabica Coffee"</span> 4.5 }
Product p2 = { 300 <span class="org-string">"Orange 1kg "</span> 10 }
Product p3 = { 126 <span class="org-string">"XYWZ soft drink"</span> 15.6 
</pre>
</div>

<p>
Experiment 2: Print Product to memory stream (memory file)
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" &gt;&gt;&gt; EXPERIMENT 2 == Print Products to memory stream (memory file) ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">std</span>::stringstream ss;
ss &lt;&lt; p1 &lt;&lt; <span class="org-string">"\n"</span> &lt;&lt; p2 &lt;&lt; <span class="org-string">"\n"</span> &lt;&lt; p3;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"ss = \n"</span> &lt;&lt; ss.str<span class="org-rainbow-delimiters-depth-1">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text"> &gt;&gt;&gt; EXPERIMENT 2 == Print Products to memory stream (memory file) ====
ss = 
 200 "Arabica Coffee" 4.5
 300 "Orange 1kg " 10
 126 "XYWZ soft drink" 15.6
</pre>
</div>

<p>
Experiment 3: Read product from memory stream.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" &gt;&gt;&gt; EXPERIMENT 3 == Read products from memory stream ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">Product</span> <span class="org-variable-name">pr</span>;
ss &gt;&gt; pr;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">" pr1 = "</span> &lt;&lt; pr &lt;&lt; <span class="org-constant">std</span>::endl;
ss &gt;&gt; pr;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">" pr2 = "</span> &lt;&lt; pr &lt;&lt; <span class="org-constant">std</span>::endl;
ss &gt;&gt; pr;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">" pr3 = "</span> &lt;&lt; pr &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt;&gt; EXPERIMENT 3 == Read products from memory stream ====
pr1 =  200 <span class="org-string">"Arabica Coffee"</span> 4.5
pr2 =  300 <span class="org-string">"Orange 1kg "</span> 10
pr3 =  126 <span class="org-string">"XYWZ soft drink"</span> 15.6
</pre>
</div>

<p>
Experiment 4: Read products from console (user types the products) and
types Ctrl + D sending EOF (End Of File) character when he is done.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" &gt;&gt;&gt; EXPERIMENT 4 == Read products from console ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">Product</span> <span class="org-variable-name">prod</span>;
<span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-negation-char">!</span><span class="org-constant">std</span>::cin.eof<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">){</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Enter product: "</span>;
    <span class="org-constant">std</span>::cin &gt;&gt; prod;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" prod = "</span> &lt;&lt; prod &lt;&lt; <span class="org-string">" ; "</span>
              &lt;&lt; <span class="org-string">" price = "</span> &lt;&lt; prod.Price<span class="org-rainbow-delimiters-depth-2">()</span>
              &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-rainbow-delimiters-depth-1">}</span>       
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">Enter product: 451 Lemon 6.7
 prod =  451 <span class="org-string">"Lemon"</span> 6.7 ;  price = 6.7
Enter product: 234 <span class="org-string">"Fresh atum 1kg"</span> 25.90
 prod =  234 <span class="org-string">"Fresh atum 1kg"</span> 25.9 ;  price = 25.9
Enter product: 461 <span class="org-string">"Cappucino coffee"</span> 25.60        
 prod =  461 <span class="org-string">"Cappucino coffee"</span> 25.6 ;  price = 25.6
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org2ffbbc9" class="outline-3">
<h3 id="org2ffbbc9"><span class="section-number-3">1.5</span> Redirect IO .rdbuf()</h3>
<div class="outline-text-3" id="text-1-5">
<p>
See: <a href="http://www.cplusplus.com/reference/ios/ios/rdbuf/">ios::rdbuf - C++ Reference</a>
</p>

<ul class="org-ul">
<li>Overload 1: Return pointer to stream buffer attached to stream.</li>
<li>Overload 2: Set pointer to stream buffer attached to stream and
clears the error state flags.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">/* </span><span class="org-comment">Overload 1 [get] */</span> 
 <span class="org-type">streambuf</span>* <span class="org-constant">ios</span>::<span class="org-function-name">rdbuf</span><span class="org-rainbow-delimiters-depth-1">()</span> <span class="org-keyword">const</span>;

<span class="org-comment-delimiter">/* </span><span class="org-comment">Overload 2 [set] */</span> 
 <span class="org-type">streambuf</span>* <span class="org-constant">ios</span>::<span class="org-function-name">rdbuf</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">streambuf</span>* <span class="org-variable-name">sb</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Example: <b>Redirect std::cerr to std::stringstream string IO</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-function-name">std</span>::stringstream ss;

&gt;&gt; <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" Stderr output \n"</span>;
 <span class="org-type">Stderr</span> <span class="org-variable-name">output</span> 
&gt;&gt; 
<span class="org-comment-delimiter">// </span><span class="org-comment">Backup pointer to cout stream buffer </span>
&gt;&gt; <span class="org-keyword">auto</span> buf = <span class="org-constant">std</span>::cerr.rdbuf<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">basic_streambuf</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">char</span>, <span class="org-constant">std</span>::<span class="org-type">char_traits</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">char</span><span class="org-rainbow-delimiters-depth-3">&gt;</span> <span class="org-rainbow-delimiters-depth-2">&gt;</span> *<span class="org-rainbow-delimiters-depth-1">)</span> @0x7ffe4c3bc4d8
&gt;&gt; 
<span class="org-comment-delimiter">// </span><span class="org-comment">Redirect stream </span>
<span class="org-function-name">std</span>::cerr.rdbuf<span class="org-rainbow-delimiters-depth-1">(</span>ss.rdbuf<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
The global object std::cerr prints to stringstream instead of process'
stderr (standard error output):
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"hello world "</span>;
&gt;&gt; <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" exp(3.5) "</span> &lt;&lt; <span class="org-constant">std</span>::exp<span class="org-rainbow-delimiters-depth-1">(</span>3.5<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
</pre>
</div>

<p>
Get content of stream ss: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Stream content </span>
&gt;&gt; ss
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">stringstream</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fa0341bb018
&gt;&gt; 
&gt;&gt; ss.str<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-string">"hello world pi = 3.14159 exp(3.5) 33.1155"</span>
&gt;&gt;   
</pre>
</div>

<p>
Restore buffer:  
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cerr.rdbuf<span class="org-rainbow-delimiters-depth-1">(</span>buf<span class="org-rainbow-delimiters-depth-1">)</span>;

&gt;&gt; <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" exp(3.5) "</span> &lt;&lt; <span class="org-constant">std</span>::exp<span class="org-rainbow-delimiters-depth-1">(</span>3.5<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
pi = 3.14159 exp<span class="org-rainbow-delimiters-depth-1">(</span>3.5<span class="org-rainbow-delimiters-depth-1">)</span> 33.1155  

</pre>
</div>
</div>
</div>
<div id="outline-container-orgde43f23" class="outline-3">
<h3 id="orgde43f23"><span class="section-number-3">1.6</span> Saving and restoring IO flags</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-org54dbcc4" class="outline-4">
<h4 id="org54dbcc4"><span class="section-number-4">1.6.1</span> Manual saving restoring</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
IO manipulators such as std::scientific, std::fixed, std::setprecision
or std::uppercase are stateful and permanently affects the IO flags
what can make the code hard to understand and cause unintended IO
changes. This issue can be solved by saving and restoring the IO
flags. 
</p>

<p>
Save IO state: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">========= Save IO flags =========</span>
<span class="org-function-name">std</span>::ios config<span class="org-rainbow-delimiters-depth-1">{</span><span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-1">}</span>;
config.copyfmt<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::cout<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Before changing IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3 &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;
pi = 3.14159 gravity = 9814.57 E = 9.56e+08
&gt;&gt; 

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
 <span class="org-constant">true</span> = 1 <span class="org-constant">false</span> = 0
&gt;&gt; 
</pre>
</div>

<p>
Change IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-1">(</span>3<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::fixed;
</pre>
</div>

<p>
After changing IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3 &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;
pi = 3.142 gravity = 9814.572 E = 956000000.000

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(2) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>2.0<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span> ;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>2<span class="org-rainbow-delimiters-depth-1">)</span> = 1.414
&gt;&gt; 

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
 <span class="org-constant">true</span> = <span class="org-constant">true</span> <span class="org-constant">false</span> = <span class="org-constant">false</span>
&gt;&gt; 
</pre>
</div>

<p>
Restore IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::cout.copyfmt<span class="org-rainbow-delimiters-depth-1">(</span>config<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
After restoring IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3 &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;
pi = 3.14159 gravity = 9814.57 E = 9.56e+08

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(2) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>2.0<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span> ;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>2<span class="org-rainbow-delimiters-depth-1">)</span> = 1.41421

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
 <span class="org-constant">true</span> = 1 <span class="org-constant">false</span> = 0 
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcc5b559" class="outline-4">
<h4 id="orgcc5b559"><span class="section-number-4">1.6.2</span> Automatic saving and restoring IO flags with RAAI</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
Class for saving IO flags using RAAI.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>Class for saving and restoring IO context.</label><pre class="src src-cpp"><span class="org-keyword">struct</span> <span class="org-type">IOContext</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">ios</span>      <span class="org-variable-name">m_config</span><span class="org-rainbow-delimiters-depth-2">{</span><span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">std</span>::<span class="org-type">ostream</span>* <span class="org-variable-name">m_pos</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Save context </span>
    <span class="org-function-name">IOContext</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span> = <span class="org-constant">std</span>::cout<span class="org-rainbow-delimiters-depth-2">)</span>: m_pos<span class="org-rainbow-delimiters-depth-2">(</span>&amp;os<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [INFO] saved IO flags"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        m_config.copyfmt<span class="org-rainbow-delimiters-depth-3">(</span>os<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Restore context </span>
    ~<span class="org-function-name">IOContext</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [INFO] restored IO flags"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        m_pos-&gt;copyfmt<span class="org-rainbow-delimiters-depth-3">(</span>m_config<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Test function: 
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>Function testIOFlags for testing and demonstrating class IOContext.</label><pre class="src src-cpp"><span class="org-type">void</span> <span class="org-function-name">testIOFlags</span><span class="org-rainbow-delimiters-depth-1">()</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"===== Before ======="</span> &lt;&lt; <span class="org-string">"\n"</span>;
     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI
               &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3
               &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"===== Context - IO flags changed ======="</span> &lt;&lt; <span class="org-string">"\n"</span>;
     <span class="org-rainbow-delimiters-depth-2">{</span>  <span class="org-comment-delimiter">/* </span><span class="org-comment">Sub-scope start */</span>
         <span class="org-type">IOContext</span> <span class="org-variable-name">ctx</span><span class="org-rainbow-delimiters-depth-3">{</span><span class="org-constant">std</span>::cout<span class="org-rainbow-delimiters-depth-3">}</span>; <span class="org-comment-delimiter">/* </span><span class="org-comment">Save IO Flags */</span>

         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;
         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-3">(</span>3<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; <span class="org-constant">std</span>::fixed;

         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI
                   &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3
                   &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;

         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;

        <span class="org-comment-delimiter">/* </span><span class="org-comment">End of sub-scope */</span>
     <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Object ctx destroyed here =&gt; IO flags restored </span>

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"===== After =&gt; IO flags restored ======="</span> &lt;&lt; <span class="org-string">"\n"</span>;

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI
               &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3
               &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-comment-delimiter">/** </span><span class="org-comment">--- End of function testIOFlags --- */</span>
</pre>
</div>

<p>
Test in REPL: 
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>CERN's ROOT repl session.</label><pre class="src src-cpp">&gt;&gt; testIOFlags<span class="org-rainbow-delimiters-depth-1">()</span>

===== Before =======
pi = 3.14159 gravity = 9814.57 E = 9.56e+08
 <span class="org-constant">true</span> = 1 <span class="org-constant">false</span> = 0
===== Context - IO flags changed =======
 <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-constant">INFO</span><span class="org-rainbow-delimiters-depth-1">]</span> saved IO flags
pi = 3.142 gravity = 9814.572 E = 956000000.000
 <span class="org-constant">true</span> = <span class="org-constant">true</span> <span class="org-constant">false</span> = <span class="org-constant">false</span>
 <span class="org-rainbow-delimiters-depth-1">[</span>INFO<span class="org-rainbow-delimiters-depth-1">]</span> restored IO flags
===== After =&gt; IO flags restored =======
pi = 3.14159 gravity = 9814.57 E = 9.56e+08
 <span class="org-constant">true</span> = 1 <span class="org-constant">false</span> = 0
&gt;&gt; 
&gt;&gt; 
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2019-03-02 Sat 18:26</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
