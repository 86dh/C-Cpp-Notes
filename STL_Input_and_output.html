<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-07-24 Wed 02:19 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CPP/C++ STL Input and Output</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="cpp/c++ stl standard template library algorithms and iterators"
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<link href="theme/org-nav-theme.css" rel="stylesheet">
<script src="theme/org-nav-theme.js"></script>
<link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">CPP/C++ STL Input and Output</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org1e1110d">1. C++ IO  Input and Output System</a>
<ul>
<li><a href="#org741a112">1.1. IO Class Hierarchy</a></li>
<li><a href="#orgec8bce8">1.2. IO Manipulators</a></li>
<li><a href="#org80c535f">1.3. IO stream redirection</a>
<ul>
<li><a href="#orgd4c09c5">1.3.1. Stdout (cout) and Stderr (cerr) stream redirection</a></li>
<li><a href="#org0f90ea9">1.3.2. Stdin (cin) stream redirection</a></li>
</ul>
</li>
<li><a href="#org4112ebd">1.4. Generic Input Stream - read data from file, console and memory</a></li>
<li><a href="#org450007d">1.5. Custom IO manipulators</a></li>
<li><a href="#org6ab390e">1.6. IO - Insertion &lt;&lt; and extraction &gt;&gt; operators</a>
<ul>
<li><a href="#orge06a670">1.6.1. Operators insertion insertion for STL std::vector&lt;double&gt;</a></li>
<li><a href="#orgc13c489">1.6.2. Operators insertion insertion for STL std::vector&lt;T&gt;</a></li>
<li><a href="#orgd204a19">1.6.3. Operators insertion and extraction for used defined-type</a></li>
</ul>
</li>
<li><a href="#orgb059b36">1.7. Redirect IO .rdbuf()</a></li>
<li><a href="#org0627dcc">1.8. Read whole input stream to string</a></li>
<li><a href="#orge35eb32">1.9. Saving and restoring IO flags</a>
<ul>
<li><a href="#org077a14f">1.9.1. Manual saving restoring</a></li>
<li><a href="#org92df5cb">1.9.2. Automatic saving and restoring IO flags with RAAI</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<ul class="org-ul">
<li><a href='index.html'>Index</a></li>
</ul>

<div id="outline-container-org1e1110d" class="outline-2">
<h2 id="org1e1110d"><span class="section-number-2">1</span> C++ IO  Input and Output System</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org741a112" class="outline-3">
<h3 id="org741a112"><span class="section-number-3">1.1</span> IO Class Hierarchy</h3>
<div class="outline-text-3" id="text-1-1">
<p>
<b>C++ IO Features:</b>
</p>

<ul class="org-ul">
<li>Object oriented and polymorphic</li>
<li>Stateful
<ul class="org-ul">
<li>The IO classes have internal states such as precision that float
point will be printed; base which numbers will be print such as
octal (base 8), hexadecimal (base 16) and decimal (default).</li>
</ul></li>
<li>Without exceptions
<ul class="org-ul">
<li>The C++ IO does not have exceptions, it indicates error through
error flags that must be checked by the calling code.</li>
</ul></li>
</ul>

<p>
<b>IO Classes:</b>
</p>

<ul class="org-ul">
<li>ios - base class for streams</li>
<li>istream - input stream base class
<ul class="org-ul">
<li>ifstream =&gt; Input file stream</li>
<li>istringstream =&gt; Input string stream</li>
</ul></li>
<li>ostream - output stream base class
<ul class="org-ul">
<li>ofstream =&gt; Output file stream</li>
<li>ostringstream =&gt; Output string stream</li>
</ul></li>
<li>iostream - input/output stream base class
<ul class="org-ul">
<li>fstream =&gt; Input/Output file stream.</li>
<li>sstringstream =&gt; String stream that can be used for reading and writing.</li>
</ul></li>
</ul>

<p>
<b>IO Global Objects</b>
</p>

<p>
Output stream global objects (instances of std::ostream): 
</p>
<ul class="org-ul">
<li>std::cout - Standard output stream (stdout)</li>
<li>std::cerr - Standard output error stream (stderr)</li>
<li>std::clog</li>
<li>std::wcout - Standard output stream (stdout) - wide character version.</li>
<li>std::wcerr</li>
<li>std::wclog</li>
</ul>

<p>
Input stream global objects (instances of std::istream): 
</p>
<ul class="org-ul">
<li>std::cin  - Standard input stream (stdin)</li>
<li>std::wcin - Standard input stream (stdin), wide character version.</li>
</ul>

<p>
<b>Header Files</b> 
</p>

<ul class="org-ul">
<li><a href="https://en.cppreference.com/w/cpp/header/iostream">&lt;iostream&gt;</a> =&gt; Basic IO 
<ul class="org-ul">
<li><span class="underline">std::ostream</span>, <span class="underline">std::istream</span>, std::cout, std::cerr, std::clog, std::wcerr</li>
</ul></li>

<li><a href="https://en.cppreference.com/w/cpp/header/fstream">&lt;fstream&gt;</a> =&gt; File IO 
<ul class="org-ul">
<li>std::ifstream, std::ofstream, std::fstream</li>
</ul></li>

<li><a href="https://en.cppreference.com/w/cpp/header/sstream">&lt;sstream&gt;</a> =&gt; String / Memory IO
<ul class="org-ul">
<li>std::stringstream, std::istringstream, std::ostringstream</li>
</ul></li>

<li><a href="https://en.cppreference.com/w/cpp/header/iomanip">&lt;iomanip&gt;</a> =&gt; IO manipulation functions
<ul class="org-ul">
<li>std::setfill, std::setprecision, std::setw, std::right,
std::left, std::dec, std::hex, std::quoted (C++14)</li>
</ul></li>
</ul>

<p>
Full references at: 
</p>
<ul class="org-ul">
<li><a href="http://www.cplusplus.com/reference/iolibrary/">http://www.cplusplus.com/reference/iolibrary/</a></li>
</ul>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>C++ IO Class hierarchy</label><pre class="src src-text">                                ios
                                 +
                +----------------+--------------+
                |                               |
               \|/                             \|/
            +-------+                      +--------+
            |istream|                      |ostream |
            +--+----+                      +---+----+
               |                               |
              \|/       +-----------+         \|/
    +------------------&gt;+  iostream +&lt;------+--v--------+-----------+
    |          |        +-----+-----+       |           |           |
    v          v              |             v           v           v
*std::cin  ifstream           |         *std::cerr   ofstream   ostringstream
           istringstream      |          *std::cout
                              |          *std::clog
                        ------v------
                        |           |
                        v           v
                     fstream stringstream
</pre>
</div>


<p>
<b>Statefullness</b> 
</p>

<p>
The C++ IO streams are stateful, they have internal states for IO
configuration such as <a href="https://en.cppreference.com/w/cpp/io/ios_base/fmtflags">IO flags</a> and numerical precision. In the
following code, the IO manipulator std::boolalpha enables the IO flag
std::ios_base::boolalpha that makes the IO stream print booleans as
string instead of '0' or '1'. The flag can be disabled with the IO
manipulator std::noboolalpha.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = 1 flag2 = 0
&gt;&gt; 
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = 1 flag2 = 0
&gt;&gt; 

<span class="org-comment-delimiter">// </span><span class="org-comment">IO Manipulator that enables boolalpha flag which enables booleans</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">be print as strings instead of being print as numbers.</span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = <span class="org-constant">true</span> flag2 = <span class="org-constant">false</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Output continues in this way until the flag boolalpha is disabled. </span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = <span class="org-constant">true</span> flag2 = <span class="org-constant">false</span>
&gt;&gt; 

<span class="org-comment-delimiter">// </span><span class="org-comment">Disable flag </span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::noboolalpha;
&gt;&gt; 
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"flag1 = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" flag2 = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
flag1 = 1 flag2 = 0
</pre>
</div>
</div>
</div>
<div id="outline-container-orgec8bce8" class="outline-3">
<h3 id="orgec8bce8"><span class="section-number-3">1.2</span> IO Manipulators</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>All mapipulators: <a href="https://en.cppreference.com/w/cpp/io/manip">documentation</a></li>
</ul>

<p>
Switch numeric representation of booleans
</p>

<ul class="org-ul">
<li>std::boolapha
<ul class="org-ul">
<li>=&gt; Print booleans as 'true' or 'false' rather than 0 or 1.</li>
</ul></li>
<li>std::noboolalpha
<ul class="org-ul">
<li>=&gt; Print boolean as number true as 1 and false as 0.</li>
</ul></li>
</ul>

<p>
Case manipulators:
</p>

<ul class="org-ul">
<li>std::uppercase =&gt; Print everything as uppercase.</li>
<li>std::nouppercase =&gt; Print without forcing uppercase.</li>
</ul>

<p>
Change numerical base used for printing integers (flag std::ios::basefield)
</p>

<ul class="org-ul">
<li>std::dec =&gt; Print integers as decimal</li>
<li>std::hex =&gt; Print integers as heaxdecimal</li>
<li>std::oct =&gt; Print integers as octal</li>
</ul>

<p>
Float point number formatting: (flag: std::ios::floatfield)
</p>

<ul class="org-ul">
<li>std::defaultflot (C++11)</li>
<li>std::fixed
<ul class="org-ul">
<li>Print float with fixed precision (fixed numbers of decimal places)</li>
</ul></li>
<li>std::scientific
<ul class="org-ul">
<li>Print float with scientific notation</li>
</ul></li>
<li>std::hexfloat (C++11)</li>
</ul>

<p>
Float point precision: 
</p>

<ul class="org-ul">
<li>std::setprecision(int N)</li>
</ul>

<p>
Field adjusting (flag: std::ios::adjustfield)
</p>

<ul class="org-ul">
<li>std::ios::left</li>
<li>std::ios::right</li>
<li>std::ios::internal</li>
</ul>

<p>
Flushing manipulators:
</p>

<ul class="org-ul">
<li>std::flush
<ul class="org-ul">
<li>Flush output stream, in other words, it forces the stream
buffer to be written to the IO, for instance, it can force the
buffer of a file output stream to be written to a file. TL;DR
synchronize stream buffer with output.</li>
</ul></li>

<li>std::endl
<ul class="org-ul">
<li>Insert new line character in the output stream <code>\n</code> and flushes
the stream (std::flush).</li>
</ul></li>

<li>std::unitbuf
<ul class="org-ul">
<li>=&gt; Automatically flushes the output stream after each
operation. Note: most output streams flushes by default.</li>
<li>Sets the flag: std::ios_base::unitbuf.</li>
</ul></li>

<li>std::nounitbuf
<ul class="org-ul">
<li>=&gt; Disables automatic output stream flushing.</li>
<li>=&gt; Disables the flag: std::ios_base::unitbuf</li>
</ul></li>
</ul>


<p>
<b>Examples Float point IO manipulators</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(pi) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>M_PI<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; 2.50 &lt;&lt; <span class="org-string">"\n"</span>;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>pi<span class="org-rainbow-delimiters-depth-1">)</span> = 1.77245 x = 2.5
&gt;&gt; 

<span class="org-comment-delimiter">// </span><span class="org-comment">Precision 3 decimal places </span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-1">(</span>3<span class="org-rainbow-delimiters-depth-1">)</span>;
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(pi) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>M_PI<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; 2.50 &lt;&lt; <span class="org-string">"\n"</span>;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>pi<span class="org-rainbow-delimiters-depth-1">)</span> = 1.772 x = 2.500

<span class="org-comment-delimiter">// </span><span class="org-comment">Precision 6 decimal places </span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-1">(</span>6<span class="org-rainbow-delimiters-depth-1">)</span>;
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(pi) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>M_PI<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; 2.50 &lt;&lt; <span class="org-string">"\n"</span>;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>pi<span class="org-rainbow-delimiters-depth-1">)</span> = 1.772454 x = 2.500000

<span class="org-comment-delimiter">// </span><span class="org-comment">Reset float IO</span>
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::defaultfloat;
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(pi) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>M_PI<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; 2.50 &lt;&lt; <span class="org-string">"\n"</span>;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>pi<span class="org-rainbow-delimiters-depth-1">)</span> = 1.77245 x = 2.5
&gt;&gt; 
</pre>
</div>
</div>
</div>
<div id="outline-container-org80c535f" class="outline-3">
<h3 id="org80c535f"><span class="section-number-3">1.3</span> IO stream redirection</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-orgd4c09c5" class="outline-4">
<h4 id="orgd4c09c5"><span class="section-number-4">1.3.1</span> Stdout (cout) and Stderr (cerr) stream redirection</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Every process, has the following standard streams: 
</p>

<ul class="org-ul">
<li><b>stdin</b> - Standard input (file descriptor 0) =&gt; encapsulated by
global object <b>std::cin</b> (derived class of std::istream)</li>

<li><b>stdout</b> - Standard output (file descriptor 1) =&gt; encapsulated by
global object <b>std::cout</b> (derived class of std::ostream)
<ul class="org-ul">
<li>Normal program console output should use std::cout.</li>
</ul></li>

<li><b>stderr</b> - Standard error output (file descriptor 2) =&gt; encapsulated
by global object <b>std::cerr</b> (derived class of std::ostream)
<ul class="org-ul">
<li>Diagnostics, error and logging should use std::cerr as this
approach allows separating logging and diagnostics from program
output and redirecting or discarding them.</li>
<li>Note: Stream redirection is also possible on Windows. Althoug, it
is not so usual as in Unix-like operating system due to low usage
of terminal application in Windows.</li>
<li>Note: A Windows application compiled for GUI subsystem will not
display any output stream even if it is run from the terminal.</li>
</ul></li>
</ul>

<p>
<b>Example:</b>
</p>

<ul class="org-ul">
<li>File: stream-redirect.cpp
<ul class="org-ul">
<li>Sample program that solves the equation f(x) = x^3 - a = 0 using
newton raphson method.</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> <span class="org-comment-delimiter">// </span><span class="org-comment">std::cout, std::cerr ...</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>   <span class="org-comment-delimiter">// </span><span class="org-comment">std::stod </span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>    <span class="org-comment-delimiter">// </span><span class="org-comment">std::sin, std::fabs, std::abs, ... </span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>  <span class="org-comment-delimiter">// </span><span class="org-comment">std::seprecision, std::fixed </span>

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-comment-delimiter">// </span><span class="org-comment">1e-6 or 6 digits tolerance </span>
     <span class="org-type">double</span> <span class="org-variable-name">tolerance</span> = 0.000001;
     <span class="org-comment-delimiter">// </span><span class="org-comment">Maximum number of iterationrs </span>
     <span class="org-type">size_t</span> <span class="org-variable-name">itermax</span>   = 200;

     <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>argc &lt; 2<span class="org-rainbow-delimiters-depth-2">)</span>
     <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Solves equation x^3 - a = 0 using Newton Raphson Method"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
          <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" Error: input parameter not provided"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
          <span class="org-keyword">return</span> EXIT_FAILURE;
     <span class="org-rainbow-delimiters-depth-2">}</span>

     <span class="org-comment-delimiter">//</span><span class="org-comment">------- Parse Input Argument --------------</span>
     <span class="org-type">double</span> <span class="org-variable-name">a</span>;
     <span class="org-keyword">try</span> <span class="org-rainbow-delimiters-depth-2">{</span>
             a = <span class="org-constant">std</span>::stod<span class="org-rainbow-delimiters-depth-3">(</span>argv<span class="org-rainbow-delimiters-depth-4">[</span>1<span class="org-rainbow-delimiters-depth-4">]</span><span class="org-rainbow-delimiters-depth-3">)</span>;
     <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">exception</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
             <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [ERROR] "</span> &lt;&lt; ex.what<span class="org-rainbow-delimiters-depth-3">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
             <span class="org-keyword">return</span> EXIT_FAILURE;
     <span class="org-rainbow-delimiters-depth-2">}</span>

     <span class="org-type">double</span> <span class="org-variable-name">dx</span>, <span class="org-variable-name">x</span> = a;
     <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-2">(</span>4<span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-type">int</span> <span class="org-variable-name">w</span> = 10;

     <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [INFO] Solving equation f(x) = x^3 - a ; for a = "</span> &lt;&lt; a &lt;&lt; <span class="org-string">"\n\n"</span>;

     <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>w<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"Iter"</span>
                       &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>w<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"x"</span>
                       &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>w<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"AbsErr"</span>
                       &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>w<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"RelErr%"</span>
                       &lt;&lt; <span class="org-constant">std</span>::endl;    

     <span class="org-comment-delimiter">// </span><span class="org-comment">Find the cubic root by solving the following equation with</span>
     <span class="org-comment-delimiter">// </span><span class="org-comment">Newton Raphson method: </span>
     <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; F(x) = x^3 - a = 0</span>
     <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">auto</span> <span class="org-variable-name">iter</span> = 0; iter &lt; itermax; iter++<span class="org-rainbow-delimiters-depth-2">)</span>
     <span class="org-rainbow-delimiters-depth-2">{</span>
         dx  = <span class="org-rainbow-delimiters-depth-3">(</span>x * x * x - a <span class="org-rainbow-delimiters-depth-3">)</span> / <span class="org-rainbow-delimiters-depth-3">(</span> 2.0 * x * x<span class="org-rainbow-delimiters-depth-3">)</span>;
         x   = x - dx;

         <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>w<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; iter
                   &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>w<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; x
                   &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>w<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; <span class="org-constant">std</span>::fabs<span class="org-rainbow-delimiters-depth-3">(</span>dx<span class="org-rainbow-delimiters-depth-3">)</span>
                   &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>w<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; 100.0 * <span class="org-constant">std</span>::fabs<span class="org-rainbow-delimiters-depth-3">(</span>dx / x<span class="org-rainbow-delimiters-depth-3">)</span>
                   &lt;&lt; <span class="org-constant">std</span>::endl;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">std</span>::fabs<span class="org-rainbow-delimiters-depth-4">(</span>dx<span class="org-rainbow-delimiters-depth-4">)</span> &lt; tolerance * <span class="org-constant">std</span>::fabs<span class="org-rainbow-delimiters-depth-4">(</span>x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" Cubic root of a = "</span> &lt;&lt; a
                      &lt;&lt; <span class="org-string">" ; is approximately "</span> &lt;&lt; x
                      &lt;&lt; <span class="org-string">" number of iteratios is "</span> &lt;&lt; iter + 1
                      &lt;&lt; <span class="org-constant">std</span>::endl;
            <span class="org-keyword">return</span> EXIT_SUCCESS;
        <span class="org-rainbow-delimiters-depth-3">}</span>
     <span class="org-rainbow-delimiters-depth-2">}</span>
     <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [FAILURE] Root does not converge"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
     <span class="org-keyword">return</span> EXIT_FAILURE;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Compiling: 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">GCC</span>
$ g++     stream-redirect.cpp -o <span class="org-keyword">stream-redirect.bin</span> -std=c++1z -g -O0 -Wall
<span class="org-comment-delimiter"># </span><span class="org-comment">Clang / LLVM </span>
$ clang++ stream-redirect.cpp -o <span class="org-keyword">stream-redirect.bin</span> -std=c++1z -g -O0 -Wall
</pre>
</div>

<p>
Running: 
</p>

<ul class="org-ul">
<li>Print all results - the standard streams stdcout (std::cout) and
stderr are redirected to console by default.</li>
<li>Note: Stream redirectiion peformed on Bash shell on Linux.</li>
</ul>


<div class="org-src-container">
<pre class="src src-text">$ ./stream-redirection.bin 125.0
 [INFO] Solving equation f(x) = x^3 - a ; for a = 125.0000

      Iter         x    AbsErr   RelErr%
         0   62.5040   62.4960   99.9872
         1   31.2680   31.2360   99.8977
         2   15.6979   15.5701   99.1855
         3    8.1026    7.5953   93.7396
         4    5.0033    3.0993   61.9454
         5    4.9984    0.0049    0.0985
         6    5.0008    0.0025    0.0492
         7    4.9996    0.0012    0.0246
         8    5.0002    0.0006    0.0123
         9    4.9999    0.0003    0.0062
        10    5.0001    0.0002    0.0031
        11    5.0000    0.0001    0.0015
        12    5.0000    0.0000    0.0008
        13    5.0000    0.0000    0.0004
        14    5.0000    0.0000    0.0002
        15    5.0000    0.0000    0.0001
 Cubic root of a = 125 ; is approximately 5 number of iteratios is 16
</pre>
</div>


<ul class="org-ul">
<li>Discard stderr standard error stream by redirecting it to
/dev/null. Note: valid for Unix-like OSes (Linux, BSD, OSX, QNX &#x2026;): 
<ul class="org-ul">
<li>$ ./program 2&gt; /dev/null</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-text">$ ./stream-redirect.bin 125.0 2&gt; /dev/null
 Cubic root of a = 125 ; is approximately 5 number of iteratios is 16
</pre>
</div>

<ul class="org-ul">
<li>Discard stdout - standard output by redirecting it to /dev/null
(Unix-like OSes)
<ul class="org-ul">
<li>$ ./program &gt; /dev/null</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-text">$ ./stream-redirect.bin 125.0 &gt; /dev/null
 [INFO] Solving equation f(x) = x^3 - a ; for a = 125.0000

      Iter         x    AbsErr   RelErr%
         0   62.5040   62.4960   99.9872
         1   31.2680   31.2360   99.8977
         2   15.6979   15.5701   99.1855
         3    8.1026    7.5953   93.7396
         4    5.0033    3.0993   61.9454
         5    4.9984    0.0049    0.0985
         6    5.0008    0.0025    0.0492
         7    4.9996    0.0012    0.0246
         8    5.0002    0.0006    0.0123
         9    4.9999    0.0003    0.0062
        10    5.0001    0.0002    0.0031
        11    5.0000    0.0001    0.0015
        12    5.0000    0.0000    0.0008
        13    5.0000    0.0000    0.0004
        14    5.0000    0.0000    0.0002
        15    5.0000    0.0000    0.0001
</pre>
</div>

<ul class="org-ul">
<li>Discard both stdout and stderr by redirecting them to /dev/null
<ul class="org-ul">
<li>./prorgram &gt; /dev/null 2&gt;&amp;1</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ ./stream-redirect.bin 125.0 &gt; /dev/null 2&gt;&amp;1
</pre>
</div>

<ul class="org-ul">
<li>Redirect stdout - standard output stream to a file.
<ul class="org-ul">
<li>./program &gt; stdout.log</li>
<li>Only the stderr is printed, the stdout is redirected to the text
file stdout.log</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ ./stream-redirect.bin 125.0 &gt; stdout.log
 [INFO] Solving equation f(x) = x^3 - a ; <span class="org-keyword">for</span> a = 125.0000

      Iter         x    AbsErr   RelErr%
         0   62.5040   62.4960   99.9872
         1   31.2680   31.2360   99.8977
         2   15.6979   15.5701   99.1855
         3    8.1026    7.5953   93.7396
         4    5.0033    3.0993   61.9454
         5    4.9984    0.0049    0.0985
         6    5.0008    0.0025    0.0492
         7    4.9996    0.0012    0.0246
         8    5.0002    0.0006    0.0123
         9    4.9999    0.0003    0.0062
        10    5.0001    0.0002    0.0031
        11    5.0000    0.0001    0.0015
        12    5.0000    0.0000    0.0008
        13    5.0000    0.0000    0.0004
        14    5.0000    0.0000    0.0002
        15    5.0000    0.0000    0.0001

<span class="org-comment-delimiter"># </span><span class="org-comment">Check file </span>
$ cat stdout.log 
 Cubic root of a = 125 ; is approximately 5 number of iteratios is 16
</pre>
</div>

<ul class="org-ul">
<li>Redirect stderr (std::cerr) - standard error stream to file.
<ul class="org-ul">
<li>./program 2&gt; stderr.log</li>
<li>Only the stdout is printed and the stderr is redirect to the text
file stderr.log</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ ./stream-redirect.bin 125.0 2&gt; stderr.log
 Cubic root of a = 125 ; is approximately 5 number of iteratios is 16

<span class="org-comment-delimiter"># </span><span class="org-comment">Show first 5 lines of log file </span>
$ head -n 5 stderr.log 
 [INFO] Solving equation f(x) = x^3 - a ; <span class="org-keyword">for</span> a = 125.0000

      Iter         x    AbsErr   RelErr%
         0   62.5040   62.4960   99.9872
         1   31.2680   31.2360   99.8977

<span class="org-comment-delimiter"># </span><span class="org-comment">Show last 5 lines of log file </span>
$ tail -n 5 stderr.log 
        11    5.0000    0.0001    0.0015
        12    5.0000    0.0000    0.0008
        13    5.0000    0.0000    0.0004
        14    5.0000    0.0000    0.0002
        15    5.0000    0.0000    0.0001
</pre>
</div>

<ul class="org-ul">
<li>Redirect both streams to different files: stdcout (std::cout) and
stderr (std:cerr)
<ul class="org-ul">
<li>$ ./program &gt; stdout.txt 2&gt; stderr.txt</li>
<li>The stdout (std::cout) is redirected to the file stdout.txt and
the stderr (std::cerr) is redirected to the file stderr.txt</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ ./stream-redirect.bin 125.0 &gt; stdout.txt 2&gt; stderr.txt

<span class="org-comment-delimiter"># </span><span class="org-comment">Check stdout (std::cout) log file </span>
$ cat stdout.txt 
 Cubic root of a = 125 ; is approximately 5 number of iteratios is 16

<span class="org-comment-delimiter"># </span><span class="org-comment">Check stderr (std::cerr) log file </span>
$ tail -n 5 stderr.txt 
        11    5.0000    0.0001    0.0015
        12    5.0000    0.0000    0.0008
        13    5.0000    0.0000    0.0004
        14    5.0000    0.0000    0.0002
        15    5.0000    0.0000    0.0001
</pre>
</div>

<ul class="org-ul">
<li>Redirect both streams to the same log file.
<ul class="org-ul">
<li>./program &gt; log.txt 2&gt;&amp;1</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-text">$ ./stream-redirect.bin 125.0 &gt; log.txt 2&gt;&amp;1 

$ cat log.txt 
 [INFO] Solving equation f(x) = x^3 - a ; for a = 125.0000

      Iter         x    AbsErr   RelErr%
         0   62.5040   62.4960   99.9872
         1   31.2680   31.2360   99.8977
         2   15.6979   15.5701   99.1855
         3    8.1026    7.5953   93.7396
         4    5.0033    3.0993   61.9454
         5    4.9984    0.0049    0.0985
         6    5.0008    0.0025    0.0492
         7    4.9996    0.0012    0.0246
         8    5.0002    0.0006    0.0123
         9    4.9999    0.0003    0.0062
        10    5.0001    0.0002    0.0031
        11    5.0000    0.0001    0.0015
        12    5.0000    0.0000    0.0008
        13    5.0000    0.0000    0.0004
        14    5.0000    0.0000    0.0002
        15    5.0000    0.0000    0.0001
 Cubic root of a = 125 ; is approximately 5 number of iteratios is 16
</pre>
</div>

<p>
<b>Capturing process stdout and stderr with Python subprocess module</b> 
</p>

<p>
Run C++ program <span class="underline">stream-redirect.bin</span> as subprocess: 
</p>
<ul class="org-ul">
<li><a href="https://docs.python.org/3.6/library/subprocess.html">Subprocess documentation</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-python">$ python3
Python 3.6.8 (default, Mar 21 2019, 10:08:12) 
[GCC 8.3.1 20190223 (Red Hat 8.3.1-2)] on linux
Type <span class="org-string">"help"</span>, <span class="org-string">"copyright"</span>, <span class="org-string">"credits"</span> <span class="org-keyword">or</span> <span class="org-string">"license"</span> <span class="org-keyword">for</span> more information.
&gt;&gt;&gt; 

&gt;&gt;&gt; <span class="org-keyword">import</span> subprocess <span class="org-keyword">as</span> sp 

<span class="org-comment-delimiter">#  </span><span class="org-comment">Process result </span>
&gt;&gt;&gt; <span class="org-variable-name">r</span> = sp.run([<span class="org-string">"./stream-redirection.bin"</span>, <span class="org-string">"125"</span>], stdout = sp.PIPE, stderr = sp.PIPE)
&gt;&gt;&gt; 
</pre>
</div>

<p>
Check status code: 
</p>
<ul class="org-ul">
<li>Process status code =&gt; Numeric value returned by int main(&#x2026;.){ &#x2026; }</li>
<li>0 =&gt; Status code means successful return</li>
</ul>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; r.returncode
0
</pre>
</div>

<p>
Check captured stdout: 
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">=============== Stdout =&gt; Standarde Output Stream =====================#</span>

&gt;&gt;&gt; <span class="org-builtin">type</span>(r.stdout)
&lt;<span class="org-keyword">class</span> <span class="org-string">'bytes'</span>&gt;

&gt;&gt;&gt; r.stdout
b<span class="org-string">' Cubic root of a = 125 ; is approximately 5 number of iteratios is 16\n'</span>
&gt;&gt;&gt; 

&gt;&gt;&gt; <span class="org-keyword">print</span>(r.stdout.decode(<span class="org-string">'utf-8'</span>))
 Cubic root of <span class="org-variable-name">a</span> = 125 ; <span class="org-keyword">is</span> approximately 5 number of iteratios <span class="org-keyword">is</span> 16
</pre>
</div>

<p>
Check captured stderr: 
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; Type is a byte array </span>
&gt;&gt;&gt; <span class="org-builtin">type</span>(r.stderr)
&lt;<span class="org-keyword">class</span> <span class="org-string">'bytes'</span>&gt;

<span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; Type is a python string </span>
&gt;&gt;&gt; <span class="org-builtin">type</span>(r.stderr.decode(<span class="org-string">'utf-8'</span>))
&lt;<span class="org-keyword">class</span> <span class="org-string">'str'</span>&gt;
&gt;&gt;&gt; 

&gt;&gt;&gt; <span class="org-keyword">print</span>(r.stderr.decode(<span class="org-string">'utf-8'</span>))
 [INFO] Solving equation f(x) = x^3 - a ; <span class="org-keyword">for</span> <span class="org-variable-name">a</span> = 125.0000

      Iter         x    AbsErr   RelErr%
         0   62.5040   62.4960   99.9872
         1   31.2680   31.2360   99.8977
         2   15.6979   15.5701   99.1855

       ... ... .... .... ... ... ... .... .... 

        15    5.0000    0.0000    0.0001
</pre>
</div>
</div>
</div>

<div id="outline-container-org0f90ea9" class="outline-4">
<h4 id="org0f90ea9"><span class="section-number-4">1.3.2</span> Stdin (cin) stream redirection</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
<b>File:</b> input-redirection.cpp 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> <span class="org-comment-delimiter">// </span><span class="org-comment">Import: std::cout, std::cin, std::cerr </span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Import: std::setw </span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>   <span class="org-comment-delimiter">// </span><span class="org-comment">Import: std::string</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> <span class="org-comment-delimiter">// </span><span class="org-comment">Import: std::function </span>

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>argc &gt; 1 &amp;&amp; <span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-3">(</span>argv<span class="org-rainbow-delimiters-depth-4">[</span>1<span class="org-rainbow-delimiters-depth-4">]</span><span class="org-rainbow-delimiters-depth-3">)</span> == <span class="org-string">"--help"</span><span class="org-rainbow-delimiters-depth-2">)</span>
     <span class="org-rainbow-delimiters-depth-2">{</span>
         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Count line numbers of some file."</span> &lt;&lt; <span class="org-constant">std</span>::endl;
         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" Usage: \n"</span>
                   &lt;&lt; <span class="org-string">"  $  "</span> &lt;&lt; argv<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> &lt;&lt; <span class="org-string">" &lt; file.txt \n"</span>
                   &lt;&lt; <span class="org-string">"  $  cat file.txt | "</span> &lt;&lt; argv<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> &lt;&lt; <span class="org-string">"\n\n"</span>;
         <span class="org-comment-delimiter">// </span><span class="org-comment">Early return </span>
         <span class="org-keyword">return</span> 0;
     <span class="org-rainbow-delimiters-depth-2">}</span>  

     <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">line</span>;
     <span class="org-type">long</span> <span class="org-variable-name">counter</span>  = -1;

     <span class="org-comment-delimiter">// </span><span class="org-comment">Self-executable lambda used for returning a value from the if-else </span>
     <span class="org-type">bool</span> <span class="org-variable-name">showLine</span> = <span class="org-rainbow-delimiters-depth-2">[</span>&amp;<span class="org-rainbow-delimiters-depth-2">]{</span>
                           <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>argc &gt; 1 &amp;&amp; <span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-4">(</span>argv<span class="org-rainbow-delimiters-depth-5">[</span>1<span class="org-rainbow-delimiters-depth-5">]</span><span class="org-rainbow-delimiters-depth-4">)</span> == <span class="org-string">"--show-line"</span><span class="org-rainbow-delimiters-depth-3">)</span>
                                   <span class="org-keyword">return</span> <span class="org-constant">true</span>;
                           <span class="org-keyword">return</span> <span class="org-constant">false</span>;
                   <span class="org-rainbow-delimiters-depth-2">}()</span>;

     <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-constant">std</span>::boolalpha &lt;&lt; <span class="org-string">" [INFO] showLine = "</span> &lt;&lt; showLine &lt;&lt; <span class="org-constant">std</span>::endl;

     <span class="org-comment-delimiter">/* </span><span class="org-comment">Note: The comma opeator evaluates first (counter++) and then </span>
<span class="org-comment">      * evaluates std::getline(std::cin, line) returning its value. </span>
<span class="org-comment">      */</span>
     <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-2">(</span>counter++, <span class="org-constant">std</span>::getline<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">std</span>::cin, line<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">){</span>
          <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>showLine<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">{</span>
                  <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"\n"</span> &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-4">(</span>4<span class="org-rainbow-delimiters-depth-4">)</span> &lt;&lt; counter
                                    &lt;&lt; <span class="org-string">" "</span>  &lt;&lt; <span class="org-constant">std</span>::left  &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-4">(</span>8<span class="org-rainbow-delimiters-depth-4">)</span> &lt;&lt;  line;
          <span class="org-rainbow-delimiters-depth-3">}</span>
     <span class="org-rainbow-delimiters-depth-2">}</span>

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"\n\n File has "</span> &lt;&lt; counter &lt;&lt; <span class="org-string">" lines "</span> &lt;&lt; <span class="org-constant">std</span>::endl;    
     <span class="org-keyword">return</span> 0; 
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>

<p>
<b>Compiling:</b> 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Clang </span>
$ clang++ input-redirection.cpp -o <span class="org-keyword">input-redirection.bin</span> -std=c++1z -g -O0 -Wall

<span class="org-comment-delimiter"># </span><span class="org-comment">GCC </span>
$ gcc++ input-redirection.cpp -o <span class="org-keyword">input-redirection.bin</span> -std=c++1z -g -O0 -Wall
</pre>
</div>

<p>
<b>Usage</b>: 
</p>

<p>
Display help: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ./input-redirection.bin --help
Count line numbers of some file.
 Usage: 
  $  ./input-redirection.bin &lt; file.txt 
  $  cat file.txt | ./input-redirection.bin
</pre>
</div>

<p>
Count number of line in input stream stdin (std::cin) typed by user: 
</p>
<ul class="org-ul">
<li>Note: When the user is done, he types CTRL + D to send EOF (End Of
File) character to process.</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ ./input-redirection.bin
 [INFO] showLine = false
DXY index 
  VIX implied volatility 
     VAR VALUE AT RISK 
     standard deviation commodity prices 
         monte carlo simulations stochastic volatility

  Finaly user types CTRL + D when he is done to send EOF signal character to process.

 File has 7 lines 
</pre>
</div>

<p>
Redirect output stream (stdout) of <b>echo</b> program to input stream
(stdin) of input-redirection.bin: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ echo -e <span class="org-string">" line0\n line1\n line2"</span> 
 line0
 line1
 line2

$ echo -e <span class="org-string">" line0\n line1\n line2"</span> | ./input-redirection.bin 
 [INFO] showLine = false


 File has 3 lines 


$ echo -e <span class="org-string">" line0\n line1\n line2"</span> | ./input-redirection.bin --show-line
 [INFO] showLine = true

   0    line0
   1    line1
   2    line2

 File has 3 lines 
</pre>
</div>

<p>
Redirect file to input stream (stdin) of process
input-redirection.bin: 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Show test file </span>
<span class="org-comment-delimiter">#</span><span class="org-comment">-------------------------------------------------</span>
$ cat /etc/filesystems 
ext4
ext3
ext2
nodev proc
nodev devpts
iso9660
vfat
hfs
hfsplus
*

<span class="org-comment-delimiter"># </span><span class="org-comment">Redirect test file to process' input stream without displaying lines </span>
<span class="org-comment-delimiter">#</span><span class="org-comment">-------------------------------------------------</span>
$ ./input-redirection.bin &lt; /etc/filesystems 
 [INFO] showLine = false


 File has 10 lines 

<span class="org-comment-delimiter"># </span><span class="org-comment">Redirect test file to process' input stream displaying its lines </span>
<span class="org-comment-delimiter">#</span><span class="org-comment">-------------------------------------------------</span>
$ ./input-redirection.bin --show-line &lt; /etc/filesystems 
 [INFO] showLine = true

   0 ext4    
   1 ext3    
   2 ext2    
   3 nodev proc
   4 nodev devpts
   5 iso9660 
   6 vfat    
   7 hfs     
   8 hfsplus 
   9 *       

 File has 10 lines 
</pre>
</div>


<p>
<b>Input redirection with Python Subprocess Module</b> 
</p>

<div class="org-src-container">
<pre class="src src-python">$ python3
Python 3.6.8 (default, Mar 21 2019, 10:08:12) 
[GCC 8.3.1 20190223 (Red Hat 8.3.1-2)] on linux
Type <span class="org-string">"help"</span>, <span class="org-string">"copyright"</span>, <span class="org-string">"credits"</span> <span class="org-keyword">or</span> <span class="org-string">"license"</span> <span class="org-keyword">for</span> more information.

&gt;&gt;&gt; <span class="org-keyword">import</span> subprocess <span class="org-keyword">as</span> sp
&gt;&gt;&gt; 
&gt;&gt;&gt; <span class="org-builtin">input</span> = <span class="org-string">" ASM\n RUST \nC++  \n Lisp \n Ocaml\n Haskell\n --- Scala"</span>
&gt;&gt;&gt; 
</pre>
</div>

<p>
Redirect Python input string to process: 
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span class="org-variable-name">r</span> = sp.run([<span class="org-string">"./input-redirection.bin"</span>], stdout = sp.PIPE, stderr = sp.PIPE, <span class="org-builtin">input</span> = <span class="org-builtin">input</span>.encode())

&gt;&gt;&gt; r
CompletedProcess(args=[<span class="org-string">'./input-redirection.bin'</span>], returncode=0, stdout=b<span class="org-string">'\n\n File has 7 lines \n'</span>, stderr=b<span class="org-string">' [INFO] showLine = false\n'</span>)
</pre>
</div>

<p>
Proces status code: numeric value returned by  <b>int main(&#x2026;)</b> function.
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; r.returncode
0
</pre>
</div>

<p>
Process stdout: 
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; r.stdout
b<span class="org-doc">'\n\n File has 7 lines \n'</span>
&gt;&gt;&gt; 

&gt;&gt;&gt; <span class="org-keyword">print</span>(r.stdout.decode())


 File has 7 lines 
</pre>
</div>

<p>
Proces stderr: 
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; r.stderr.decode()
<span class="org-doc">' [INFO] showLine = false\n'</span>
&gt;&gt;&gt; 
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4112ebd" class="outline-3">
<h3 id="org4112ebd"><span class="section-number-3">1.4</span> Generic Input Stream - read data from file, console and memory</h3>
<div class="outline-text-3" id="text-1-4">
<p>
File: readInventory.cpp 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> <span class="org-comment-delimiter">// </span><span class="org-comment">std::cout, std::cin, std::istream, std::ostream ...</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">fstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>  <span class="org-comment-delimiter">// </span><span class="org-comment">std::ifstream, std::ofstream</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Import: std::stringstream</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Import: std::quoted</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">struct</span> <span class="org-type">InventoryItem</span><span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">/// </span><span class="org-comment">Database id</span>
    <span class="org-type">unsigned</span> <span class="org-type">int</span> <span class="org-variable-name">id</span>;
    <span class="org-comment-delimiter">/// </span><span class="org-comment">Produce name</span>
    <span class="org-constant">std</span>::<span class="org-type">string</span>  <span class="org-variable-name">name</span>;
    <span class="org-comment-delimiter">/// </span><span class="org-comment">Price per unit</span>
    <span class="org-type">double</span>       <span class="org-variable-name">price</span>;
    <span class="org-comment-delimiter">/// </span><span class="org-comment">Quanity</span>
    <span class="org-type">unsigned</span> <span class="org-type">int</span> <span class="org-variable-name">quantity</span>;

    <span class="org-function-name">InventoryItem</span><span class="org-rainbow-delimiters-depth-2">()</span>: id<span class="org-rainbow-delimiters-depth-2">{</span>0<span class="org-rainbow-delimiters-depth-2">}</span>, name<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">""</span><span class="org-rainbow-delimiters-depth-2">}</span>, price<span class="org-rainbow-delimiters-depth-2">{</span>0.0<span class="org-rainbow-delimiters-depth-2">}</span>, quantity<span class="org-rainbow-delimiters-depth-2">{</span>0<span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">using</span> <span class="org-type">Inventory</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">InventoryItem</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>;

<span class="org-type">void</span>      <span class="org-function-name">showInventory</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">Inventory</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">inventory</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">Inventory</span> <span class="org-function-name">readInventory</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">istream</span>&amp; <span class="org-variable-name">is</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">Inventory</span> <span class="org-function-name">readInventoryFromFile</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">file</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">sampleData</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>argc &lt; 2<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Usage: "</span> &lt;&lt; <span class="org-string">"\n"</span>
                  &lt;&lt; <span class="org-string">"$ "</span> &lt;&lt; argv<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>   &lt;&lt; <span class="org-string">" file [FILE] "</span> &lt;&lt; <span class="org-string">"\n"</span>
                  &lt;&lt; <span class="org-string">"$ "</span> &lt;&lt; argv<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>   &lt;&lt; <span class="org-string">" memory"</span> &lt;&lt; <span class="org-string">"\n"</span>
                  &lt;&lt; <span class="org-string">"$ "</span> &lt;&lt; argv<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>   &lt;&lt; <span class="org-string">" console"</span> &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-keyword">return</span> EXIT_FAILURE;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">cmd</span> = argv<span class="org-rainbow-delimiters-depth-2">[</span>1<span class="org-rainbow-delimiters-depth-2">]</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Self  test - read memory stream</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>cmd == <span class="org-string">"memory"</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">ss</span>        = <span class="org-constant">std</span>::stringstream<span class="org-rainbow-delimiters-depth-3">{</span>sampleData<span class="org-rainbow-delimiters-depth-3">}</span>;
        <span class="org-keyword">auto</span> <span class="org-variable-name">inventory</span> = readInventory<span class="org-rainbow-delimiters-depth-3">(</span>ss<span class="org-rainbow-delimiters-depth-3">)</span>;
        showInventory<span class="org-rainbow-delimiters-depth-3">(</span>inventory<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> EXIT_SUCCESS;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Read user file</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>argc == 3 &amp;&amp; cmd == <span class="org-string">"file"</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">file</span> = argv<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" Reading file: "</span> &lt;&lt; file &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-type">Inventory</span> <span class="org-variable-name">inventory</span> = readInventoryFromFile<span class="org-rainbow-delimiters-depth-3">(</span>file<span class="org-rainbow-delimiters-depth-3">)</span>;
        showInventory<span class="org-rainbow-delimiters-depth-3">(</span>inventory<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> EXIT_SUCCESS;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Read console</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>cmd == <span class="org-string">"console"</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Type the inventory and then type Ctlr + D when you are done."</span>
                  &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-keyword">auto</span> <span class="org-variable-name">inventory</span> = readInventory<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">std</span>::cin<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" ---- Inventory Value ---------"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        showInventory<span class="org-rainbow-delimiters-depth-3">(</span>inventory<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> EXIT_SUCCESS;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [ERROR] Invalid command line option."</span> &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-keyword">return</span> EXIT_FAILURE;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------------------------------------------------------------//</span>

<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">sampleData</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">297  "Current sensor"           9.60    300</span>
<span class="org-string">871  "Pressure transducer"     90.00     50</span>
<span class="org-string">751  "Temperature SPI sensor"  40.25     20</span>
<span class="org-string">652  "Gyroscope"              220.50     45</span>
<span class="org-string">)</span><span class="org-default">"</span>;


<span class="org-type">void</span> <span class="org-function-name">showInventory</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">Inventory</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">inventory</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-2">(</span>2<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-constant">std</span>::fixed;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>5<span class="org-rainbow-delimiters-depth-2">)</span>  &lt;&lt; <span class="org-string">"ID"</span>
              &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>5<span class="org-rainbow-delimiters-depth-2">)</span>  &lt;&lt; <span class="org-string">" "</span>
              &lt;&lt; <span class="org-constant">std</span>::left  &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>30<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"Name"</span>
              &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>10<span class="org-rainbow-delimiters-depth-2">)</span>  &lt;&lt; <span class="org-string">"Price"</span>
              &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>12<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"Quantity"</span>
              &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-2">(</span>12<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"Value"</span>
              &lt;&lt; <span class="org-string">"\n"</span>;

    <span class="org-type">double</span> <span class="org-variable-name">total</span> = 0.0;
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">auto</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">item</span>: inventory<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>5<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; item.id
                  &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>5<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; <span class="org-string">" "</span>
                  &lt;&lt; <span class="org-constant">std</span>::left  &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>30<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; item.name
                  &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>10<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; item.price
                  &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>12<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; item.quantity
                  &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>12<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; item.quantity * item.price
                  &lt;&lt; <span class="org-string">"\n"</span>;
        total += item.quantity * item.price;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"\n Total inventory value: "</span> &lt;&lt; total &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">/** </span><span class="org-comment">Read inventory from any input stream (derived class from std::istream) such</span>
<span class="org-comment"> *  as std::ifstream, std::cin, std::sstringstream.</span>
<span class="org-comment"> */</span>
<span class="org-type">Inventory</span>
<span class="org-function-name">readInventory</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">istream</span>&amp; <span class="org-variable-name">is</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">InventoryItem</span> <span class="org-variable-name">currentItem</span>;
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">InventoryItem</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">inventory</span>;

    <span class="org-constant">std</span>::<span class="org-type">string</span>       <span class="org-variable-name">line</span>;
    <span class="org-constant">std</span>::<span class="org-type">stringstream</span> <span class="org-variable-name">sline</span>;
    <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::getline<span class="org-rainbow-delimiters-depth-3">(</span>is, line<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>line == <span class="org-string">""</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-keyword">continue</span>; <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Reset sline status flags</span>
        sline.clear<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Reset the value of sline stringstream</span>
        sline.str<span class="org-rainbow-delimiters-depth-3">(</span>line<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Read line fields</span>
        sline &gt;&gt; currentItem.id &gt;&gt; <span class="org-constant">std</span>::quoted<span class="org-rainbow-delimiters-depth-3">(</span>currentItem.name<span class="org-rainbow-delimiters-depth-3">)</span>
            &gt;&gt; currentItem.price &gt;&gt; currentItem.quantity;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Check error flags and stop on error</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-negation-char">!</span>sline<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-keyword">auto</span> <span class="org-variable-name">error_message</span> =
                <span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"Error: invalid line: "</span><span class="org-rainbow-delimiters-depth-4">)</span> + line;
            <span class="org-keyword">throw</span>  <span class="org-constant">std</span>::runtime_error<span class="org-rainbow-delimiters-depth-4">(</span>error_message<span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
        inventory.push_back<span class="org-rainbow-delimiters-depth-3">(</span>currentItem<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">return</span> inventory;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">Inventory</span>
<span class="org-function-name">readInventoryFromFile</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">file</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">ifs</span> = <span class="org-constant">std</span>::ifstream<span class="org-rainbow-delimiters-depth-2">(</span>file<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>ifs<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" Error: file not found."</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-constant">std</span>::terminate<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">return</span> readInventory<span class="org-rainbow-delimiters-depth-2">(</span>ifs<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>

<p>
File: inventory1.txt 
</p>

<div class="org-src-container">
<pre class="src src-txt">200  "diode"                  3.40         100
300  "blue led"               5.10         200 
100  "power supply 5 Volts"  20.50          15
256  "battery 12 volts pack" 12.50          50
901  "light sensor"          60.00          40
</pre>
</div>

<p>
Building: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ g++ readInventory.cpp -o <span class="org-keyword">readInventory.bin</span> -std=c++1z -O0 -g
</pre>
</div>

<p>
Show options: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ./readInventory.bin 
<span class="org-function-name">Usage</span>: 
$ ./readInventory.bin file [FILE] 
$ ./readInventory.bin memory
$ ./readInventory.bin console
</pre>
</div>

<p>
Read and display inventory data from memory (std::stringstream): 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ./readInventory.bin memory
   ID     Name                               Price    Quantity       Value
  297     Current sensor                      9.60         300     2880.00
  871     Pressure transducer                90.00          50     4500.00
  751     Temperature SPI sensor             40.25          20      805.00
  652     Gyroscope                         220.50          45     9922.50

 Total inventory value: 18107.50
</pre>
</div>

<p>
Read and display inventory data from console: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ./readInventory.bin console
Type the inventory and then type Ctlr + D when you are done.
982 <span class="org-string">"IMU 6 axis"</span> 300.0 25
751 <span class="org-string">"Temperature sensor I2C"</span> 45.0 200
231 <span class="org-string">"Current transducer XYZWK"</span> 78.50 35
 ---- Inventory Value ---------
   ID     Name                               Price    Quantity       Value
  982     IMU 6 axis                        300.00          25     7500.00
  751     Temperature sensor I2C             45.00         200     9000.00
  231     Current transducer XYZWK           78.50          35     2747.50

 Total inventory value: 19247.50
</pre>
</div>

<p>
Read and display inventory data from file: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ./readInventory.bin file inventory1.txt 
 Reading file: inventory1.txt
   ID     Name                               Price    Quantity       Value
  200     diode                               3.40         100      340.00
  300     blue led                            5.10         200     1020.00
  100     power supply 5 Volts               20.50          15      307.50
  256     battery 12 volts pack              12.50          50      625.00
  901     light sensor                       60.00          40     2400.00

 Total inventory value: 4692.50
</pre>
</div>
</div>
</div>

<div id="outline-container-org450007d" class="outline-3">
<h3 id="org450007d"><span class="section-number-3">1.5</span> Custom IO manipulators</h3>
<div class="outline-text-3" id="text-1-5">
<p>
<b>Example: 1</b> 
</p>

<p>
Custom IO manipulator to print integers in hexadecimal format without
affecting IO global state.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">typename</span> <span class="org-type">Numeric</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> <span class="org-keyword">struct</span> <span class="org-type">to_hex</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-type">Numeric</span> <span class="org-variable-name">m_value</span>;
     <span class="org-function-name">to_hex</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">Numeric</span> <span class="org-variable-name">value</span><span class="org-rainbow-delimiters-depth-2">)</span>: <span class="org-function-name">m_value</span><span class="org-rainbow-delimiters-depth-2">(</span>value<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-rainbow-delimiters-depth-2">}</span>

     <span class="org-keyword">friend</span> <span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-type">to_hex</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">rhs</span><span class="org-rainbow-delimiters-depth-2">)</span>
     <span class="org-rainbow-delimiters-depth-2">{</span>
         <span class="org-keyword">return</span> os &lt;&lt; <span class="org-string">"0x"</span> &lt;&lt; <span class="org-constant">std</span>::uppercase &lt;&lt; <span class="org-constant">std</span>::hex
                   &lt;&lt; rhs.m_value &lt;&lt; <span class="org-constant">std</span>::nouppercase &lt;&lt; <span class="org-constant">std</span>::dec ;
     <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Usage: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; to_hex<span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;(</span>2561<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" y = "</span> &lt;&lt; 246 &lt;&lt; <span class="org-string">"\n"</span>;
x = 0xA01 y = 246

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; to_hex<span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;(</span>255<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">" y = "</span> &lt;&lt; 246 &lt;&lt; <span class="org-string">"\n"</span>;
x = 0xFF y = 246
</pre>
</div>

<p>
<b>Example 2</b> Custom IO manipulators for numerical tables. 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">type_traits</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Requires headers:  &lt;iostream&gt;, &lt;iomanip&gt;, &lt;type_traits&gt;</span>
<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span> 
   <span class="org-keyword">typename</span> <span class="org-type">Numeric</span>,
   <span class="org-comment-delimiter">// </span><span class="org-comment">Used for restricting the types of arguments that can be used. </span>
   <span class="org-comment-delimiter">// </span><span class="org-comment">It will generate a compiler error for non-float arguments. </span>
   <span class="org-keyword">typename</span> <span class="org-constant">std</span>::<span class="org-constant">enable_if</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::<span class="org-constant">is_floating_point</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">Numeric</span><span class="org-rainbow-delimiters-depth-3">&gt;</span>::value, <span class="org-type">void</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>::<span class="org-type">type</span>* = <span class="org-constant">nullptr</span>
   <span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">struct</span> <span class="org-type">to_fix</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">Numeric</span> <span class="org-variable-name">m_value</span>;
    <span class="org-type">size_t</span>  <span class="org-variable-name">m_precision</span>;
    <span class="org-type">size_t</span>  <span class="org-variable-name">m_field_size</span>;

    <span class="org-function-name">to_fix</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">Numeric</span> <span class="org-variable-name">value</span>, <span class="org-type">size_t</span> <span class="org-variable-name">fieldSize</span> = 8, <span class="org-type">size_t</span> <span class="org-variable-name">precision</span> = 4<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        m_value       = value;
        m_field_size  = fieldSize;
        m_precision   = precision;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-keyword">friend</span> <span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-type">to_fix</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">rhs</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">size_t</span> <span class="org-variable-name">prec</span> = os.precision<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-constant">std</span>::<span class="org-type">ios</span> <span class="org-variable-name">config</span><span class="org-rainbow-delimiters-depth-3">{</span><span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">}</span>;
        config.copyfmt<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">std</span>::cout<span class="org-rainbow-delimiters-depth-3">)</span>;  
        os &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-3">(</span>rhs.m_precision<span class="org-rainbow-delimiters-depth-3">)</span>
           &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>rhs.m_field_size<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; rhs.m_value;
        <span class="org-constant">std</span>::cout.copyfmt<span class="org-rainbow-delimiters-depth-3">(</span>config<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> os;
 <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Experiment 1: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span> = 0.0; x &lt; 4.0; x += 0.5<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-keyword">using</span> <span class="org-type">T</span> = <span class="org-type">double</span>;
     <span class="org-type">double</span> <span class="org-variable-name">y</span> = <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-constant">std</span>::cout &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>y<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Experiment 1 Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">0.0000  0.0000
0.5000  0.7071
1.0000  1.0000
1.5000  1.2247
2.0000  1.4142
2.5000  1.5811
3.0000  1.7321
3.5000  1.8708
</pre>
</div>

<p>
Experiment 2: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span> = 0.0; x &lt; 100.0; x += 10.0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-keyword">using</span> <span class="org-type">T</span> = <span class="org-type">double</span>;
     <span class="org-type">double</span> <span class="org-variable-name">y</span> = <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-constant">std</span>::cout &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x, 8, 2<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>y, 9, 5<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Experiment 2 output: 
</p>

<div class="org-src-container">
<pre class="src src-text"> 0.00  0.00000
10.00  3.16228
20.00  4.47214
30.00  5.47723
40.00  6.32456
50.00  7.07107
60.00  7.74597
70.00  8.36660
80.00  8.94427
90.00  9.48683
</pre>
</div>

<p>
Experiment 3: Print table to file.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::ofstream report<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"/tmp/report.txt"</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span> = 0.0; x &lt; 100.0; x += 10.0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-keyword">using</span> <span class="org-type">T</span> = <span class="org-type">double</span>;
     <span class="org-type">double</span> <span class="org-variable-name">y</span> = <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
     report &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x, 8, 2<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; to_fix<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>y, 9, 5<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Sync buffer with IO </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">force buffer to be written to IO </span>
report.flush<span class="org-rainbow-delimiters-depth-1">()</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Force close</span>
report.close<span class="org-rainbow-delimiters-depth-1">()</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Run shell command to check file </span>
&gt;&gt; .<span class="org-negation-char">!</span> head -n 3 /tmp/report.txt
    0.00  0.00000
   10.00  3.16228
   20.00  4.47214
&gt;&gt; 

&gt;&gt; .<span class="org-negation-char">!</span> tail -n 3 /tmp/report.txt
   70.00  8.36660
   80.00  8.94427
   90.00  9.48683
&gt;&gt; 
</pre>
</div>
</div>
</div>

<div id="outline-container-org6ab390e" class="outline-3">
<h3 id="org6ab390e"><span class="section-number-3">1.6</span> IO - Insertion &lt;&lt; and extraction &gt;&gt; operators</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-orge06a670" class="outline-4">
<h4 id="orge06a670"><span class="section-number-4">1.6.1</span> Operators insertion insertion for STL std::vector&lt;double&gt;</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
Operator insertion (&lt;&lt;) for type std::vector&lt;double&gt;: 
</p>

<ul class="org-ul">
<li>Code: <a href="https://wandbox.org/permlink/UX67EPtHSKpmXCR7">Wandbox Online Compiler</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

<span class="org-function-name">std</span>::ostream&amp; 
<span class="org-keyword">operator</span>&lt;&lt;<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">xs</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    os &lt;&lt; <span class="org-string">"["</span> &lt;&lt; xs.size<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"]( "</span>;
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp;  <span class="org-variable-name">x</span>: xs<span class="org-rainbow-delimiters-depth-2">)</span>
            os &lt;&lt; x &lt;&lt; <span class="org-string">", "</span>;
    <span class="org-keyword">return</span> os &lt;&lt; <span class="org-string">" )"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Function main: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> xs;
xs = <span class="org-rainbow-delimiters-depth-1">{}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xs = "</span> &lt;&lt; xs &lt;&lt; <span class="org-constant">std</span>::endl;
xs = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 5.0, 4.6, 1e4, 9.8<span class="org-rainbow-delimiters-depth-1">}</span>;    
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xs = "</span> &lt;&lt; xs &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-keyword">return</span> 0;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">xs = [0](  )
xs = [5]( 1, 5, 4.6, 10000, 9.8,  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc13c489" class="outline-4">
<h4 id="orgc13c489"><span class="section-number-4">1.6.2</span> Operators insertion insertion for STL std::vector&lt;T&gt;</h4>
<div class="outline-text-4" id="text-1-6-2">
<ul class="org-ul">
<li>Code: <a href="https://wandbox.org/permlink/NQN0loqv21td60P3">Wandbox Online Compiler</a></li>
</ul>

<p>
Operator: (&lt;&lt;)
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">typename</span> <span class="org-type">Element</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> 
<span class="org-function-name">std</span>::<span class="org-type">ostream</span>&amp; 
<span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Element</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">xs</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    os &lt;&lt; <span class="org-string">"["</span> &lt;&lt; xs.size<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"]( "</span>;
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp;  <span class="org-variable-name">x</span>: xs<span class="org-rainbow-delimiters-depth-2">)</span>
       os &lt;&lt; x &lt;&lt; <span class="org-string">" "</span>;
    <span class="org-keyword">return</span> os &lt;&lt; <span class="org-string">" )"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Main function: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> xs;
xs = <span class="org-rainbow-delimiters-depth-1">{}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xs = "</span> &lt;&lt; xs &lt;&lt; <span class="org-constant">std</span>::endl;
xs = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 5.0, 4.6, 1e4, 9.8<span class="org-rainbow-delimiters-depth-1">}</span>;    
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xs = "</span> &lt;&lt; xs &lt;&lt; <span class="org-constant">std</span>::endl;

<span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> xa = <span class="org-rainbow-delimiters-depth-1">{</span>1, 3, 4, 5, 6<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"xa = "</span> &lt;&lt; xa &lt;&lt; <span class="org-string">"\n"</span>;

<span class="org-keyword">auto</span> <span class="org-variable-name">words</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">&gt;{</span><span class="org-string">"hello"</span>, <span class="org-string">"world"</span>, <span class="org-string">"C++"</span>, <span class="org-string">"new"</span>, <span class="org-string">"machine"</span><span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"words = "</span> &lt;&lt; words &lt;&lt; <span class="org-string">"\n"</span>;

<span class="org-keyword">return</span> 0;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">xs = [0](  )
xs = [5]( 1 5 4.6 10000 9.8  )
xa = [5]( 1 3 4 5 6  )
words = [5]( hello world C++ new machine  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd204a19" class="outline-4">
<h4 id="orgd204a19"><span class="section-number-4">1.6.3</span> Operators insertion and extraction for used defined-type</h4>
<div class="outline-text-4" id="text-1-6-3">
<p>
This example shows how to overload the operators insertion (&lt;&lt;) and
extraction (&gt;&gt;) for an user defined type. Note: those operators are
not class methods, they are free functions.
</p>

<ul class="org-ul">
<li>File: <a href="src/insertionExtractionOverload.cpp">file:src/insertionExtractionOverload.cpp</a></li>
<li>Online Compile: <a href="https://wandbox.org/permlink/97fcclubA7KHWEry">https://wandbox.org/permlink/97fcclubA7KHWEry</a>  (No console input support)</li>
</ul>


<p>
Compiling and running: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ clang++ inputOutput.cpp -o <span class="org-keyword">inputOutput.bin</span> -std=c++1z -O0 -Wall &amp;&amp; ./inputOutput.bin
</pre>
</div>

<p>
Class Product (file: Product.hpp):
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">class</span> <span class="org-type">Product</span><span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-function-name">private</span>:
    <span class="org-type">int</span>          <span class="org-variable-name">m_id</span>;
    <span class="org-constant">std</span>::<span class="org-type">string</span>  <span class="org-variable-name">m_name</span>;
    <span class="org-type">double</span>       <span class="org-variable-name">m_price</span>;
<span class="org-function-name">public</span>:
    <span class="org-function-name">Product</span><span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-function-name">Product</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">id</span>, <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">name</span>, <span class="org-type">double</span> <span class="org-variable-name">price</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">int</span>         <span class="org-function-name">Id</span><span class="org-rainbow-delimiters-depth-2">()</span>    <span class="org-keyword">const</span>;
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-function-name">Name</span><span class="org-rainbow-delimiters-depth-2">()</span>  <span class="org-keyword">const</span>;
    <span class="org-type">double</span>      <span class="org-function-name">Price</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span>;
    <span class="org-type">void</span> <span class="org-function-name">showProduct</span><span class="org-rainbow-delimiters-depth-2">()</span>  <span class="org-keyword">const</span>;

    <span class="org-keyword">friend</span>
    <span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-type">Product</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">prod</span><span class="org-rainbow-delimiters-depth-2">)</span> -&gt; <span class="org-constant">std</span>::ostream&amp;;

    <span class="org-keyword">friend</span>
    <span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name">&gt;&gt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">istream</span>&amp; <span class="org-variable-name">is</span>, <span class="org-type">Product</span>&amp; <span class="org-variable-name">prod</span><span class="org-rainbow-delimiters-depth-2">)</span> -&gt; <span class="org-constant">std</span>::istream&amp;;  
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
<b>Methods implementation</b> (file: Product.hpp)
</p>

<p>
Constructors: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">Product</span>::Product<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">id</span>, <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">name</span>, <span class="org-type">double</span> <span class="org-variable-name">price</span><span class="org-rainbow-delimiters-depth-1">)</span>:
   m_id<span class="org-rainbow-delimiters-depth-1">(</span>id<span class="org-rainbow-delimiters-depth-1">)</span>, m_name<span class="org-rainbow-delimiters-depth-1">(</span>name<span class="org-rainbow-delimiters-depth-1">)</span>, m_price<span class="org-rainbow-delimiters-depth-1">(</span>price<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-function-name">Product</span>::Product<span class="org-rainbow-delimiters-depth-1">()</span>: Product<span class="org-rainbow-delimiters-depth-1">(</span>-1, <span class="org-string">"unnamed"</span>, 0.0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>   
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Operator insertion (&lt;&lt;) for printing a Product object to an output
stream, it means any derived class of <a href="http://www.cplusplus.com/reference/istream/iostream/">std::ostream</a> or std::cout,
std::stringstream, std::fstream.
</p>

<ul class="org-ul">
<li>Note: This operator is not a method of the class Product, it is
just a function of two arguments.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-type">Product</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">prod</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-constant">std</span>::ostream&amp;
<span class="org-rainbow-delimiters-depth-1">{</span>
     os &lt;&lt; <span class="org-string">" "</span> &lt;&lt; prod.m_id
        &lt;&lt; <span class="org-string">" "</span> &lt;&lt; <span class="org-constant">std</span>::quoted<span class="org-rainbow-delimiters-depth-2">(</span>prod.m_name<span class="org-rainbow-delimiters-depth-2">)</span>
        &lt;&lt; <span class="org-string">" "</span> &lt;&lt; prod.m_price;    
     <span class="org-keyword">return</span> os; 
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Operator extraction (&gt;&gt;) for reading a product object from an input
stream, it means, any derived class of the class <a href="http://www.cplusplus.com/reference/istream/istream/">std::istream</a> such as
std::cin, std::fstream, std::sstream and so on. 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name">&gt;&gt;</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">istream</span>&amp; <span class="org-variable-name">is</span>, <span class="org-type">Product</span>&amp; <span class="org-variable-name">prod</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-constant">std</span>::istream&amp;
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">return</span> is &gt;&gt; prod.m_id &gt;&gt; <span class="org-constant">std</span>::quoted<span class="org-rainbow-delimiters-depth-2">(</span>prod.m_name<span class="org-rainbow-delimiters-depth-2">)</span> &gt;&gt; prod.m_price; 
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<b>Main function:</b>
</p>

<p>
Create sample products:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">Product</span> <span class="org-variable-name">p1</span><span class="org-rainbow-delimiters-depth-1">{</span>200, <span class="org-string">"Arabica Coffee"</span>, 4.50<span class="org-rainbow-delimiters-depth-1">}</span>;    
<span class="org-type">Product</span> <span class="org-variable-name">p2</span><span class="org-rainbow-delimiters-depth-1">{</span>300, <span class="org-string">"Orange 1kg "</span>, 10.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-type">Product</span> <span class="org-variable-name">p3</span><span class="org-rainbow-delimiters-depth-1">{</span>126, <span class="org-string">"XYWZ soft drink"</span>, 15.60<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Experiment 1: print products to stdout.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" &gt;&gt;&gt; EXPERIMENT 1 == Print Products ==========="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"Product p1 = {"</span> &lt;&lt; p1 &lt;&lt; <span class="org-string">" }"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"Product p2 = {"</span> &lt;&lt; p2 &lt;&lt; <span class="org-string">" }"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"Product p3 = {"</span> &lt;&lt; p3 &lt;&lt; <span class="org-string">" }"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh"> &gt;&gt;&gt; EXPERIMENT 1 == Print Products ===========
Product p1 = { 200 <span class="org-string">"Arabica Coffee"</span> 4.5 }
Product p2 = { 300 <span class="org-string">"Orange 1kg "</span> 10 }
Product p3 = { 126 <span class="org-string">"XYWZ soft drink"</span> 15.6 
</pre>
</div>

<p>
Experiment 2: Print Product to memory stream (memory file)
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" &gt;&gt;&gt; EXPERIMENT 2 == Print Products to memory stream (memory file) ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">std</span>::stringstream ss;
ss &lt;&lt; p1 &lt;&lt; <span class="org-string">"\n"</span> &lt;&lt; p2 &lt;&lt; <span class="org-string">"\n"</span> &lt;&lt; p3;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"ss = \n"</span> &lt;&lt; ss.str<span class="org-rainbow-delimiters-depth-1">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text"> &gt;&gt;&gt; EXPERIMENT 2 == Print Products to memory stream (memory file) ====
ss = 
 200 "Arabica Coffee" 4.5
 300 "Orange 1kg " 10
 126 "XYWZ soft drink" 15.6
</pre>
</div>

<p>
Experiment 3: Read product from memory stream.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" &gt;&gt;&gt; EXPERIMENT 3 == Read products from memory stream ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">Product</span> <span class="org-variable-name">pr</span>;
ss &gt;&gt; pr;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">" pr1 = "</span> &lt;&lt; pr &lt;&lt; <span class="org-constant">std</span>::endl;
ss &gt;&gt; pr;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">" pr2 = "</span> &lt;&lt; pr &lt;&lt; <span class="org-constant">std</span>::endl;
ss &gt;&gt; pr;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">" pr3 = "</span> &lt;&lt; pr &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt;&gt; EXPERIMENT 3 == Read products from memory stream ====
pr1 =  200 <span class="org-string">"Arabica Coffee"</span> 4.5
pr2 =  300 <span class="org-string">"Orange 1kg "</span> 10
pr3 =  126 <span class="org-string">"XYWZ soft drink"</span> 15.6
</pre>
</div>

<p>
Experiment 4: Read products from console (user types the products) and
types Ctrl + D sending EOF (End Of File) character when he is done.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" &gt;&gt;&gt; EXPERIMENT 4 == Read products from console ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">Product</span> <span class="org-variable-name">prod</span>;
<span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-negation-char">!</span><span class="org-constant">std</span>::cin.eof<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">){</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Enter product: "</span>;
    <span class="org-constant">std</span>::cin &gt;&gt; prod;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" prod = "</span> &lt;&lt; prod &lt;&lt; <span class="org-string">" ; "</span>
              &lt;&lt; <span class="org-string">" price = "</span> &lt;&lt; prod.Price<span class="org-rainbow-delimiters-depth-2">()</span>
              &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-rainbow-delimiters-depth-1">}</span>       
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">Enter product: 451 Lemon 6.7
 prod =  451 <span class="org-string">"Lemon"</span> 6.7 ;  price = 6.7
Enter product: 234 <span class="org-string">"Fresh atum 1kg"</span> 25.90
 prod =  234 <span class="org-string">"Fresh atum 1kg"</span> 25.9 ;  price = 25.9
Enter product: 461 <span class="org-string">"Cappucino coffee"</span> 25.60        
 prod =  461 <span class="org-string">"Cappucino coffee"</span> 25.6 ;  price = 25.6
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb059b36" class="outline-3">
<h3 id="orgb059b36"><span class="section-number-3">1.7</span> Redirect IO .rdbuf()</h3>
<div class="outline-text-3" id="text-1-7">
<p>
See: <a href="http://www.cplusplus.com/reference/ios/ios/rdbuf/">ios::rdbuf - C++ Reference</a>
</p>

<ul class="org-ul">
<li>Overload 1: Return pointer to stream buffer attached to stream.</li>
<li>Overload 2: Set pointer to stream buffer attached to stream and
clears the error state flags.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">/* </span><span class="org-comment">Overload 1 [get] */</span> 
 <span class="org-type">streambuf</span>* <span class="org-constant">ios</span>::<span class="org-function-name">rdbuf</span><span class="org-rainbow-delimiters-depth-1">()</span> <span class="org-keyword">const</span>;

<span class="org-comment-delimiter">/* </span><span class="org-comment">Overload 2 [set] */</span> 
 <span class="org-type">streambuf</span>* <span class="org-constant">ios</span>::<span class="org-function-name">rdbuf</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">streambuf</span>* <span class="org-variable-name">sb</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Example: <b>Redirect std::cerr to std::stringstream string IO</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-function-name">std</span>::stringstream ss;

&gt;&gt; <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" Stderr output \n"</span>;
 <span class="org-type">Stderr</span> <span class="org-variable-name">output</span> 
&gt;&gt; 
<span class="org-comment-delimiter">// </span><span class="org-comment">Backup pointer to cout stream buffer </span>
&gt;&gt; <span class="org-keyword">auto</span> buf = <span class="org-constant">std</span>::cerr.rdbuf<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">basic_streambuf</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">char</span>, <span class="org-constant">std</span>::<span class="org-type">char_traits</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">char</span><span class="org-rainbow-delimiters-depth-3">&gt;</span> <span class="org-rainbow-delimiters-depth-2">&gt;</span> *<span class="org-rainbow-delimiters-depth-1">)</span> @0x7ffe4c3bc4d8
&gt;&gt; 
<span class="org-comment-delimiter">// </span><span class="org-comment">Redirect stream </span>
<span class="org-function-name">std</span>::cerr.rdbuf<span class="org-rainbow-delimiters-depth-1">(</span>ss.rdbuf<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
The global object std::cerr prints to stringstream instead of process'
stderr (standard error output):
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"hello world "</span>;
&gt;&gt; <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" exp(3.5) "</span> &lt;&lt; <span class="org-constant">std</span>::exp<span class="org-rainbow-delimiters-depth-1">(</span>3.5<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
</pre>
</div>

<p>
Get content of stream ss: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Stream content </span>
&gt;&gt; ss
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">stringstream</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fa0341bb018
&gt;&gt; 
&gt;&gt; ss.str<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-string">"hello world pi = 3.14159 exp(3.5) 33.1155"</span>
&gt;&gt;   
</pre>
</div>

<p>
Restore buffer:  
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cerr.rdbuf<span class="org-rainbow-delimiters-depth-1">(</span>buf<span class="org-rainbow-delimiters-depth-1">)</span>;

&gt;&gt; <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" exp(3.5) "</span> &lt;&lt; <span class="org-constant">std</span>::exp<span class="org-rainbow-delimiters-depth-1">(</span>3.5<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
pi = 3.14159 exp<span class="org-rainbow-delimiters-depth-1">(</span>3.5<span class="org-rainbow-delimiters-depth-1">)</span> 33.1155  

</pre>
</div>
</div>
</div>
<div id="outline-container-org0627dcc" class="outline-3">
<h3 id="org0627dcc"><span class="section-number-3">1.8</span> Read whole input stream to string</h3>
<div class="outline-text-3" id="text-1-8">
<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">fstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

<span class="org-comment-delimiter">/** </span><span class="org-comment">@brief Read whole input stream to a string and returns it </span>
<span class="org-comment">  * Requires headers: &lt;iostream&gt; and &lt;sstream&gt;</span>
<span class="org-comment">  */</span>
<span class="org-function-name">std</span>::string istreamToString<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">istream</span>&amp; <span class="org-variable-name">is</span><span class="org-rainbow-delimiters-depth-1">){</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>is.bad<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-keyword">throw</span> <span class="org-constant">std</span>::runtime_error<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Error: stream has errors."</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::<span class="org-type">stringstream</span> <span class="org-variable-name">ss</span>;
    ss &lt;&lt; is.rdbuf<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> ss.str<span class="org-rainbow-delimiters-depth-2">()</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Read std::cin stream - console (stdin) 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Use types a text and types CTRL + D when he is done sending EOF character </span>
&gt;&gt; <span class="org-keyword">auto</span> text = istreamToString<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::cin<span class="org-rainbow-delimiters-depth-1">)</span>; 
 A stdin input stream works <span class="org-type">like</span> <span class="org-variable-name">a</span> <span class="org-string">"console file"</span>.      
 In UNIX everything has a file interface, <span class="org-variable-name">works</span> with a file API, <span class="org-variable-name">everything</span> is a file.
 Type CTRL + D to send EOF <span class="org-keyword">and</span> close <span class="org-keyword">this</span> stream.

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"text = "</span> &lt;&lt; text2 &lt;&lt; <span class="org-constant">std</span>::endl;
text =  A stdin input stream works like a <span class="org-string">"console file"</span>.
 In UNIX everything has a file interface, works with a <span class="org-type">file</span> <span class="org-variable-name">API</span>, everything is <span class="org-type">a</span> <span class="org-variable-name">file</span>.
 Type CTRL + D to send EOF <span class="org-keyword">and</span> close <span class="org-keyword">this</span> stream.
</pre>
</div>

<p>
Read file input stream: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-keyword">auto</span> ifs = <span class="org-constant">std</span>::ifstream<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"/proc/sys/kernel/osrelease"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">basic_ifstream</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">char</span>, <span class="org-constant">std</span>::<span class="org-type">char_traits</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">char</span><span class="org-rainbow-delimiters-depth-3">&gt;</span> <span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f3edbc0a688

&gt;&gt; <span class="org-keyword">auto</span> os_release = istreamToString<span class="org-rainbow-delimiters-depth-1">(</span>ifs<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">basic_string</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">char</span>, <span class="org-constant">std</span>::<span class="org-type">char_traits</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">char</span><span class="org-rainbow-delimiters-depth-3">&gt;</span>, <span class="org-constant">std</span>::<span class="org-type">allocator</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">char</span><span class="org-rainbow-delimiters-depth-3">&gt;</span> <span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-warning">"</span><span class="org-string">4.20.16-100.fc28.x86_64</span>
<span class="org-string">"</span>

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" =&gt;&gt; Linux-OS Release = "</span> &lt;&lt; os_release &lt;&lt; <span class="org-constant">std</span>::endl;
 =&gt;&gt; Linux-OS Release = 4.20.16-100.fc28.x86_64
</pre>
</div>

<p>
Read stringstream - memory stream. 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::stringstream ms;
&gt;&gt; ms &lt;&lt; <span class="org-string">" UNIX - Linux OS2 Mainframes AIX VxWorks QNX "</span>;
&gt;&gt; ms &lt;&lt; <span class="org-string">"\n network TCP IP UDP SOCKET packets"</span>;
&gt;&gt; ms &lt;&lt; <span class="org-string">" \n binary bits octets speed 3G 4G 5G business flow currency"</span>;
&gt;&gt; ms &lt;&lt; <span class="org-string">" \n technology price technology technology technology"</span>;
&gt;&gt; ms &lt;&lt; <span class="org-constant">std</span>::flush;

<span class="org-comment-delimiter">// </span><span class="org-comment">Type of txt =&gt; std::string </span>
&gt;&gt; <span class="org-keyword">auto</span> txt = istreamToString<span class="org-rainbow-delimiters-depth-1">(</span>ms<span class="org-rainbow-delimiters-depth-1">)</span>;

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"text = \n"</span> &lt;&lt; txt ;
text = 
 UNIX - Linux OS2 Mainframes AIX VxWorks QNX 
 network TCP IP UDP SOCKET packets 
 binary bits octets speed 3G 4G 5G business flow currency 
</pre>
</div>
</div>
</div>

<div id="outline-container-orge35eb32" class="outline-3">
<h3 id="orge35eb32"><span class="section-number-3">1.9</span> Saving and restoring IO flags</h3>
<div class="outline-text-3" id="text-1-9">
</div>
<div id="outline-container-org077a14f" class="outline-4">
<h4 id="org077a14f"><span class="section-number-4">1.9.1</span> Manual saving restoring</h4>
<div class="outline-text-4" id="text-1-9-1">
<p>
IO manipulators such as std::scientific, std::fixed, std::setprecision
or std::uppercase are stateful and permanently affects the IO flags
what can make the code hard to understand and cause unintended IO
changes. This issue can be solved by saving and restoring the IO
flags. 
</p>

<p>
Save IO state: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">========= Save IO flags =========</span>
<span class="org-function-name">std</span>::ios config<span class="org-rainbow-delimiters-depth-1">{</span><span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-1">}</span>;
config.copyfmt<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::cout<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Before changing IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3 &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;
pi = 3.14159 gravity = 9814.57 E = 9.56e+08
&gt;&gt; 

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
 <span class="org-constant">true</span> = 1 <span class="org-constant">false</span> = 0
&gt;&gt; 
</pre>
</div>

<p>
Change IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-1">(</span>3<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::fixed;
</pre>
</div>

<p>
After changing IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3 &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;
pi = 3.142 gravity = 9814.572 E = 956000000.000

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(2) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>2.0<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span> ;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>2<span class="org-rainbow-delimiters-depth-1">)</span> = 1.414
&gt;&gt; 

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
 <span class="org-constant">true</span> = <span class="org-constant">true</span> <span class="org-constant">false</span> = <span class="org-constant">false</span>
&gt;&gt; 
</pre>
</div>

<p>
Restore IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::cout.copyfmt<span class="org-rainbow-delimiters-depth-1">(</span>config<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
After restoring IO flags: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3 &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;
pi = 3.14159 gravity = 9814.57 E = 9.56e+08

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"sqrt(2) = "</span> &lt;&lt; <span class="org-constant">std</span>::sqrt<span class="org-rainbow-delimiters-depth-1">(</span>2.0<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span> ;
sqrt<span class="org-rainbow-delimiters-depth-1">(</span>2<span class="org-rainbow-delimiters-depth-1">)</span> = 1.41421

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
 <span class="org-constant">true</span> = 1 <span class="org-constant">false</span> = 0 
</pre>
</div>
</div>
</div>
<div id="outline-container-org92df5cb" class="outline-4">
<h4 id="org92df5cb"><span class="section-number-4">1.9.2</span> Automatic saving and restoring IO flags with RAAI</h4>
<div class="outline-text-4" id="text-1-9-2">
<p>
Class for saving IO flags using RAAI.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>Class for saving and restoring IO context.</label><pre class="src src-cpp"><span class="org-keyword">struct</span> <span class="org-type">IOContext</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">ios</span>      <span class="org-variable-name">m_config</span><span class="org-rainbow-delimiters-depth-2">{</span><span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">std</span>::<span class="org-type">ostream</span>* <span class="org-variable-name">m_pos</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Save context </span>
    <span class="org-function-name">IOContext</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span> = <span class="org-constant">std</span>::cout<span class="org-rainbow-delimiters-depth-2">)</span>: m_pos<span class="org-rainbow-delimiters-depth-2">(</span>&amp;os<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [INFO] saved IO flags"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        m_config.copyfmt<span class="org-rainbow-delimiters-depth-3">(</span>os<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Restore context </span>
    ~<span class="org-function-name">IOContext</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [INFO] restored IO flags"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        m_pos-&gt;copyfmt<span class="org-rainbow-delimiters-depth-3">(</span>m_config<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Test function: 
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>Function testIOFlags for testing and demonstrating class IOContext.</label><pre class="src src-cpp"><span class="org-type">void</span> <span class="org-function-name">testIOFlags</span><span class="org-rainbow-delimiters-depth-1">()</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"===== Before ======="</span> &lt;&lt; <span class="org-string">"\n"</span>;
     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI
               &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3
               &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"===== Context - IO flags changed ======="</span> &lt;&lt; <span class="org-string">"\n"</span>;
     <span class="org-rainbow-delimiters-depth-2">{</span>  <span class="org-comment-delimiter">/* </span><span class="org-comment">Sub-scope start */</span>
         <span class="org-type">IOContext</span> <span class="org-variable-name">ctx</span><span class="org-rainbow-delimiters-depth-3">{</span><span class="org-constant">std</span>::cout<span class="org-rainbow-delimiters-depth-3">}</span>; <span class="org-comment-delimiter">/* </span><span class="org-comment">Save IO Flags */</span>

         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;
         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-3">(</span>3<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; <span class="org-constant">std</span>::fixed;

         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI
                   &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3
                   &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;

         <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;

        <span class="org-comment-delimiter">/* </span><span class="org-comment">End of sub-scope */</span>
     <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Object ctx destroyed here =&gt; IO flags restored </span>

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"===== After =&gt; IO flags restored ======="</span> &lt;&lt; <span class="org-string">"\n"</span>;

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"pi = "</span> &lt;&lt; M_PI
               &lt;&lt; <span class="org-string">" gravity = "</span> &lt;&lt; 9.8145723e3
               &lt;&lt; <span class="org-string">" E = "</span> &lt;&lt; 956e6 &lt;&lt; <span class="org-string">"\n"</span>;

     <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" true = "</span> &lt;&lt; <span class="org-constant">true</span> &lt;&lt; <span class="org-string">" false = "</span> &lt;&lt; <span class="org-constant">false</span> &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-comment-delimiter">/** </span><span class="org-comment">--- End of function testIOFlags --- */</span>
</pre>
</div>

<p>
Test in REPL: 
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>CERN's ROOT repl session.</label><pre class="src src-cpp">&gt;&gt; testIOFlags<span class="org-rainbow-delimiters-depth-1">()</span>

===== Before =======
pi = 3.14159 gravity = 9814.57 E = 9.56e+08
 <span class="org-constant">true</span> = 1 <span class="org-constant">false</span> = 0
===== Context - IO flags changed =======
 <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-constant">INFO</span><span class="org-rainbow-delimiters-depth-1">]</span> saved IO flags
pi = 3.142 gravity = 9814.572 E = 956000000.000
 <span class="org-constant">true</span> = <span class="org-constant">true</span> <span class="org-constant">false</span> = <span class="org-constant">false</span>
 <span class="org-rainbow-delimiters-depth-1">[</span>INFO<span class="org-rainbow-delimiters-depth-1">]</span> restored IO flags
===== After =&gt; IO flags restored =======
pi = 3.14159 gravity = 9814.57 E = 9.56e+08
 <span class="org-constant">true</span> = 1 <span class="org-constant">false</span> = 0
&gt;&gt; 
&gt;&gt; 
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2019-07-24 Wed 02:19</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
