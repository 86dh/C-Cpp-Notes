<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-10-30 Tue 15:51 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CPP / C++ Notes - Integration with C-APIs</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="cpp/c++ code examples and demonstrations."
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<link href="theme/org-nav-theme.css" rel="stylesheet">
<script src="theme/org-nav-theme.js"></script>
<link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">CPP / C++ Notes - Integration with C-APIs</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge393264">1. Interfacing C APIs and libraries</a>
<ul>
<li><a href="#orgd4acc8a">1.1. Definitions</a></li>
<li><a href="#orgc9763cc">1.2. Example: Nix / getcwd and chdir</a></li>
<li><a href="#orga3d8cf2">1.3. Example: Nix / gethostname (std::string)</a></li>
<li><a href="#org7621fed">1.4. Example: Passing std::vector to a C-array APIs</a></li>
<li><a href="#org7848343">1.5. Example: GSL / C++ Class Wrapper to an C-API in OOP style or with opaque pointers.</a></li>
</ul>
</li>
</ul>
</div>
</div>
<ul class="org-ul">
<li><a href='index.html'>Index</a></li>
</ul>

<div id="outline-container-orge393264" class="outline-2">
<h2 id="orge393264"><span class="section-number-2">1</span> Interfacing C APIs and libraries</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgd4acc8a" class="outline-3">
<h3 id="orgd4acc8a"><span class="section-number-3">1.1</span> Definitions</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><b>Nix</b> like: Any operating system based or inspiered on UNIX
(Tradermark of Opengroup) such as Linux, Android, BSD, MacOX and so
on. No operating system can call itself UNIX without the Opengroup
certification.
<ul class="org-ul">
<li>See:
<ul class="org-ul">
<li><a href="http://www.unix.org/trademark.html">UNIX Trademark</a></li>
<li><a href="https://en.wikipedia.org/wiki/Unix">Unix - Wikipedia</a></li>
</ul></li>
</ul></li>

<li><b>GSL</b> - GNU Scientifc Library</li>
</ul>
</div>
</div>

<div id="outline-container-orgc9763cc" class="outline-3">
<h3 id="orgc9763cc"><span class="section-number-3">1.2</span> Example: Nix / getcwd and chdir</h3>
<div class="outline-text-3" id="text-1-2">
<p>
<b>getcwd</b> 
</p>

<ul class="org-ul">
<li>Brief: Get the current working directory.</li>

<li>Description: "These functions return a null-terminated string
containing an absolute pathname that is the current working
directory of the calling process.  The pathname is returned as the
function result and via the argument buf, if present."
<ul class="org-ul">
<li><a href="http://man7.org/linux/man-pages/man3/getcwd.3.html">(gecwd - Linux Manual)</a></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-type">char</span> *<span class="org-function-name">getcwd</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">char</span> *<span class="org-variable-name">buf</span>, <span class="org-type">size_t</span> <span class="org-variable-name">size</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
<b>chdir</b> 
</p>

<ul class="org-ul">
<li>Brief: Change the current working directory.</li>
<li>Description: On success returns zero and on failure returns -1 and
set the flag <b>errno</b>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-type">int</span> <span class="org-function-name">chdir</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-type">char</span> *<span class="org-variable-name">path</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Using those APIs in C: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

&gt;&gt; getcwd<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">NULL</span>, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">char</span> *<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"/home/archbox"</span>
&gt;&gt;

&gt;&gt; getcwd<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">nullptr</span>, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">char</span> *<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"/home/archbox"</span>
&gt;&gt; 

&gt;&gt; chdir<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"/var/log"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">)</span> 0
&gt;&gt; getcwd<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">NULL</span>, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">char</span> *<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"/var/log"</span>
&gt;&gt; 
</pre>
</div>

<p>
Using those functions with C++ string std::string. 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

&gt;&gt; <span class="org-constant">std</span>::string dirpath = <span class="org-string">"/etc/"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Problem: Pass a std::string where const char* is expected </span>
&gt;&gt; chdir<span class="org-rainbow-delimiters-depth-1">(</span>dirpath<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-function-name">ROOT_prompt_67</span>:1:1: error: no matching function <span class="org-keyword">for</span> call to <span class="org-warning">'</span>chdir<span class="org-warning">'</span>
chdir<span class="org-rainbow-delimiters-depth-1">(</span>dirpath<span class="org-rainbow-delimiters-depth-1">)</span>
^~~~~
<span class="org-function-name">/usr/include/unistd.h</span>:497:12: note: candidate function <span class="org-keyword">not</span> viable: no known conversion from <span class="org-warning">'</span><span class="org-constant">std</span>::string<span class="org-warning">'</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Solution: </span>
&gt;&gt; chdir<span class="org-rainbow-delimiters-depth-1">(</span>dirpath.c_str<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">)</span> 0
&gt;&gt;

&gt;&gt; dirpath.c_str<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-type">char</span> *<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"/etc/"</span>
&gt;&gt; 

&gt;&gt; getcwd<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">nullptr</span>, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">char</span> *<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"/etc"</span>

&gt;&gt; <span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">(</span>getcwd<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">nullptr</span>, 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"/etc"</span>
&gt;&gt; 
</pre>
</div>

<p>
C++ Wrapper: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">auto</span> <span class="org-function-name">getCWD</span><span class="org-rainbow-delimiters-depth-1">()</span> -&gt; <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-keyword">return</span> <span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-2">(</span>getcwd<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">nullptr</span>, 0<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-keyword">auto</span> <span class="org-function-name">setCWD</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">string</span>&amp; <span class="org-variable-name">path</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-type">int</span> <span class="org-variable-name">status</span> = ::chdir<span class="org-rainbow-delimiters-depth-2">(</span>path.c_str<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>status &lt; 0<span class="org-rainbow-delimiters-depth-2">)</span>
         <span class="org-keyword">throw</span> <span class="org-constant">std</span>::runtime_error<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Failed to change directory."</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

&gt;&gt; setCWD<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"/tmp"</span><span class="org-rainbow-delimiters-depth-1">)</span>
&gt;&gt; getCWD<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"/tmp"</span>
&gt;&gt; 

&gt;&gt; setCWD<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"/tmp/dummy"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-type">Error</span> <span class="org-type">in</span> <span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-constant">TRint</span>::HandleTermInput<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>: <span class="org-constant">std</span>::runtime_error caught: Failed to change directory.
&gt;&gt; 
</pre>
</div>


<p>
References: 
</p>
<ul class="org-ul">
<li><a href="http://man7.org/linux/man-pages/man3/getcwd.3.html">getcwd(3) - Linux manual page</a></li>
<li><a href="https://linux.die.net/man/2/chdir">chdir(2): change working directory - Linux man page</a></li>
</ul>
</div>
</div>

<div id="outline-container-orga3d8cf2" class="outline-3">
<h3 id="orga3d8cf2"><span class="section-number-3">1.3</span> Example: Nix / gethostname (std::string)</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Get the computer hostname. This function needs two arguments, an array
of chars, which is used for returning the hostname, and the size of
the array. If the array size is not enough for returning the hostname,
the function returns -1, otherwise it returns 0. The size of
hostname "string" is limited to <code>HOST_NAME_MAX</code>.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-type">int</span> <span class="org-function-name">gethostname</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">char</span> *<span class="org-variable-name">name</span>, <span class="org-type">size_t</span> <span class="org-variable-name">len</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Example: Using this function in <b>C</b> (Root REPL). 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-type">char</span> <span class="org-variable-name">hname</span><span class="org-rainbow-delimiters-depth-1">[</span>HOST_NAME_MAX<span class="org-rainbow-delimiters-depth-1">]</span>;

&gt;&gt; HOST_NAME_MAX
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">)</span> 64
&gt;&gt; 

&gt;&gt; hname
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">char</span> <span class="org-rainbow-delimiters-depth-2">[</span>64<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"\0\0\0\0\0\0\0\0\0\0\0\0\0\...."</span>

&gt;&gt; gethostname<span class="org-rainbow-delimiters-depth-1">(</span>hname, HOST_NAME_MAX<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">)</span> 0
&gt;&gt; 

&gt;&gt; hname
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">char</span> <span class="org-rainbow-delimiters-depth-2">[</span>64<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"localhost.localdomain\0\0\0\..."</span>

</pre>
</div>

<p>
Example: Using gethostname with std::string 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Create a string with filled with '\0' null character of size HOST_NAME_MAX</span>
&gt;&gt; <span class="org-constant">std</span>::string shname<span class="org-rainbow-delimiters-depth-1">(</span>HOST_NAME_MAX, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"\0\0\0\0\0\0\0\0\0\0\0...."</span>
&gt;&gt; 

&gt;&gt; shname.size<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">unsigned</span> <span class="org-type">long</span><span class="org-rainbow-delimiters-depth-1">)</span> 64


&gt;&gt; gethostname<span class="org-rainbow-delimiters-depth-1">(</span>&amp;shname<span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span>, shname.size<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">)</span> 0

&gt;&gt; shname
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"localhost.localdomain\0\0\0\0\0\0\0\0\..."</span>
&gt;&gt; 

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Hostname = "</span> &lt;&lt; shname &lt;&lt; <span class="org-string">"\n"</span>;
Hostname = localhost.localdomain
&gt;&gt; 

<span class="org-comment-delimiter">// </span><span class="org-comment">Remove trailing \0 characters </span>
&gt;&gt; <span class="org-constant">std</span>::string x;
&gt;&gt; <span class="org-constant">std</span>::getline<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::stringstream<span class="org-rainbow-delimiters-depth-2">(</span>shname<span class="org-rainbow-delimiters-depth-2">)</span>, x, <span class="org-string">'\0'</span><span class="org-rainbow-delimiters-depth-1">)</span>
&gt;&gt; x
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"localhost.localdomain"</span>
&gt;&gt; 
</pre>
</div>

<p>
Putting it all together in a C++ wrapper: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor"> #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor"> #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor"> #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor"> #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

 <span class="org-comment-delimiter">// </span><span class="org-comment">C++ Wrapper or C++ interface </span>
 <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-function-name">getHostname</span><span class="org-rainbow-delimiters-depth-1">(){</span>
     <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">shname</span><span class="org-rainbow-delimiters-depth-2">(</span>HOST_NAME_MAX, 0<span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-type">int</span> <span class="org-variable-name">status</span> = gethostname<span class="org-rainbow-delimiters-depth-2">(</span>&amp;shname<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, shname.size<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>status &lt; 0<span class="org-rainbow-delimiters-depth-2">)</span>
             <span class="org-keyword">throw</span> <span class="org-constant">std</span>::runtime_error<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Error: failed to retrieve hostname."</span><span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">out</span>;
     <span class="org-constant">std</span>::getline<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::stringstream<span class="org-rainbow-delimiters-depth-3">(</span>shname<span class="org-rainbow-delimiters-depth-3">)</span>, out, <span class="org-string">'\0'</span><span class="org-rainbow-delimiters-depth-2">)</span>;    
     <span class="org-keyword">return</span> out;
<span class="org-rainbow-delimiters-depth-1">}</span>

&gt;&gt; getHostname<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"localhost.localdomain"</span>
&gt;&gt; 
</pre>
</div>

<p>
<b>References:</b>
</p>

<ul class="org-ul">
<li>FreeBSD - <a href="https://www.freebsd.org/cgi/man.cgi?query=gethostname">gethostname</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/gethostname.3.html">Mac OS X Manual Page For gethostname(3)</a></li>
<li><a href="https://www.ibm.com/support/knowledgecenter/en/SSB23S_1.1.0.15/gtpc2/cpp_gethostname.html">IBM Knowledge Center - gethostname: Return host name</a></li>
<li><a href="https://www.gnu.org/software/libc/manual/html_node/Host-Identification.html">Host
Identification (The GNU C Library)</a></li>
</ul>
</div>
</div>
<div id="outline-container-org7621fed" class="outline-3">
<h3 id="org7621fed"><span class="section-number-3">1.4</span> Example: Passing std::vector to a C-array APIs</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Many C APIs, such as BLAS and LPACK for linear algebra, provide
functions like shown in the following code expecting a C array
(pointer to the first address array[0]) and its size. Some functions
arguments are used input and other as return value or both. The
objective is to build a C++ wrapper using STL-vector for interfacing
those APIs. 
</p>

<ul class="org-ul">
<li>C-APIs with C-arrays.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">double</span> <span class="org-function-name">average</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">size_t</span> <span class="org-variable-name">size</span>, <span class="org-type">double</span>* <span class="org-keyword">const</span> <span class="org-variable-name">xs</span> <span class="org-rainbow-delimiters-depth-1">){</span>
     <span class="org-type">double</span> <span class="org-variable-name">sum</span> = 0.0;
     <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0; i &lt; size; i++<span class="org-rainbow-delimiters-depth-2">)</span>
             sum += xs<span class="org-rainbow-delimiters-depth-2">[</span>i<span class="org-rainbow-delimiters-depth-2">]</span>;
     <span class="org-keyword">return</span> sum / size;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">xs[i] &lt;- x[i] + a * ys[i]</span>
<span class="org-type">void</span> <span class="org-function-name">arraySum</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">size_t</span> <span class="org-variable-name">size</span>, <span class="org-type">double</span> <span class="org-variable-name">a</span>, <span class="org-type">double</span> *<span class="org-variable-name">xs</span>,  <span class="org-type">double</span>* <span class="org-keyword">const</span> <span class="org-variable-name">ys</span><span class="org-rainbow-delimiters-depth-1">){</span>
     <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0; i &lt; size; i++<span class="org-rainbow-delimiters-depth-2">)</span>
         xs<span class="org-rainbow-delimiters-depth-2">[</span>i<span class="org-rainbow-delimiters-depth-2">]</span> = xs<span class="org-rainbow-delimiters-depth-2">[</span>i<span class="org-rainbow-delimiters-depth-2">]</span> + a * ys<span class="org-rainbow-delimiters-depth-2">[</span>i<span class="org-rainbow-delimiters-depth-2">]</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Testing: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; <span class="org-type">double</span> arr <span class="org-rainbow-delimiters-depth-1">[]</span> = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 2.0, 3.0, 4.0, 5.0<span class="org-rainbow-delimiters-depth-1">}</span>;
&gt;&gt; 
&gt;&gt; average<span class="org-rainbow-delimiters-depth-1">(</span>5, arr<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 3.0000000
&gt;&gt; 

&gt;&gt; <span class="org-type">double</span> xs <span class="org-rainbow-delimiters-depth-1">[]</span> = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 3.0, 4.0, 5.0<span class="org-rainbow-delimiters-depth-1">}</span>;
&gt;&gt; <span class="org-type">double</span> ys <span class="org-rainbow-delimiters-depth-1">[]</span> = <span class="org-rainbow-delimiters-depth-1">{</span>3.0, 5.0, 6.0, 3.4<span class="org-rainbow-delimiters-depth-1">}</span>;
&gt;&gt; 
<span class="org-comment-delimiter">// </span><span class="org-comment">=====&gt; Before &lt;&lt;&lt;=========</span>
&gt;&gt; xs
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 1.0000000, 3.0000000, 4.0000000, 5.0000000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; ys
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 3.0000000, 5.0000000, 6.0000000, 3.4000000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; 

<span class="org-comment-delimiter">//</span><span class="org-comment">======&gt; After &lt;&lt;=========</span>
&gt;&gt; arraySum<span class="org-rainbow-delimiters-depth-1">(</span>4, 2.0, xs, ys<span class="org-rainbow-delimiters-depth-1">)</span>
&gt;&gt; xs
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 7.0000000, 13.000000, 16.000000, 11.800000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; ys
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 3.0000000, 5.0000000, 6.0000000, 3.4000000 <span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
C++ stl vectors with C-array APIs 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> xsv = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 3.0, 4.0, 5.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> ysv = <span class="org-rainbow-delimiters-depth-1">{</span>3.0, 5.0, 6.0, 3.4<span class="org-rainbow-delimiters-depth-1">}</span>;
&gt;&gt; 

&gt;&gt; average<span class="org-rainbow-delimiters-depth-1">(</span>xsv.size<span class="org-rainbow-delimiters-depth-2">()</span>, xsv.data<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 3.2500000
&gt;&gt; 

&gt;&gt; arraySum<span class="org-rainbow-delimiters-depth-1">(</span>xsv.size<span class="org-rainbow-delimiters-depth-2">()</span>, 2.0, xsv.data<span class="org-rainbow-delimiters-depth-2">()</span>, ysv.data<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>
&gt;&gt; 
&gt;&gt; xsv
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 7.0000000, 13.000000, 16.000000, 11.800000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; ysv
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 3.0000000, 5.0000000, 6.0000000, 3.4000000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; 
</pre>
</div>

<p>
C++ Wrapper: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">namespace</span> <span class="org-constant">CPPWrapper</span><span class="org-rainbow-delimiters-depth-1">{</span>
   <span class="org-keyword">auto</span> <span class="org-function-name">average</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">&gt;</span>&amp; <span class="org-variable-name">xs</span><span class="org-rainbow-delimiters-depth-2">)</span> -&gt; <span class="org-type">double</span> <span class="org-rainbow-delimiters-depth-2">{</span>
       <span class="org-keyword">return</span> ::average<span class="org-rainbow-delimiters-depth-3">(</span>xs.size<span class="org-rainbow-delimiters-depth-4">()</span>, <span class="org-keyword">const_cast</span><span class="org-rainbow-delimiters-depth-4">&lt;</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-5">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-5">&gt;</span>&amp;<span class="org-rainbow-delimiters-depth-4">&gt;(</span>xs<span class="org-rainbow-delimiters-depth-4">)</span>.data<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
   <span class="org-rainbow-delimiters-depth-2">}</span>
   <span class="org-keyword">auto</span> <span class="org-function-name">linearComb</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">a</span>,
                   <span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">&gt;</span>&amp; <span class="org-variable-name">xs</span>,
                   <span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">&gt;</span>&amp; <span class="org-variable-name">ys</span><span class="org-rainbow-delimiters-depth-2">)</span> -&gt; <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-rainbow-delimiters-depth-2">{</span>
      <span class="org-keyword">auto</span> <span class="org-variable-name">xscopy</span> = xs;
      <span class="org-keyword">auto</span>&amp; <span class="org-variable-name">ysref</span>  = <span class="org-keyword">const_cast</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-4">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-4">&gt;</span>&amp;<span class="org-rainbow-delimiters-depth-3">&gt;(</span>ys<span class="org-rainbow-delimiters-depth-3">)</span>; 
      ::arraySum<span class="org-rainbow-delimiters-depth-3">(</span>xs.size<span class="org-rainbow-delimiters-depth-4">()</span>, a, xscopy.data<span class="org-rainbow-delimiters-depth-4">()</span>, ysref.data<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
      <span class="org-keyword">return</span> xscopy;
   <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Testing wrapper: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> xsv = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 3.0, 4.0, 5.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> ysv = <span class="org-rainbow-delimiters-depth-1">{</span>3.0, 5.0, 6.0, 3.4<span class="org-rainbow-delimiters-depth-1">}</span>;

&gt;&gt; <span class="org-constant">CPPWrapper</span>::average<span class="org-rainbow-delimiters-depth-1">(</span>xsv<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 3.2500000
&gt;&gt; 

&gt;&gt; <span class="org-constant">CPPWrapper</span>::linearComb<span class="org-rainbow-delimiters-depth-1">(</span>2.0, xsv, ysv<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 7.0000000, 13.000000, 16.000000, 11.800000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; 

&gt;&gt; <span class="org-constant">CPPWrapper</span>::linearComb<span class="org-rainbow-delimiters-depth-1">(</span>3.0, xsv, ysv<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 10.000000, 18.000000, 22.000000, 15.200000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; 

<span class="org-comment-delimiter">// </span><span class="org-comment">Check whether vectors xsv and ysv were modified. </span>
&gt;&gt; xsv
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 1.0000000, 3.0000000, 4.0000000, 5.0000000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; ysv
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span> 3.0000000, 5.0000000, 6.0000000, 3.4000000 <span class="org-rainbow-delimiters-depth-1">}</span>
&gt;&gt; 
</pre>
</div>
</div>
</div>

<div id="outline-container-org7848343" class="outline-3">
<h3 id="org7848343"><span class="section-number-3">1.5</span> Example: GSL / C++ Class Wrapper to an C-API in OOP style or with opaque pointers.</h3>
<div class="outline-text-3" id="text-1-5">
<p>
This example shows how to build a C++ wrapper for C-APIs written in
object-oriented C style. It means, C-APIs which emulates OOP concepts
by using functions which encode class methods and a pointer pointer
for emulating an object. In this style, the pointer to the data
representation is passed around the functions emulating class methods.
</p>

<p>
This style can also use opaque pointers for full encapsulation and
data hiding. Opaque pointers to incomplete types where the data
representation struct is not exposed to the client code. Many old
C-libraries uses this style, including Windows Win32 API. 
</p>

<p>
In example case, it will be used the <a href="https://www.gnu.org/software/gsl/manual/html_node/Vectors.html#Vectors">vector "class"</a> from GNU
Scientific library, but this approach can be used in other similar
scenarios. 
</p>

<p>
See more at:
</p>
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Opaque_pointer">Opaque pointer - Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Handle_(computing)">Handle (computing) - Wikipedia</a></li>
<li><a href="https://www.codementor.io/michaelsafyan/object-oriented-programming-in-c-du1081gw2">Object-Oriented Programming (OOP) in C | Codementor</a></li>
<li><a href="https://dmitryfrank.com/articles/oop_in_c">Object-oriented techniques in C - Dmitry Frank</a></li>
<li><a href="https://nullprogram.com/blog/2014/10/21/">C Object Oriented Programming « null program</a></li>
</ul>

<p>
<b>GSL C-Vector API</b>
</p>

<p>
Basic Functions: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Constructor: new gsl_vector(10)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Allocate vector -&gt; Similar to a constructor </span>
<span class="org-type">gsl_vector</span>* <span class="org-function-name">gsl_vector_alloc</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">size_t</span> <span class="org-variable-name">n</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Destructor: ~gsl_vector(){}</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Deallocate vector -&gt; Similar to a destructor </span>
<span class="org-type">void</span>        <span class="org-function-name">gsl_vector_free</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span>* <span class="org-variable-name">v</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Accessor method =&gt; double x = vector.get(index)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Get vector element </span>
<span class="org-type">double</span>      <span class="org-function-name">gsl_vector_get</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-type">gsl_vector</span> * <span class="org-variable-name">v</span>, <span class="org-keyword">const</span> <span class="org-type">size_t</span> <span class="org-variable-name">i</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Mutator mehtod =&gt; vector.set(10, 2.34);</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Set vector element</span>
<span class="org-type">void</span>        <span class="org-function-name">gsl_vector_set</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span>* <span class="org-variable-name">v</span>, <span class="org-keyword">const</span> <span class="org-type">size_t</span> <span class="org-variable-name">i</span>, <span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Mutator method =&gt; vector.setall(1.25)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">This function sets all the elements of the vector v to the value x.</span>
<span class="org-type">void</span>        <span class="org-function-name">gsl_vector_set_all</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span>* <span class="org-variable-name">v</span>, <span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">This function sets all the elements of the vector v to zero.</span>
<span class="org-type">void</span>        <span class="org-function-name">gsl_vector_set_zero</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span>* <span class="org-variable-name">v</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Vector Operations: 
</p>

<ul class="org-ul">
<li><a href="https://www.gnu.org/software/gsl/manual/html_node/Vector-operations.html#Vector-operations">GNU Scientific Library – Reference Manual: Vector operations</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">a &lt;- a + b </span>
<span class="org-type">int</span> <span class="org-function-name">gsl_vector_add</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span> * <span class="org-variable-name">a</span>, <span class="org-keyword">const</span> <span class="org-type">gsl_vector</span> * <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">a &lt;- a - b</span>
<span class="org-type">int</span> <span class="org-function-name">gsl_vector_sub</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span> * <span class="org-variable-name">a</span>, <span class="org-keyword">const</span> <span class="org-type">gsl_vector</span> * <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">a &lt;- a * b</span>
<span class="org-type">int</span> <span class="org-function-name">gsl_vector_mul</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span> * <span class="org-variable-name">a</span>, <span class="org-keyword">const</span> <span class="org-type">gsl_vector</span> * <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">a[i] &lt;- a[i] * SCALE</span>
<span class="org-type">int</span> <span class="org-function-name">gsl_vector_scale</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span> * <span class="org-variable-name">a</span>, <span class="org-keyword">const</span> <span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">a[i] &lt;- a[i] + CONSTANT </span>
<span class="org-type">int</span> <span class="org-function-name">gsl_vector_add_constant</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">gsl_vector</span> * <span class="org-variable-name">a</span>, <span class="org-keyword">const</span> <span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
<b>C++ Wrapper</b> 
</p>

<ul class="org-ul">
<li>Class GSLVector - encapsulates the GNU Scientific library vector
"object" which is written in <b>object-oriented C style</b>. In this
style, methods are encoded as C-functions and the object is encoded
as pointer which is passed as function argument. Despite the style
this GLS API is written, it still not convenient for using in
C++. This example shows how to encapsulate an API like this in a
C++ class.</li>
</ul>

<p>
Complete file: <a href="src/gsl-vector-wrapper.cpp">file:src/gsl-vector-wrapper.cpp</a>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">class</span> <span class="org-type">GSLVector</span><span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-function-name">private</span>:
    <span class="org-type">gsl_vector</span>* <span class="org-variable-name">m_hnd</span>;
    <span class="org-type">int</span> <span class="org-variable-name">m_size</span>;
<span class="org-function-name">public</span>:
    <span class="org-function-name">GSLVector</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">m_size</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;m_size = m_size;
        <span class="org-keyword">this</span>-&gt;m_hnd = gsl_vector_alloc<span class="org-rainbow-delimiters-depth-3">(</span>m_size<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Overloaded constructor</span>
    <span class="org-function-name">GSLVector</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">m_size</span>, <span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>        
        <span class="org-keyword">this</span>-&gt;m_size = m_size;
        <span class="org-keyword">this</span>-&gt;m_hnd = gsl_vector_alloc<span class="org-rainbow-delimiters-depth-3">(</span>m_size<span class="org-rainbow-delimiters-depth-3">)</span>;
        gsl_vector_set_all<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd, x<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Copy constructor </span>
    <span class="org-function-name">GSLVector</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-type">GSLVector</span>&amp; <span class="org-variable-name">src</span><span class="org-rainbow-delimiters-depth-2">){</span>
        m_size = src.m_size;
        m_hnd = gsl_vector_alloc<span class="org-rainbow-delimiters-depth-3">(</span>src.m_size<span class="org-rainbow-delimiters-depth-3">)</span>;
        gsl_vector_memcpy<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd, src.m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Copy assignment operator</span>
    <span class="org-type">GSLVector</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">=</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-type">GSLVector</span>&amp; <span class="org-variable-name">src</span><span class="org-rainbow-delimiters-depth-2">){</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [TRACE] Copy assignment operator."</span> &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>m_size != src.m_size<span class="org-rainbow-delimiters-depth-3">){</span>
           gsl_vector_free<span class="org-rainbow-delimiters-depth-4">(</span>m_hnd<span class="org-rainbow-delimiters-depth-4">)</span>;
           m_hnd = gsl_vector_alloc<span class="org-rainbow-delimiters-depth-4">(</span>src.m_size<span class="org-rainbow-delimiters-depth-4">)</span>;
         <span class="org-rainbow-delimiters-depth-3">}</span>        
        gsl_vector_memcpy<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd, src.m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>   
    <span class="org-comment-delimiter">// </span><span class="org-comment">Destructor </span>
    ~<span class="org-function-name">GSLVector</span><span class="org-rainbow-delimiters-depth-2">(){</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>m_hnd != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>
           gsl_vector_free<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">size_t</span> <span class="org-function-name">size</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> m_size; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">gsl_vector</span>* <span class="org-function-name">data</span><span class="org-rainbow-delimiters-depth-2">(){</span>
        <span class="org-keyword">return</span> <span class="org-keyword">this</span>-&gt;m_hnd;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">struct</span> <span class="org-type">ElementProxy</span><span class="org-rainbow-delimiters-depth-2">{</span>
         <span class="org-type">GSLVector</span>* <span class="org-variable-name">ptr</span>;
         <span class="org-type">size_t</span>     <span class="org-variable-name">index</span>;
         <span class="org-function-name">ElementProxy</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">GSLVector</span>* <span class="org-variable-name">ptr</span>, <span class="org-type">size_t</span> <span class="org-variable-name">index</span><span class="org-rainbow-delimiters-depth-3">)</span>: ptr<span class="org-rainbow-delimiters-depth-3">(</span>ptr<span class="org-rainbow-delimiters-depth-3">)</span>, index<span class="org-rainbow-delimiters-depth-3">(</span>index<span class="org-rainbow-delimiters-depth-3">){}</span>
         <span class="org-type">ElementProxy</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">=</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-3">){</span>
             gsl_vector_set<span class="org-rainbow-delimiters-depth-4">(</span>ptr-&gt;data<span class="org-rainbow-delimiters-depth-5">()</span>, index, x<span class="org-rainbow-delimiters-depth-4">)</span>;
             <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
         <span class="org-rainbow-delimiters-depth-3">}</span>
         <span class="org-type">double</span> <span class="org-function-name">get</span><span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-3">{</span>
              <span class="org-keyword">return</span> gsl_vector_get<span class="org-rainbow-delimiters-depth-4">(</span>ptr-&gt;data<span class="org-rainbow-delimiters-depth-5">()</span>, index<span class="org-rainbow-delimiters-depth-4">)</span>;
         <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">ElementProxy</span> <span class="org-keyword">operator</span><span class="org-function-name"><span class="org-rainbow-delimiters-depth-2">[]</span></span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">index</span><span class="org-rainbow-delimiters-depth-2">){</span>
       <span class="org-keyword">return</span> ElementProxy<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">this</span>, index<span class="org-rainbow-delimiters-depth-3">)</span>;
       <span class="org-comment-delimiter">// </span><span class="org-comment">return gsl_vector_get(m_hnd, index);</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">double operator[](int index){</span>
    <span class="org-comment-delimiter">//     </span><span class="org-comment">return gsl_vector_get(m_hnd, index);</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">}    </span>
    <span class="org-type">void</span> <span class="org-function-name">set</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">index</span>, <span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-2">){</span>
        gsl_vector_set<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd, index, x<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">double</span> <span class="org-function-name">max</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">return</span> gsl_vector_max<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;        
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">double</span> <span class="org-function-name">min</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">return</span> gsl_vector_min<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">GSLVector</span> <span class="org-keyword">operator</span> <span class="org-function-name">+</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-type">GSLVector</span>&amp; <span class="org-variable-name">va</span><span class="org-rainbow-delimiters-depth-2">){</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Invoke copy constructor </span>
        <span class="org-type">GSLVector</span> <span class="org-variable-name">vec2</span> = *<span class="org-keyword">this</span>;
        gsl_vector_add<span class="org-rainbow-delimiters-depth-3">(</span>vec2.m_hnd, va.m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> vec2;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">GSLVector</span> <span class="org-keyword">operator</span> <span class="org-function-name">*</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">scale</span><span class="org-rainbow-delimiters-depth-2">){</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Invoke copy constructor </span>
        <span class="org-type">GSLVector</span> <span class="org-variable-name">vec2</span> = *<span class="org-keyword">this</span>;
        gsl_vector_scale<span class="org-rainbow-delimiters-depth-3">(</span>vec2.m_hnd, scale<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> vec2;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">friend</span> <span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">&lt;&lt;</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-keyword">const</span> <span class="org-type">GSLVector</span>&amp; <span class="org-variable-name">vec</span><span class="org-rainbow-delimiters-depth-2">){</span>
        os &lt;&lt; <span class="org-string">"["</span> &lt;&lt; vec.m_size &lt;&lt; <span class="org-string">"]("</span>;
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; vec.m_size; i++<span class="org-rainbow-delimiters-depth-3">){</span>
            os &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-4">(</span>4<span class="org-rainbow-delimiters-depth-4">)</span> &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-string">" "</span> &lt;&lt; gsl_vector_get<span class="org-rainbow-delimiters-depth-4">(</span>vec.m_hnd, i<span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
        os &lt;&lt; <span class="org-string">") "</span>;
        <span class="org-keyword">return</span> os;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Loading in CERN's ROOT REPL:
</p>

<div class="org-src-container">
<pre class="src src-cpp">&gt;&gt; .L gsl-vector-wrapper.cpp 
&gt;&gt; GSLVector v<span class="org-rainbow-delimiters-depth-1">(</span>5<span class="org-rainbow-delimiters-depth-1">)</span>;
&gt;&gt; 
&gt;&gt; v.size<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">unsigned</span> <span class="org-type">long</span><span class="org-rainbow-delimiters-depth-1">)</span> 5
&gt;&gt; 
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"v = "</span> &lt;&lt; v &lt;&lt; <span class="org-string">"\n"</span>;
v = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> 0.0000 0.0000 0.0000 0.0000 0.0000<span class="org-rainbow-delimiters-depth-1">)</span> 
&gt;&gt; 

&gt;&gt; v.set<span class="org-rainbow-delimiters-depth-1">(</span>0, 3.0<span class="org-rainbow-delimiters-depth-1">)</span>; v.set<span class="org-rainbow-delimiters-depth-1">(</span>1, 4.5<span class="org-rainbow-delimiters-depth-1">)</span>; v.set<span class="org-rainbow-delimiters-depth-1">(</span>2, 3.25<span class="org-rainbow-delimiters-depth-1">)</span>;
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"v = "</span> &lt;&lt; v &lt;&lt; <span class="org-string">"\n"</span>;
v = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> 3.0000 4.5000 3.2500 0.0000 0.0000<span class="org-rainbow-delimiters-depth-1">)</span> 
&gt;&gt; 

&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"v * 2.0 = "</span> &lt;&lt; v * 2.0 &lt;&lt; <span class="org-string">"\n"</span>;
v * 2.0 = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> 6.0000 9.0000 6.5000 0.0000 0.0000<span class="org-rainbow-delimiters-depth-1">)</span> 
&gt;&gt; 

&gt;&gt; <span class="org-keyword">auto</span> a =  v * 2.0;
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"a = "</span> &lt;&lt; a &lt;&lt; <span class="org-string">"\n"</span>;
a = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> 6.0000 9.0000 6.5000 0.0000 0.0000<span class="org-rainbow-delimiters-depth-1">)</span> 
&gt;&gt; 
&gt;&gt; <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"v = "</span> &lt;&lt; v &lt;&lt; <span class="org-string">"\n"</span>;
v = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> 3.0000 4.5000 3.2500 0.0000 0.0000<span class="org-rainbow-delimiters-depth-1">)</span> 
&gt;&gt; 

&gt;&gt; v.max<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 4.5000000
&gt;&gt; v.min<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 2.3715151e-322
&gt;&gt;   
</pre>
</div>

<p>
Main function: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">GSLVector</span> <span class="org-variable-name">vec1</span><span class="org-rainbow-delimiters-depth-1">(</span>5, 2.45<span class="org-rainbow-delimiters-depth-1">)</span>;
vec1.set<span class="org-rainbow-delimiters-depth-1">(</span>0, -3.45<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"vec1 = "</span> &lt;&lt; vec1 &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">test copy constructor</span>
<span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"Create vec2 - before invoke copy constructor"</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">GSLVector</span> <span class="org-variable-name">vec2</span> = vec1;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"vec1 = "</span> &lt;&lt; vec2 &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"&amp;vec2 == &amp;vec1: "</span> &lt;&lt; <span class="org-rainbow-delimiters-depth-1">(</span>&amp;vec1 == &amp;vec2<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">"\n"</span>;
assert<span class="org-rainbow-delimiters-depth-1">(</span>&amp;vec2 != &amp;vec1<span class="org-rainbow-delimiters-depth-1">)</span>;
vec2.set<span class="org-rainbow-delimiters-depth-1">(</span>0, 10.0<span class="org-rainbow-delimiters-depth-1">)</span>;
vec2.set<span class="org-rainbow-delimiters-depth-1">(</span>1, 25.0<span class="org-rainbow-delimiters-depth-1">)</span>;
vec2<span class="org-rainbow-delimiters-depth-1">[</span>3<span class="org-rainbow-delimiters-depth-1">]</span> = 2.30;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"vec2 = "</span> &lt;&lt; vec2 &lt;&lt; <span class="org-string">"\n"</span>;

<span class="org-type">GSLVector</span> <span class="org-variable-name">vec3</span> = vec1 + vec2;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"vec3 = "</span> &lt;&lt; vec3 &lt;&lt; <span class="org-string">"\n"</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"vec1 * 3 + vec2 * 2.5 = "</span> &lt;&lt; vec1 * 1.5 + vec2 * 2.5 &lt;&lt; <span class="org-string">"\n"</span>;

</pre>
</div>

<p>
Compilation Output: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">$ clang++ gsl-vector-wrapper.cpp -std=c++11 -Wall -Wextra -g -lgsl -lgslcblas -o <span class="org-keyword">out.bin</span> 
$ ./out.bin

vec1 = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> -3.4500 2.4500 2.4500 2.4500 2.4500<span class="org-rainbow-delimiters-depth-1">)</span> 
<span class="org-type">Create</span> <span class="org-variable-name">vec2</span> - before invoke copy constructor
vec1 = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> -3.4500 2.4500 2.4500 2.4500 2.4500<span class="org-rainbow-delimiters-depth-1">)</span> 
&amp;vec2 == &amp;vec1: <span class="org-constant">false</span>
vec2 = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> 10.0000 25.0000 2.4500 2.3000 2.4500<span class="org-rainbow-delimiters-depth-1">)</span> 
vec3 = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> 6.5500 27.4500 4.9000 4.7500 4.9000<span class="org-rainbow-delimiters-depth-1">)</span> 
vec1 * 3 + vec2 * 2.5 = <span class="org-rainbow-delimiters-depth-1">[</span>5<span class="org-rainbow-delimiters-depth-1">](</span> 19.8250 66.1750 9.8000 9.4250 9.8000<span class="org-rainbow-delimiters-depth-1">)</span> 
</pre>
</div>


<p>
References: 
</p>
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/gsl/manual/html_node/Vector-allocation.html#Vector-allocation">GNU Scientific Library – Reference Manual: Vector allocation</a></li>
<li><a href="https://www.gnu.org/software/gsl/manual/html_node/Initializing-vector-elements.html#Initializing-vector-elements">GNU Scientific Library – Reference Manual: Initializing vector elements</a></li>
<li><a href="https://www.gnu.org/software/gsl/manual/html_node/Vector-operations.html#Vector-operations">GNU Scientific Library – Reference Manual: Vector operations</a></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2018-10-30 Tue 15:51</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
