<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-07-14 Sun 01:50 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CPP / C++ Notes - C++17 New Features and Containers</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="cpp c++ code examples, demonstrations, design pattern and integration."
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<link href="theme/org-nav-theme.css" rel="stylesheet">
<script src="theme/org-nav-theme.js"></script>
<link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">CPP / C++ Notes - C++17 New Features and Containers</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org1565abb">1. C++17 New Features and Containers</a>
<ul>
<li><a href="#org02b557c">1.1. C++17 - Structured Bindings</a></li>
<li><a href="#orgd1303eb">1.2. C++17 std::invoke</a></li>
<li><a href="#org89a09e6">1.3. C++17 std::any</a></li>
<li><a href="#orgb6b6c30">1.4. C++17 std::optional</a>
<ul>
<li><a href="#org98cb3d9">1.4.1. Overview</a></li>
<li><a href="#org97b9e96">1.4.2. Example</a></li>
</ul>
</li>
<li><a href="#org215df65">1.5. C++17 std::variant</a></li>
<li><a href="#org5d2f5ba">1.6. C++17 File system library</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org1565abb" class="outline-2">
<h2 id="org1565abb"><span class="section-number-2">1</span> C++17 New Features and Containers</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org02b557c" class="outline-3">
<h3 id="org02b557c"><span class="section-number-3">1.1</span> C++17 - Structured Bindings</h3>
<div class="outline-text-3" id="text-1-1">
<p>
C++17 structured bindings allows to decompose data structures such as
pairs, tuples, C-arrays and structs or classes with public fields in
an uniform way. 
</p>

<p>
Example: 
</p>
<ul class="org-ul">
<li>File: <a href="src/cpp17/cpp17-structured-bindings.cpp">file:src/cpp17/cpp17-structured-bindings.cpp</a></li>
<li>GIST: <a href="https://gist.github.com/caiorss/3fbb30bb6a9bc7672492bd8d9a7b5f41">cpp17-structured-bindings.cpp</a></li>
</ul>

<p>
Compiling and running: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ clang++ -std=c++1z -g -Wall -Wextra cpp17-structured-bindings.cpp -o <span class="org-keyword">cpp17-structured-bindings.bin</span>  
$ ./cpp17-structured-bindings.bin
</pre>
</div>

<p>
<b>Parts in Main Function</b> 
</p>

<ul class="org-ul">
<li>Experiment 1 - Decompose pair.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"\n=== EXPERIMENT 1: Decompose: pair - binding - pair ====="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">p</span> = <span class="org-constant">std</span>::pair<span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-constant">std</span>::string, <span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;(</span><span class="org-string">"C++"</span>, 17<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-rainbow-delimiters-depth-1">[</span>name, version<span class="org-rainbow-delimiters-depth-1">]</span> = p;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">" name = "</span> &lt;&lt; name &lt;&lt; <span class="org-string">" ; version = "</span> &lt;&lt; version &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">=== EXPERIMENT 1: Decompose: pair - binding - pair =====
 name = C++ ; version = 17
</pre>
</div>

<ul class="org-ul">
<li>Experiment 2 -  Decompose: map / 'hash-table'</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"\n=== EXPERIMENT 2: Decompose: map / 'hash-table' - ====="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">database</span> = <span class="org-constant">std</span>::<span class="org-type">map</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-constant">std</span>::string, <span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;{</span><span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">"c++"</span>, 17<span class="org-rainbow-delimiters-depth-2">}</span>, <span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">"rust"</span>, 10<span class="org-rainbow-delimiters-depth-2">}</span>, <span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">"Forth"</span>, 200<span class="org-rainbow-delimiters-depth-2">}</span><span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp; <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-constant">key</span>, <span class="org-constant">value</span><span class="org-rainbow-delimiters-depth-2">]</span> : database<span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"key = "</span> &lt;&lt; key &lt;&lt; <span class="org-string">" ; value = "</span> &lt;&lt; value &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">=== EXPERIMENT 2: Decompose: map / <span class="org-string">'hash-table'</span> - =====
key = Forth ; value = 200
key = c++ ; value = 17
key = rust ; value = 10
</pre>
</div>

<ul class="org-ul">
<li>Experiment 3 - Decompose: tuple</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"\n=== EXPERIMENT 3: Decompose: tuple - ====="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">DatabaseRow</span> = <span class="org-constant">std</span>::<span class="org-type">tuple</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span>, <span class="org-constant">std</span>::string, <span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">database</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">DatabaseRow</span><span class="org-rainbow-delimiters-depth-1">&gt;{</span>
        <span class="org-rainbow-delimiters-depth-2">{</span>100, <span class="org-string">"Fried tasty fresh cheese"</span>,   3.45<span class="org-rainbow-delimiters-depth-2">}</span>,
        <span class="org-rainbow-delimiters-depth-2">{</span>400, <span class="org-string">"Super hot toasted coffee."</span>, 6.25<span class="org-rainbow-delimiters-depth-2">}</span>,
        <span class="org-rainbow-delimiters-depth-2">{</span>500, <span class="org-string">"Fresh Orange Juice"</span>,        4.50<span class="org-rainbow-delimiters-depth-2">}</span>,
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp; <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-constant">id</span>, <span class="org-constant">name</span>, <span class="org-constant">price</span><span class="org-rainbow-delimiters-depth-2">]</span>: database<span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" ROW=&gt; id = "</span> &lt;&lt; id
                  &lt;&lt; <span class="org-string">" ; name = "</span>   &lt;&lt; name
                  &lt;&lt; <span class="org-string">" ; price = "</span>  &lt;&lt; price 
                  &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output:
</p>

<div class="org-src-container">
<pre class="src src-sh">=== EXPERIMENT 3: Decompose: tuple - =====
 <span class="org-variable-name">ROW</span>=&gt; id = 100 ; name = Fried tasty fresh cheese ; price = 3.45
 <span class="org-variable-name">ROW</span>=&gt; id = 400 ; name = Super hot toasted coffee. ; price = 6.25
 <span class="org-variable-name">ROW</span>=&gt; id = 500 ; name = Fresh Orange Juice ; price = 4.5
</pre>
</div>

<ul class="org-ul">
<li>Experiment 4 - Decompose Structs</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"\n=== EXPERIMENT 4: Decompose: Structs - ====="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">struct</span> <span class="org-type">GeoCoordinate</span><span class="org-rainbow-delimiters-depth-1">{</span>
        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">name</span>;
        <span class="org-type">double</span>      <span class="org-variable-name">latitude</span>;
        <span class="org-type">double</span>      <span class="org-variable-name">longitude</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">auto</span> <span class="org-variable-name">geoDatabase</span> = <span class="org-constant">std</span>::<span class="org-type">deque</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">GeoCoordinate</span><span class="org-rainbow-delimiters-depth-1">&gt;{</span>
         <span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">"Bogota"</span>,         4.7110,  -74.0721<span class="org-rainbow-delimiters-depth-2">}</span>
        ,<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">"Beijing"</span>,       39.9042,  116.4074<span class="org-rainbow-delimiters-depth-2">}</span>
        ,<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">"Gauteng"</span>,      -26.2708,   28.1123<span class="org-rainbow-delimiters-depth-2">}</span>          
        ,<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">"Buenos Aires"</span>, -34.6037,  -58.3816<span class="org-rainbow-delimiters-depth-2">}</span>
        ,<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-string">"Brasilia"</span>,     -15.8267,  -47.9218<span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-1">(</span>3<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-function-name">std</span>::for_each<span class="org-rainbow-delimiters-depth-1">(</span>geoDatabase.begin<span class="org-rainbow-delimiters-depth-2">()</span>, geoDatabase.end<span class="org-rainbow-delimiters-depth-2">()</span>,
              <span class="org-rainbow-delimiters-depth-2">[](</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp; <span class="org-variable-name">city</span><span class="org-rainbow-delimiters-depth-2">){</span>
                  <span class="org-comment-delimiter">// </span><span class="org-comment">Decompose struct into name, latitude and longitude</span>
                  <span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp; <span class="org-rainbow-delimiters-depth-3">[</span><span class="org-constant">name</span>, <span class="org-constant">lat</span>, <span class="org-constant">lon</span><span class="org-rainbow-delimiters-depth-3">]</span> = city;
                  <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>15<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; <span class="org-constant">std</span>::left  &lt;&lt; name
                            &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>8<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; lat
                            &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>8<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; lon 
                            &lt;&lt; <span class="org-string">"\n"</span>;                          
              <span class="org-rainbow-delimiters-depth-2">}</span><span class="org-rainbow-delimiters-depth-1">)</span>; 
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">=== EXPERIMENT 4: Decompose: Structs - =====
Bogota             4.71   -74.1
Beijing            39.9     116
Gauteng           -26.3    28.1
Buenos Aires      -34.6   -58.4
Brasilia          -15.8   -47.9
</pre>
</div>

<ul class="org-ul">
<li>Decompose: C-Array</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"\n=== EXPERIMENT 5: Decompose: C-Array - ====="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">double</span> <span class="org-variable-name">array</span> <span class="org-rainbow-delimiters-depth-1">[</span>3<span class="org-rainbow-delimiters-depth-1">]</span> = <span class="org-rainbow-delimiters-depth-1">{</span>10.23, 90.23, 100.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">auto</span> <span class="org-rainbow-delimiters-depth-1">[</span>x, y, z<span class="org-rainbow-delimiters-depth-1">]</span> = array;
<span class="org-function-name">std</span>::printf<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">" array { x = %.3f ; y = %.3f ; z = %.3f }"</span>, x, y, z<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">=== EXPERIMENT 5: Decompose: C-Array - =====
 array { x = 10.230 ; y = 90.230 ; z = 100.000 }
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd1303eb" class="outline-3">
<h3 id="orgd1303eb"><a id="ID-5754cb0e-f4d3-434c-85e0-5ea55655a22f"></a><span class="section-number-3">1.2</span> C++17 std::invoke</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Function which provides an uniform interface for invoking anything
callable such as class member functions (ordinary methods), static
member functions (static methods), functios and etc.
</p>

<p>
See: <a href="https://en.cppreference.com/w/cpp/utility/functional/invoke">https://en.cppreference.com/w/cpp/utility/functional/invoke</a>
</p>

<ul class="org-ul">
<li>File: <a href="src/cpp17/cpp17-invoke.cpp">file:src/cpp17/cpp17-invoke.cpp</a></li>
<li>Online Compiler: <a href="http://rextester.com/IPY88297">http://rextester.com/IPY88297</a></li>
</ul>

<p>
Headers:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">ostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">std::invoke is provide by header functional</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
</pre>
</div>


<p>
Class Dummy:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">struct</span> <span class="org-type">Dummy</span><span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">double</span> <span class="org-function-name">evalme</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; __FILE__ &lt;&lt; <span class="org-string">":"</span> &lt;&lt; __LINE__ &lt;&lt; <span class="org-string">" I was evaluated ; 2x = "</span> &lt;&lt; 2 *x &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-keyword">return</span> 2 * x;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">double</span> <span class="org-keyword">operator</span><span class="org-function-name"><span class="org-rainbow-delimiters-depth-2">()</span></span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-2">){</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; __FILE__ &lt;&lt; <span class="org-string">":"</span> &lt;&lt; __LINE__ &lt;&lt; <span class="org-string">" Call function-operator &lt;&lt; 4 * x = "</span> &lt;&lt; 4 * x &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-keyword">return</span> 4 * x;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Function computeDouble:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">double</span> <span class="org-function-name">computeDouble</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">){</span>
    <span class="org-constant">std</span>::cerr &lt;&lt; __FILE__ &lt;&lt; <span class="org-string">":"</span> &lt;&lt; __LINE__ &lt;&lt; <span class="org-string">" Computed double of 2x = "</span> &lt;&lt; 2 * x &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-keyword">return</span> 2 * x;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Main function:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(){</span>
    <span class="org-constant">std</span>::invoke<span class="org-rainbow-delimiters-depth-2">(</span>computeDouble, 3.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">Dummy</span> <span class="org-variable-name">dummy</span>;
    <span class="org-constant">std</span>::invoke<span class="org-rainbow-delimiters-depth-2">(</span>dummy, 3.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::invoke<span class="org-rainbow-delimiters-depth-2">(</span>Dummy<span class="org-rainbow-delimiters-depth-3">()</span>, 2.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Call method: .evalme indirectly </span>
    <span class="org-constant">std</span>::invoke<span class="org-rainbow-delimiters-depth-2">(</span>&amp;<span class="org-constant">Dummy</span>::evalme, dummy, 3.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Compile and run: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ g++ cpp17-invoke.cpp -o <span class="org-keyword">out.bin</span> -std=c++1z -Wall -Wextra &amp;&amp; ./out.bin

<span class="org-function-name">cpp17-invoke.cpp</span>:20 Computed double of 2x = 6
<span class="org-function-name">cpp17-invoke.cpp</span>:14 Call function-operator &lt;&lt; 4 * x = 12
<span class="org-sh-heredoc">cpp17-invoke.cpp:14 Call function-operator &lt;&lt; 4 * x = 8</span>
<span class="org-sh-heredoc">cpp17-invoke.cpp:9 I was evaluated ; 2x = 6</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org89a09e6" class="outline-3">
<h3 id="org89a09e6"><a id="ID-9397a9a0-e641-4cb6-89b7-24a82fe12d99"></a><span class="section-number-3">1.3</span> C++17 std::any</h3>
<div class="outline-text-3" id="text-1-3">
<p>
This example shows how to use the C++17 std::any container which comes
froom boost::any.
</p>

<p>
See: <a href="https://en.cppreference.com/w/cpp/utility/any">https://en.cppreference.com/w/cpp/utility/any</a>
</p>

<p>
File:  <a href="src/cpp17/cpp17-any.cpp">file:src/cpp17/cpp17-any.cpp</a> 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">ostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">any</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">struct</span> <span class="org-type">Point</span><span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">double</span> <span class="org-variable-name">x</span>;
    <span class="org-type">double</span> <span class="org-variable-name">y</span>;
    <span class="org-function-name">Point</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span>, <span class="org-type">double</span> <span class="org-variable-name">y</span><span class="org-rainbow-delimiters-depth-2">)</span>: x<span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>, y<span class="org-rainbow-delimiters-depth-2">(</span>y<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Copy constructor</span>
    <span class="org-function-name">Point</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-type">Point</span>&amp; <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-2">){</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" --&gt;&gt; Copy constructor"</span> &lt;&lt; <span class="org-string">'\n'</span>;
        x = p.x;
        y = p.y;
    <span class="org-rainbow-delimiters-depth-2">}</span>   
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-function-name">std</span>::ostream&amp; <span class="org-keyword">operator</span>&lt;&lt;<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-keyword">const</span> <span class="org-type">Point</span>&amp; <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-1">){</span>
    os &lt;&lt; <span class="org-string">"Point("</span> &lt;&lt; p.x &lt;&lt; <span class="org-string">", "</span> &lt;&lt; p.y &lt;&lt; <span class="org-string">") "</span>;
    <span class="org-keyword">return</span> os;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">typename</span> <span class="org-type">T</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">auto</span> <span class="org-function-name">printInfo</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">any</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-type">void</span><span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" x.type = "</span> &lt;&lt; x.type<span class="org-rainbow-delimiters-depth-2">()</span>.name<span class="org-rainbow-delimiters-depth-2">()</span>
              &lt;&lt; <span class="org-string">" ; value(x) = "</span>
              &lt;&lt; <span class="org-constant">std</span>::any_cast<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">T</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>
              &lt;&lt; <span class="org-string">'\n'</span>;  
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(){</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Print boolean as 'true', 'false', instead of 0 or 1</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;
    <span class="org-constant">std</span>::<span class="org-type">any</span> <span class="org-variable-name">x</span> = 1;
    printInfo<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
    x = 10.233;
    printInfo<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
    x = <span class="org-string">'k'</span>;
    printInfo<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">char</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
    x = <span class="org-string">"hello world"</span>;
    printInfo<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-keyword">const</span> <span class="org-type">char</span>*<span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
    x = <span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"hello world"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    printInfo<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;  
    x = Point<span class="org-rainbow-delimiters-depth-2">(</span>100.0, 20.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    printInfo<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Point</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Has value: x.has_value() = "</span> &lt;&lt; x.has_value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">'\n'</span>;
    x.reset<span class="org-rainbow-delimiters-depth-2">()</span>;                                                         
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Has value: x.has_value() = "</span> &lt;&lt; x.has_value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">'\n'</span>;                                                               
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Try casting "</span> &lt;&lt; <span class="org-constant">std</span>::endl;
    x = <span class="org-string">"testing type casting"</span>;
    <span class="org-keyword">try</span><span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::any_cast<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>x<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">bad_any_cast</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" &gt;&gt;&gt; Exception: what = "</span> &lt;&lt; ex.what<span class="org-rainbow-delimiters-depth-3">()</span> &lt;&lt; <span class="org-string">'\n'</span>; 
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" &gt;&gt;&gt; End the program gracefully"</span> &lt;&lt; <span class="org-string">'\n'</span>; 
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>

<p>
Compiling with gcc: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ g++ --version
g++ (GCC) 7.3.1 20180130 (Red Hat 7.3.1-2)
.. ... ... ... 

$ g++ cpp17-any.cpp -o <span class="org-keyword">out.bin</span> -std=c++1z -Wall -Wextra &amp;&amp; ./out.bin
 x.type = i ; value(x) = 1
 x.type = d ; value(x) = 10.233
 x.type = c ; value(x) = k
 x.type = PKc ; value(x) = hello world
 x.type = NSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE ; value(x) = hello world
 --&gt;&gt; Copy constructor
 --&gt;&gt; Copy constructor
 x.type = 5Point ; value(x) =  --&gt;&gt; Copy constructor
<span class="org-function-name">Point</span>(100, 20) 
Has value: x.has_value() = true
Has value: x.has_value() = false
Try casting 
 &gt;&gt;&gt; Exception: what = bad any_cast
 &gt;&gt;&gt; End the program gracefully
</pre>
</div>

<p>
Compile with MSVC / VC++ on Windows: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cl.exe cpp17-any.cpp /EHsc /Zi /nologo /std:c++17 /Fe:out.exe &amp;&amp; out.exe
cpp17-any.cpp
 x.type = int ; value(x) = 1
 x.type = double ; value(x) = 10.233
 x.type = char ; value(x) = k
 x.type = char const * __ptr64 ; value(x) = hello world
 x.type = class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; ; value(x) = hello world
 --&gt;&gt; Copy constructor
 --&gt;&gt; Copy constructor
 --&gt;&gt; Copy constructor
 x.type = struct Point ; value(x) = Point(100, 20) 
Has value: x.has_value() = true
Has value: x.has_value() = false
Try casting 
 &gt;&gt;&gt; Exception: what = Bad any_cast
 &gt;&gt;&gt; End the program gracefully
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6b6c30" class="outline-3">
<h3 id="orgb6b6c30"><span class="section-number-3">1.4</span> C++17 std::optional</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-org98cb3d9" class="outline-4">
<h4 id="org98cb3d9"><span class="section-number-4">1.4.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
The container std::optional allows expressing in a concise and
type-safe way that a function may return nothing, the function
parameter may be empty or that a class field may be empty as well.
This type is a disjoint union similar to Haskell's Maybe or OCaml
optional. A common approach used by many C++ APIs for dealing with
empty return values is to return a pointer to the returned value and
return null pointer when no value is found or the function retuned
nothing. The drawback of this approach is the possibility of null
pointer dereference which is a undefined behavior and may unexpectedly
crash the program. In other language this common problem is known as
the infamous null pointer exception.
</p>

<p>
Documentation: 
</p>
<ul class="org-ul">
<li><a href="https://en.cppreference.com/w/cpp/utility/optional/optional">std::optional::optional - cppreference.com</a></li>
<li><a href="https://en.cppreference.com/w/cpp/utility/optional/value_or">std::optional::value_or - cppreference.com</a></li>
<li><a href="https://www.boost.org/doc/libs/1_69_0/libs/optional/doc/html/index.html">Boost.Optional</a> (Predecessor of std::optional)</li>
</ul>

<p>
<b>Constructors:</b>
</p>

<p>
Create empty std::optional object (default).
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span>T<span class="org-rainbow-delimiters-depth-1">&gt;</span> value;
</pre>
</div>

<p>
Create an empty std::optional object  (std::nullopt) explicity: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span>T<span class="org-rainbow-delimiters-depth-1">&gt;</span> value = <span class="org-constant">std</span>::nullopt;
<span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span>T<span class="org-rainbow-delimiters-depth-1">&gt;</span> value<span class="org-rainbow-delimiters-depth-1">{</span><span class="org-constant">std</span>::nullopt<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span>T<span class="org-rainbow-delimiters-depth-1">&gt;</span> value = <span class="org-rainbow-delimiters-depth-1">{}</span>

<span class="org-keyword">auto</span> <span class="org-variable-name">value</span> = <span class="org-constant">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> <span class="org-rainbow-delimiters-depth-1">{</span><span class="org-constant">std</span>::nullopt<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">value</span> = <span class="org-constant">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> <span class="org-rainbow-delimiters-depth-1">{}</span>;
</pre>
</div>

<p>
Create a std::optional instance set to some value
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> value = 100;
<span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> value<span class="org-rainbow-delimiters-depth-1">{</span>100<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">value</span> = <span class="org-constant">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> <span class="org-rainbow-delimiters-depth-1">{</span>100<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
<b>Check whether std::optional instance has a value or not</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> x = 100;
<span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span> 
  <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x is NOT EMPTY x = "</span> &lt;&lt; x.value<span class="org-rainbow-delimiters-depth-1">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-keyword">else</span>
  <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x is EMPTY. "</span> &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>
</div>
</div>

<div id="outline-container-org97b9e96" class="outline-4">
<h4 id="org97b9e96"><span class="section-number-4">1.4.2</span> Example</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Source:
</p>
<ul class="org-ul">
<li>File: <a href="src/cpp17/optional1.cpp">file:src/cpp17/optional1.cpp</a></li>
<li>GIST: <a href="https://gist.github.com/caiorss/4cae2aca1b9ad6ee315bc887e36a1938">optional1.cpp</a></li>
</ul>

<p>
Compiling and running:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ clang++ optional1.cpp -o <span class="org-keyword">optional1.bin</span> -std=c++1z -g -O0 -Wall 
$ ./optional1.bin
</pre>
</div>

<p>
Headers:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>  <span class="org-comment-delimiter">// </span><span class="org-comment">std::stof </span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">ostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> <span class="org-comment-delimiter">// </span><span class="org-comment">operator (&lt;&lt;) and class ostream </span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> <span class="org-comment-delimiter">// </span><span class="org-comment">setprecision</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">optional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
</pre>
</div>

<p>
Class <span class="underline">Location</span> contains an optional field: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Class with optional field.</span>
<span class="org-keyword">struct</span> <span class="org-type">Location</span><span class="org-rainbow-delimiters-depth-1">{</span>
     <span class="org-type">double</span> <span class="org-variable-name">lat</span>;
     <span class="org-type">double</span> <span class="org-variable-name">lon</span>;
     <span class="org-constant">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">name</span>; 
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Insertion operator overload to make the class Location printable: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Make std::optional&lt;Location&gt; printable </span>
<span class="org-function-name">std</span>::ostream&amp; <span class="org-keyword">operator</span>&lt;&lt;<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-keyword">const</span> <span class="org-type">Location</span>&amp; <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">){</span>
     os &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-2">(</span>2<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-constant">std</span>::fixed;
     <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>x.name<span class="org-rainbow-delimiters-depth-2">)</span>
        os &lt;&lt; <span class="org-string">"Location("</span>
           &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; x.lat
           &lt;&lt; <span class="org-string">" ; y = "</span> &lt;&lt; x.lon
           &lt;&lt; <span class="org-string">" ; name = "</span>
           &lt;&lt; x.name.value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">")"</span>;
     <span class="org-keyword">else</span>
        os &lt;&lt; <span class="org-string">"Location("</span>
           &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; x.lat
           &lt;&lt; <span class="org-string">" ; y = "</span> &lt;&lt; x.lon
           &lt;&lt; <span class="org-string">" ; name = "</span>
           &lt;&lt; <span class="org-string">"&lt;unknown&gt;"</span> &lt;&lt; <span class="org-string">")"</span>;       
     <span class="org-keyword">return</span> os;  
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Insertion operator overload (&lt;&lt;) for making the value
std::optiona&lt;double&gt; printable:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Make std::optional&lt;double&gt; printable</span>
<span class="org-function-name">std</span>::ostream&amp; <span class="org-keyword">operator</span>&lt;&lt;<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>&amp; <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">){</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span>
       os &lt;&lt; <span class="org-string">"Some[Double]("</span> &lt;&lt; x.value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">")"</span>;
    <span class="org-keyword">else</span>
       os &lt;&lt; <span class="org-string">"None[Double]"</span>;
    <span class="org-keyword">return</span> os;  
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Function <span class="underline">parseDouble</span> may return nothing if the function fails:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
parseDouble<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">string</span>&amp; <span class="org-variable-name">str</span><span class="org-rainbow-delimiters-depth-1">)</span>  
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">try</span><span class="org-rainbow-delimiters-depth-2">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Return some value </span>
        <span class="org-keyword">return</span> <span class="org-constant">std</span>::make_optional<span class="org-rainbow-delimiters-depth-3">(</span>stod<span class="org-rainbow-delimiters-depth-4">(</span>str<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">invalid_argument</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Return nothing </span>
        <span class="org-keyword">return</span> <span class="org-constant">std</span>::nullopt;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Function: getEnvVar attempts to return the value environment variable,
if it fails returns nothing: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">auto</span> <span class="org-function-name">getEnvVar</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">varname</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-constant">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">v</span> = <span class="org-constant">std</span>::getenv<span class="org-rainbow-delimiters-depth-3">(</span>varname.c_str<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
         <span class="org-comment-delimiter">// </span><span class="org-comment">Returns some value </span>
         <span class="org-keyword">return</span> v;
    <span class="org-keyword">else</span>
         <span class="org-comment-delimiter">// </span><span class="org-comment">Returns nothing (same as std::nullopt)</span>
         <span class="org-keyword">return</span> <span class="org-rainbow-delimiters-depth-2">{}</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>  
</pre>
</div>

<p>
Function main: 
</p>

<ul class="org-ul">
<li>Experiment 1: Print optional values</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">char</span> <span class="org-variable-name">endl</span> = <span class="org-string">'\n'</span>;

<span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> oa;
<span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> ob = <span class="org-constant">std</span>::nullopt;
<span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> oc = 10.233;
<span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> od<span class="org-rainbow-delimiters-depth-1">(</span>1e3<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">std</span>::<span class="org-type">optional</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">&gt;</span> oe <span class="org-rainbow-delimiters-depth-1">{}</span>;

<span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"==== EXPERIMENT 1 === Print optional value"</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"oa = "</span> &lt;&lt; oa &lt;&lt; endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"ob = "</span> &lt;&lt; ob &lt;&lt; endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"oc = "</span> &lt;&lt; oc &lt;&lt; endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"od = "</span> &lt;&lt; od &lt;&lt; endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"oe = "</span> &lt;&lt; oe &lt;&lt; endl; 
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">==== EXPERIMENT 1 === Print optional value
oa = None[Double]
ob = None[Double]
oc = Some[Double](10.233)
od = Some[Double](1000)
oe = None[Double]
</pre>
</div>


<ul class="org-ul">
<li>Experiment 2: Reset optional values</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-function-name">std</span>::puts(<span class="org-string">"==== EXPERIMENT 2 === Reset optional value"</span>);
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"Reset variable oc "</span> &lt;&lt; endl;
<span class="org-sh-heredoc">oc.reset();</span>
<span class="org-sh-heredoc">std::cout &lt;&lt; "oc = " &lt;&lt; oc &lt;&lt; endl;</span>
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">==== EXPERIMENT 2 === Reset optional value
Reset variable oc 
oc = None[Double]
</pre>
</div>


<ul class="org-ul">
<li>Experiment 3: Check whether optional has value. (is not empty)</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"==== EXPERIMENT 3 ==== check whether optional has value. (is not empty) ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-1">(</span>oc<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"&gt;&gt; oc has a vaule"</span> &lt;&lt; endl;
<span class="org-keyword">else</span>
   <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"&gt;&gt; oc is empty"</span> &lt;&lt; endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-txt">==== EXPERIMENT 3 ==== check whether optional has value. (is not empty) ====
&gt;&gt; oc is empty
</pre>
</div>


<ul class="org-ul">
<li>Experiment 4: Try to parse double.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"==== EXPERIMENT 4 ==== try parse double ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;      
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"x0 = "</span> &lt;&lt; parseDouble<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"-1.0e3"</span><span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"x1 = "</span> &lt;&lt; parseDouble<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"1.351 "</span><span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"x2 = "</span> &lt;&lt; parseDouble<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"1.asdasd351 xxgh"</span><span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"x4 = "</span> &lt;&lt; parseDouble<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"sad4543fgx"</span><span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-txt">==== EXPERIMENT 4 ==== try parse double ====
x0 = Some[Double](-1000)
x1 = Some[Double](1.351)
x2 = Some[Double](1)
x4 = None[Double]
</pre>
</div>


<ul class="org-ul">
<li>Experiment 5: Struct/class with optional field.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"=== EXPERIMENT 5 ======== Structs/Classes with optional fields ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span>Location<span class="org-rainbow-delimiters-depth-1">&gt;</span> xs <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>10.31, 23.4, <span class="org-string">"Waypoint Delta"</span><span class="org-rainbow-delimiters-depth-2">}</span>,
    <span class="org-rainbow-delimiters-depth-2">{</span>-46.23, 145.13, <span class="org-string">"Waypoint gamma"</span><span class="org-rainbow-delimiters-depth-2">}</span>,
    <span class="org-rainbow-delimiters-depth-2">{</span>90.43, 100.345, <span class="org-constant">std</span>::nullopt<span class="org-rainbow-delimiters-depth-2">}</span>,
    <span class="org-rainbow-delimiters-depth-2">{</span>0, 0, <span class="org-rainbow-delimiters-depth-3">{}</span><span class="org-rainbow-delimiters-depth-2">}</span>,
<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-type">int</span> <span class="org-variable-name">i</span> = 0;
<span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">auto</span> <span class="org-variable-name">x</span>: xs<span class="org-rainbow-delimiters-depth-1">){</span>
   <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x["</span> &lt;&lt; i &lt;&lt; <span class="org-string">"]"</span> &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; x &lt;&lt; endl;
   i++;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Output:
</p>

<div class="org-src-container">
<pre class="src src-txt">=== EXPERIMENT 5 ======== Structs/Classes with optional fields ====
x[0] = Location(x = 10.31 ; y = 23.40 ; name = Waypoint Delta)
x[1] = Location(x = -46.23 ; y = 145.13 ; name = Waypoint gamma)
x[2] = Location(x = 90.43 ; y = 100.34 ; name = &lt;unknown&gt;)
x[3] = Location(x = 0.00 ; y = 0.00 ; name = &lt;unknown&gt;)

</pre>
</div>


<ul class="org-ul">
<li>Experiment 6: Print environment variables.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"=== EXPERIMENT 6 - Print environment variables. ===== "</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">var_home</span> =  getEnvVar<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"HOME"</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-1">(</span>var_home.has_value<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"$HOME = "</span> &lt;&lt; var_home.value<span class="org-rainbow-delimiters-depth-1">()</span> &lt;&lt; endl;
<span class="org-keyword">else</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"$HOME = "</span> &lt;&lt; <span class="org-string">"UNKNOWN"</span> &lt;&lt; endl;

<span class="org-keyword">auto</span> <span class="org-variable-name">var_dummy</span> =  getEnvVar<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"DUMMY-VAR"</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-1">(</span>var_dummy.has_value<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"$DUMMYVAR = "</span> &lt;&lt; var_dummy.value<span class="org-rainbow-delimiters-depth-1">()</span> &lt;&lt; endl;
<span class="org-keyword">else</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"$DUMMYVAR = "</span> &lt;&lt; <span class="org-string">"UNKNOWN"</span> &lt;&lt; endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-txt">=== EXPERIMENT 6 - Print environment variables. ===== 
$HOME = /home/archbox
$DUMMYVAR = UNKNOWN
</pre>
</div>


<ul class="org-ul">
<li>Experiment 6: Test member function .value_or()</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::puts<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"==== EXPERIMENT 7 - Test member function .value_or() ===="</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"$XDG_SESSION_PATH = "</span>
          &lt;&lt; getEnvVar<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"XDG_SESSION_PATH"</span><span class="org-rainbow-delimiters-depth-1">)</span>.value_or<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"&lt;&lt;error: not set&gt;&gt;"</span><span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">'\n'</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"$HOMEX = "</span>
          &lt;&lt; getEnvVar<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"HOMEX"</span><span class="org-rainbow-delimiters-depth-1">)</span>.value_or<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"&lt;&lt;error: not set&gt;&gt;"</span><span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-string">'\n'</span>;

<span class="org-keyword">return</span> 0;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-txt">=== EXPERIMENT 6 - Print environment variables. ===== 
$HOME = /home/archbox
$DUMMYVAR = UNKNOWN
==== EXPERIMENT 7 - Test member function .value_or() ====
$XDG_SESSION_PATH = &lt;&lt;error: not set&gt;&gt;
$HOMEX = &lt;&lt;error: not set&gt;&gt;
</pre>
</div>
</div>
</div>
</div>











<div id="outline-container-org215df65" class="outline-3">
<h3 id="org215df65"><span class="section-number-3">1.5</span> C++17 std::variant</h3>
<div class="outline-text-3" id="text-1-5">
<p>
C++17 new std::variant which comes from Boost.Variant provides a
type-safe discriminated union or sum type which is similar to pattern
matching from functional programming languages like Haskell, OCaml and
Scala. In addition to those benefits, the std::variant is an
out-of-the-box generic visitor design pattern and a type-safe
replacement for old C-unions.
</p>

<p>
Potential Applications: 
</p>
<ul class="org-ul">
<li>Implement visitor OOP pattern.</li>
<li>Simulate or emulate pattern matching from functional languages.</li>
<li>Manipulate abstract syntax trees.</li>
</ul>

<p>
Useful concepts references: 
</p>
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Tagged_union">Tagged union - Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Algebraic_data_type">Algebraic data type - Wikipedia</a></li>
</ul>

<p>
Documentation: 
</p>
<ul class="org-ul">
<li><a href="https://en.cppreference.com/w/cpp/utility/variant">https://en.cppreference.com/w/cpp/utility/variant</a></li>
<li><a href="https://www.boost.org/doc/libs/1_64_0/doc/html/variant.html">Chapter 45. Boost.Variant - 1.64.0</a></li>
</ul>

<p>
Code example: 
</p>

<ul class="org-ul">
<li>File: <a href="src/cpp17/variant.cpp">file:src/cpp17/variant.cpp</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">variant</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> <span class="org-comment-delimiter">// </span><span class="org-comment">C++17</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">ostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">deque</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">template</span> <span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">class</span> <span class="org-type">T</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">auto</span> <span class="org-function-name">display</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">string</span>&amp; <span class="org-variable-name">name</span>, <span class="org-keyword">const</span> <span class="org-type">T</span>&amp; <span class="org-variable-name">t</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-type">void</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Pattern matching using constexpr =&gt; May be the more performant way </span>
<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">class</span> <span class="org-type">T</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">auto</span> <span class="org-function-name">identifyAndPrint</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-type">T</span>&amp; <span class="org-variable-name">v</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-type">void</span>;

<span class="org-keyword">struct</span> <span class="org-type">VisitorOperation</span><span class="org-rainbow-delimiters-depth-1">{</span>
        <span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name"><span class="org-rainbow-delimiters-depth-2">()</span></span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">num</span><span class="org-rainbow-delimiters-depth-2">)</span> -&gt; <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-2">{</span>
                <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"type = int     =&gt; value = "</span> &lt;&lt; num &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>
        <span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name"><span class="org-rainbow-delimiters-depth-2">()</span></span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">num</span><span class="org-rainbow-delimiters-depth-2">)</span> -&gt; <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-2">{</span>
                <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"type = double  =&gt; value = "</span> &lt;&lt; num &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>
        <span class="org-keyword">auto</span> <span class="org-keyword">operator</span><span class="org-function-name"><span class="org-rainbow-delimiters-depth-2">()</span></span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">string</span>&amp; <span class="org-variable-name">s</span><span class="org-rainbow-delimiters-depth-2">){</span>
                <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"type = string  =&gt; value = "</span> &lt;&lt; s &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(){</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">using &lt;1&gt;, &lt;2&gt;, ... &lt;n&gt; =&gt; Only available at C++17</span>
        <span class="org-keyword">using</span> <span class="org-constant">std</span>::<span class="org-type">cout</span>, <span class="org-constant">std</span>::endl, <span class="org-constant">std</span>::cerr;
        <span class="org-keyword">auto</span> <span class="org-variable-name">nl</span> = <span class="org-string">"\n"</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;
        cout &lt;&lt; <span class="org-string">"========== Test 1 =================="</span> &lt;&lt; nl;   

        <span class="org-comment-delimiter">// </span><span class="org-comment">std::variant&lt;int, double, std::string&gt; somevar;</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">x</span> = <span class="org-constant">std</span>::variant<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">int</span>, <span class="org-type">double</span>, <span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-2">&gt;()</span>;
        x = 100;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"variant has int    = "</span> &lt;&lt; <span class="org-constant">std</span>::holds_alternative<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; nl;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"variant has double = "</span> &lt;&lt; <span class="org-constant">std</span>::holds_alternative<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; nl;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"variant has string = "</span> &lt;&lt; <span class="org-constant">std</span>::holds_alternative<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; nl;
        display<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"x"</span>, x<span class="org-rainbow-delimiters-depth-2">)</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"-------------------"</span> &lt;&lt; nl;
        x = 204.45;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"variant has double = "</span> &lt;&lt; <span class="org-constant">std</span>::holds_alternative<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; nl;    
        display<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"x"</span>, x<span class="org-rainbow-delimiters-depth-2">)</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"-------------------"</span> &lt;&lt; nl;
        x = <span class="org-string">"std::variant is awesome!"</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"variant has string = "</span> &lt;&lt; <span class="org-constant">std</span>::holds_alternative<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; nl;
        display<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"x"</span>, x<span class="org-rainbow-delimiters-depth-2">)</span>;

        cout &lt;&lt; <span class="org-string">"========== Test 2 =================="</span> &lt;&lt; nl;
        <span class="org-keyword">try</span><span class="org-rainbow-delimiters-depth-2">{</span> 
                <span class="org-comment-delimiter">// </span><span class="org-comment">Try to get int </span>
                <span class="org-type">int</span> <span class="org-variable-name">m</span> = <span class="org-constant">std</span>::get<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>x<span class="org-rainbow-delimiters-depth-3">)</span>;
                <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"m = "</span> &lt;&lt; m &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">bad_variant_access</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">){</span>
                <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"Error: Failed to extract int."</span> &lt;&lt; nl;
        <span class="org-rainbow-delimiters-depth-2">}</span>
        <span class="org-keyword">try</span><span class="org-rainbow-delimiters-depth-2">{</span> 
                <span class="org-comment-delimiter">// </span><span class="org-comment">Try to get string </span>
                <span class="org-keyword">auto</span> <span class="org-variable-name">s</span> = <span class="org-constant">std</span>::get<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>x<span class="org-rainbow-delimiters-depth-3">)</span>;
                <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"s = "</span> &lt;&lt; s &lt;&lt; nl;
        <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">bad_variant_access</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">){</span>
                <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"Error: Failed to extract string."</span> &lt;&lt; nl;
        <span class="org-rainbow-delimiters-depth-2">}</span>

        cout &lt;&lt; <span class="org-string">"========== Test 3 =================="</span> &lt;&lt; nl;
        x = -100;
        <span class="org-constant">std</span>::visit<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-keyword">auto</span>&amp;&amp; <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-3">){</span>
                                   <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; p &lt;&lt; <span class="org-string">'\n'</span>;
                           <span class="org-rainbow-delimiters-depth-3">}</span>, x<span class="org-rainbow-delimiters-depth-2">)</span>;
        x = 20.52;
        <span class="org-constant">std</span>::visit<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-keyword">auto</span>&amp;&amp; <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-3">){</span>
                                   <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; p &lt;&lt; <span class="org-string">'\n'</span>;
                           <span class="org-rainbow-delimiters-depth-3">}</span>, x<span class="org-rainbow-delimiters-depth-2">)</span>;

        x = <span class="org-string">"&lt;hello world std::variant&gt;"</span>;
        <span class="org-constant">std</span>::visit<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-keyword">auto</span>&amp;&amp; <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-3">){</span>
                                   <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"x = "</span> &lt;&lt; p &lt;&lt; <span class="org-string">'\n'</span>;
                           <span class="org-rainbow-delimiters-depth-3">}</span>, x<span class="org-rainbow-delimiters-depth-2">)</span>;

        cout &lt;&lt; <span class="org-string">"========== Test 4 =================="</span> &lt;&lt; nl;
        <span class="org-comment-delimiter">// </span><span class="org-comment">auto + uniform initialization </span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">xs</span> = <span class="org-constant">std</span>::<span class="org-type">deque</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::<span class="org-type">variant</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span>, <span class="org-type">double</span>, <span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-3">&gt;</span><span class="org-rainbow-delimiters-depth-2">&gt;{</span>10.0, 20, 5, <span class="org-string">"hello"</span>, 10, <span class="org-string">"world"</span><span class="org-rainbow-delimiters-depth-2">}</span>;
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp; <span class="org-variable-name">e</span>: xs<span class="org-rainbow-delimiters-depth-2">){</span>
                identifyAndPrint<span class="org-rainbow-delimiters-depth-3">(</span>e<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>
        cout &lt;&lt; <span class="org-string">"========== Test 5 =================="</span> &lt;&lt; nl;
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-keyword">auto</span>&amp; <span class="org-variable-name">e</span>: xs<span class="org-rainbow-delimiters-depth-2">){</span>
                <span class="org-constant">std</span>::visit<span class="org-rainbow-delimiters-depth-3">(</span>VisitorOperation<span class="org-rainbow-delimiters-depth-4">()</span>, e<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>   
        <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">It works in a similar fashion to functional languages with</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">pattern matching such as Haskell, Scala, OCaml and so on.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">std::variant is also a type-safe alternative to old C-unions.</span>
<span class="org-keyword">template</span> <span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">class</span> <span class="org-type">T</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">auto</span> <span class="org-function-name">display</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">string</span>&amp; <span class="org-variable-name">name</span>, <span class="org-keyword">const</span> <span class="org-type">T</span>&amp; <span class="org-variable-name">t</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">{</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">nl</span> = <span class="org-string">"\n"</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Boost.Variant uses boost::get&lt;TYPE&gt;(&amp;t), now changed to std::get_if</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">auto</span> <span class="org-variable-name">n</span> = <span class="org-constant">std</span>::get_if<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>&amp;t<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">){</span>
                <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; *n &lt;&lt; nl;
                <span class="org-keyword">return</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Early return </span>
        <span class="org-rainbow-delimiters-depth-2">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">auto</span> <span class="org-variable-name">d</span> = <span class="org-constant">std</span>::get_if<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>&amp;t<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">){</span>
                <span class="org-constant">std</span>::cout &lt;&lt; name &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; *d &lt;&lt; nl;
                <span class="org-keyword">return</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>   
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">auto</span> <span class="org-variable-name">s</span> = <span class="org-constant">std</span>::get_if<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>&amp;t<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">){</span>
                <span class="org-constant">std</span>::cout &lt;&lt; name &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; *s &lt;&lt; nl;
                <span class="org-keyword">return</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"&lt;UNKNOWN&gt;"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">class</span> <span class="org-type">T</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">auto</span> <span class="org-function-name">identifyAndPrint</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-type">T</span>&amp; <span class="org-variable-name">v</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-type">void</span><span class="org-rainbow-delimiters-depth-1">{</span>
        <span class="org-constant">std</span>::visit<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-keyword">auto</span>&amp;&amp; <span class="org-variable-name">a</span><span class="org-rainbow-delimiters-depth-3">){</span>
            <span class="org-keyword">using</span> <span class="org-type">C</span> = <span class="org-constant">std</span>::<span class="org-type">decay_t</span><span class="org-rainbow-delimiters-depth-4">&lt;</span><span class="org-keyword">decltype</span><span class="org-rainbow-delimiters-depth-5">(</span>a<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">&gt;</span>;
            <span class="org-keyword">if</span> <span class="org-keyword">constexpr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-constant">std</span>::<span class="org-type">is_same_v</span><span class="org-rainbow-delimiters-depth-5">&lt;</span><span class="org-type">C</span>, <span class="org-type">int</span><span class="org-rainbow-delimiters-depth-5">&gt;</span><span class="org-rainbow-delimiters-depth-4">){</span>
                            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Type is int =&gt; value = "</span> &lt;&lt; a &lt;&lt; <span class="org-string">"\n"</span>;
                            <span class="org-keyword">return</span>;
            <span class="org-rainbow-delimiters-depth-4">}</span>
            <span class="org-keyword">if</span> <span class="org-keyword">constexpr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-constant">std</span>::<span class="org-type">is_same_v</span><span class="org-rainbow-delimiters-depth-5">&lt;</span><span class="org-type">C</span>, <span class="org-type">double</span><span class="org-rainbow-delimiters-depth-5">&gt;</span><span class="org-rainbow-delimiters-depth-4">){</span>
                            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Type is double =&gt; value = "</span> &lt;&lt; a &lt;&lt; <span class="org-string">"\n"</span>;
                            <span class="org-keyword">return</span>;
            <span class="org-rainbow-delimiters-depth-4">}</span>
            <span class="org-keyword">if</span> <span class="org-keyword">constexpr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-constant">std</span>::<span class="org-type">is_same_v</span><span class="org-rainbow-delimiters-depth-5">&lt;</span><span class="org-type">C</span>, <span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-5">&gt;</span><span class="org-rainbow-delimiters-depth-4">){</span>
                            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Type is string =&gt; value = "</span> &lt;&lt; a &lt;&lt; <span class="org-string">"\n"</span>;
                            <span class="org-keyword">return</span>;
            <span class="org-rainbow-delimiters-depth-4">}</span>
            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Type is unknown"</span> &lt;&lt; <span class="org-string">"\n"</span>;
                           <span class="org-rainbow-delimiters-depth-3">}</span>, v<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">End of func. identifyAndPrint() ---//</span>

</pre>
</div>

<p>
Compile with GCC:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ g++ variant.cpp -o <span class="org-keyword">variant.bin</span> -std=c++1z -Wall -Wextra  &amp;&amp; ./variant.bin 
</pre>
</div>

<p>
Compile with Clang:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ g++ variant.cpp -o <span class="org-keyword">variant.bin</span> -std=c++1z -Wall -Wextra  &amp;&amp; ./variant.bin 
</pre>
</div>

<p>
Running: 
</p>

<div class="org-src-container">
<pre class="src src-sh">g++ variant.cpp -o <span class="org-keyword">variant.bin</span> -std=c++1z -Wall -Wextra  &amp;&amp; ./variant.bin

========== Test 1 ==================
variant has int    = true
variant has double = false
variant has string = false
 = 100
-------------------
variant has double = true
x = 204.45
-------------------
variant has string = true
x = std::variant is awesome!
========== Test 2 ==================
<span class="org-function-name">Error</span>: Failed to extract int.
s = std::variant is awesome!
========== Test 3 ==================
x = -100
x = 20.52
x = &lt;hello world std::variant&gt;
========== Test 4 ==================
Type is double =&gt; value = 10
Type is int =&gt; value = 20
Type is int =&gt; value = 5
Type is string =&gt; value = hello
Type is int =&gt; value = 10
Type is string =&gt; value = world
========== Test 5 ==================
<span class="org-builtin">type</span> = double  =&gt; value = 10
<span class="org-builtin">type</span> = int     =&gt; value = 20
<span class="org-builtin">type</span> = int     =&gt; value = 5
<span class="org-builtin">type</span> = string  =&gt; value = hello
<span class="org-builtin">type</span> = int     =&gt; value = 10
<span class="org-builtin">type</span> = string  =&gt; value = world


</pre>
</div>
</div>
</div>
<div id="outline-container-org5d2f5ba" class="outline-3">
<h3 id="org5d2f5ba"><span class="section-number-3">1.6</span> C++17 File system library</h3>
<div class="outline-text-3" id="text-1-6">
<p>
The C++17 File system library, based on Boost file systems, provides
platform-agnostic file system operation such as listing directories,
checking file permissions, creating directories, copying files and so
on.
</p>

<p>
<b>Small example about the library functionality</b>
</p>

<p>
Source: 
</p>
<ul class="org-ul">
<li>File: <a href="src/cpp17/cpp17-filesys1.cpp">file:src/cpp17/cpp17-filesys1.cpp</a></li>
<li>GIST: <a href="https://gist.github.com/caiorss/440dbcfadee02c2a81f925fa31078bbe">cpp17-filesys1.cpp</a></li>
</ul>

<p>
Compiling and running: 
</p>
<ul class="org-ul">
<li>Note: it is necessary to link against stdc++fs.</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ g++ cpp17-filesys.cpp -o <span class="org-keyword">cpp17-filesys.bin</span> -std=c++1z -O3 -Wall -Wextra -lstdc++fs  
$ ./cpp17-filesys.bin
</pre>
</div>

<p>
Used headers and namespaces: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iterator</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">C++17 - Requires compiler linking flag: -lstdc++fs on CLang or GCC.</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">filesystem</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">namespace</span> <span class="org-constant">fs</span> = <span class="org-constant">std</span>::filesystem;
</pre>
</div>

<p>
Helper template function for applying a function to the first N
entries.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">/** </span><span class="org-comment">Iterate over first N entries of a file system iterator. */</span>
<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">typename</span> <span class="org-type">Range</span>, <span class="org-keyword">typename</span> <span class="org-type">Function</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">auto</span> <span class="org-function-name">dotimes</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">size_t</span> <span class="org-variable-name">n</span>, <span class="org-type">Range</span>&amp;&amp; <span class="org-variable-name">iterable</span>, <span class="org-type">Function</span> <span class="org-variable-name">fun</span><span class="org-rainbow-delimiters-depth-1">){</span>
        <span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0;
        <span class="org-keyword">auto</span> <span class="org-variable-name">it</span> = <span class="org-constant">fs</span>::begin<span class="org-rainbow-delimiters-depth-2">(</span>iterable<span class="org-rainbow-delimiters-depth-2">)</span>;
        <span class="org-keyword">auto</span> <span class="org-variable-name">end</span> = <span class="org-constant">fs</span>::end<span class="org-rainbow-delimiters-depth-2">(</span>iterable<span class="org-rainbow-delimiters-depth-2">)</span>;
        <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-2">(</span>i &lt; n &amp;&amp; it != end <span class="org-rainbow-delimiters-depth-2">){</span>
                fun<span class="org-rainbow-delimiters-depth-3">(</span>it<span class="org-rainbow-delimiters-depth-3">)</span>;
                ++it;
                i++;
        <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<b>Main Function</b> 
</p>

<ul class="org-ul">
<li>Experiment 1:</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::boolalpha;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"\n EXPERIMENT 1 ===== Checking files in the system."</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">fs</span>::path p1 = <span class="org-string">"/etc/iscsi/initiatorname.iscsi"</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"          p1 = "</span> &lt;&lt; p1 &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p1.string()  = "</span> &lt;&lt; p1.string<span class="org-rainbow-delimiters-depth-1">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p1 ? exists  = "</span> &lt;&lt; <span class="org-constant">fs</span>::exists<span class="org-rainbow-delimiters-depth-1">(</span>p1<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p1 ? is File = "</span> &lt;&lt; <span class="org-constant">fs</span>::is_regular_file<span class="org-rainbow-delimiters-depth-1">(</span>p1<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p1 ? is Dir  = "</span> &lt;&lt; <span class="org-constant">fs</span>::is_directory<span class="org-rainbow-delimiters-depth-1">(</span>p1<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;

<span class="org-function-name">fs</span>::path p2 = <span class="org-string">"/boot"</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"          p2 = "</span> &lt;&lt; p2 &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p2.string()  = "</span> &lt;&lt; p2.string<span class="org-rainbow-delimiters-depth-1">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p2 ? exists  = "</span> &lt;&lt; <span class="org-constant">fs</span>::exists<span class="org-rainbow-delimiters-depth-1">(</span>p2<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p2 ? is File = "</span> &lt;&lt; <span class="org-constant">fs</span>::is_regular_file<span class="org-rainbow-delimiters-depth-1">(</span>p2<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p2 ? is Dir  = "</span> &lt;&lt; <span class="org-constant">fs</span>::is_directory<span class="org-rainbow-delimiters-depth-1">(</span>p2<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;

<span class="org-function-name">fs</span>::path p3 = <span class="org-string">"/boot/does/not/exist"</span>;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"          p3 = "</span> &lt;&lt; p3 &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p3.string()  = "</span> &lt;&lt; p3.string<span class="org-rainbow-delimiters-depth-1">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p3 ? exists  = "</span> &lt;&lt; <span class="org-constant">fs</span>::exists<span class="org-rainbow-delimiters-depth-1">(</span>p3<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p3 ? is File = "</span> &lt;&lt; <span class="org-constant">fs</span>::is_regular_file<span class="org-rainbow-delimiters-depth-1">(</span>p3<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"p3 ? is Dir  = "</span> &lt;&lt; <span class="org-constant">fs</span>::is_directory<span class="org-rainbow-delimiters-depth-1">(</span>p3<span class="org-rainbow-delimiters-depth-1">)</span> &lt;&lt; <span class="org-constant">std</span>::endl;
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-sh"> EXPERIMENT 1 ===== Checking files<span class="org-keyword"> in</span> the system.
          p1 = <span class="org-string">"/etc/iscsi/initiatorname.iscsi"</span>
<span class="org-function-name">p1.string</span>()  = /etc/iscsi/initiatorname.iscsi
p1 ? exists  = true
p1 ? is File = true
p1 ? is Dir  = false
          p2 = <span class="org-string">"/boot"</span>
<span class="org-function-name">p2.string</span>()  = /boot
p2 ? exists  = true
p2 ? is File = false
p2 ? is Dir  = true
          p3 = <span class="org-string">"/boot/does/not/exist"</span>
<span class="org-function-name">p3.string</span>()  = /boot/does/not/exist
p3 ? exists  = false
p3 ? is File = false
p3 ? is Dir  = false

</pre>
</div>

<ul class="org-ul">
<li>Experiment 2:</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"\n EXPERIMENT 2 ===== Listing directory /etc ====="</span> &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-comment-delimiter">// </span><span class="org-comment">Show first 10 files of directory /etc </span>
dotimes<span class="org-rainbow-delimiters-depth-1">(</span>10, <span class="org-constant">fs</span>::directory_iterator<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"/etc"</span><span class="org-rainbow-delimiters-depth-2">)</span>,
            <span class="org-rainbow-delimiters-depth-2">[](</span><span class="org-keyword">auto</span> <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-2">){</span>
                <span class="org-keyword">auto</span> <span class="org-variable-name">path</span> = p-&gt;path<span class="org-rainbow-delimiters-depth-3">()</span>;
                <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::left
                          &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>0<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; path.filename<span class="org-rainbow-delimiters-depth-3">()</span>.string<span class="org-rainbow-delimiters-depth-3">()</span>
                          &lt;&lt; <span class="org-string">" "</span> &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>35<span class="org-rainbow-delimiters-depth-3">)</span>
                          &lt;&lt; <span class="org-constant">std</span>::right &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>40<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; path
                          &lt;&lt; <span class="org-constant">std</span>::endl;             
            <span class="org-rainbow-delimiters-depth-2">}</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Output:
</p>

<div class="org-src-container">
<pre class="src src-sh"> EXPERIMENT 2 ===== Listing directory /etc =====
chkconfig.d                       <span class="org-string">"/etc/chkconfig.d"</span>
DIR_COLORS.lightbgcolor           <span class="org-string">"/etc/DIR_COLORS.lightbgcolor"</span>
crypttab                          <span class="org-string">"/etc/crypttab"</span>
iscsi                             <span class="org-string">"/etc/iscsi"</span>
depmod.d                          <span class="org-string">"/etc/depmod.d"</span>
vbox                              <span class="org-string">"/etc/vbox"</span>
rhashrc                           <span class="org-string">"/etc/rhashrc"</span>
issue.net                         <span class="org-string">"/etc/issue.net"</span>
java                              <span class="org-string">"/etc/java"</span>
authselect                        <span class="org-string">"/etc/authselect"</span>
</pre>
</div>

<ul class="org-ul">
<li>Experiment 3:</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-string">"\n EXPERIMENT 3 = Listing directory /etc (recursive) ====="</span> &lt;&lt; <span class="org-constant">std</span>::endl;
dotimes<span class="org-rainbow-delimiters-depth-1">(</span>20, <span class="org-constant">fs</span>::recursive_directory_iterator<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"/etc/"</span><span class="org-rainbow-delimiters-depth-2">)</span>,
                <span class="org-rainbow-delimiters-depth-2">[](</span><span class="org-keyword">auto</span> <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-2">){</span>
                    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::right
                              &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>10<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; <span class="org-constant">fs</span>::is_directory<span class="org-rainbow-delimiters-depth-3">(</span>p-&gt;path<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>
                              &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>10<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; <span class="org-constant">fs</span>::is_regular_file<span class="org-rainbow-delimiters-depth-3">(</span>p-&gt;path<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>
                              &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>10<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; <span class="org-constant">fs</span>::is_symlink<span class="org-rainbow-delimiters-depth-3">(</span>p-&gt;path<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>
                              &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>10<span class="org-rainbow-delimiters-depth-3">)</span>  &lt;&lt; <span class="org-string">" "</span>
                              &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-3">(</span>5<span class="org-rainbow-delimiters-depth-3">)</span>   &lt;&lt; <span class="org-constant">std</span>::left &lt;&lt; p-&gt;path<span class="org-rainbow-delimiters-depth-3">()</span>                     
                              &lt;&lt; <span class="org-constant">std</span>::endl;
                <span class="org-rainbow-delimiters-depth-2">}</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Output: 
</p>

<ul class="org-ul">
<li>1st colum  =&gt; Directory</li>
<li>2nd column =&gt; File</li>
<li>3rd column =&gt; Symbolic link</li>
<li>4th column =&gt; Absolute file path.</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">EXPERIMENT 3 = Listing directory /etc (recursive) =====
     true     false     false          <span class="org-string">"/etc/chkconfig.d"</span>
    false      true     false          <span class="org-string">"/etc/DIR_COLORS.lightbgcolor"</span>
    false      true     false          <span class="org-string">"/etc/crypttab"</span>
     true     false     false          <span class="org-string">"/etc/iscsi"</span>
    false      true     false          <span class="org-string">"/etc/iscsi/iscsid.conf"</span>
    false      true     false          <span class="org-string">"/etc/iscsi/initiatorname.iscsi"</span>
     true     false     false          <span class="org-string">"/etc/depmod.d"</span>
     true     false     false          <span class="org-string">"/etc/vbox"</span>
    false      true     false          <span class="org-string">"/etc/vbox/vbox.cfg"</span>
    false      true     false          <span class="org-string">"/etc/rhashrc"</span>
    false      true      true          <span class="org-string">"/etc/issue.net"</span>
     true     false     false          <span class="org-string">"/etc/java"</span>
    false      true     false          <span class="org-string">"/etc/java/font.properties"</span>
    false      true     false          <span class="org-string">"/etc/java/java.conf"</span>
</pre>
</div>


<p>
Documentation: 
</p>

<ul class="org-ul">
<li><a href="https://en.cppreference.com/w/cpp/filesystem">Filesystem library - cppreference.com</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0218r1.html">C++17 Filesystem -</a></li>
<li><a href="https://www.boost.org/doc/libs/1_69_0/libs/filesystem/doc/tutorial.html">Boost Filesystem Tutorial</a> (Note: it is not the std::filesystem
library, but its predecessor, however it is worth reading it.)</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2019-07-14 Sun 01:50</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
